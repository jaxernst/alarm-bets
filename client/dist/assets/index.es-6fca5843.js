import{g as Nc,a as Xn,c as ur,b as se,d as F_,w as tf,e as rf,f as $c,h as yo,i as j_,j as mi,A as M_,U as q_,l as Q,p as U_,q as lc,u as z_,_ as B_,P as H_,x as Kh,y as k_,D as V_,C as K_,Z as Gh,$ as G_,z as W_,B as lo,E as J_,F as nf,G as Lr,J as Y_,K as X_,X as cn,M as Lt,N as tr,O as _i,Q as cr,R as Z_,S as un,T as sf,W as Q_,Y as em,a0 as tm,a1 as of,a2 as rm,a3 as af,a4 as cf,a5 as ln,a6 as fc,a7 as ao,a8 as pn,a9 as im,aa as co,ab as nm,ac as sm,ad as om,ae as am,af as cm,ag as Ja,ah as Wh,ai as um,aj as hm,ak as lm,al as Jh,am as fm,an as pm,ao as dm,ap as gm,aq as ym,ar as vm,as as _m,at as uo,au as uf,av as Ya,aw as mm,ax as bm}from"./index-d5466935.js";var Dc={exports:{}},fn=typeof Reflect=="object"?Reflect:null,Yh=fn&&typeof fn.apply=="function"?fn.apply:function(r,t,n){return Function.prototype.apply.call(r,t,n)},ho;fn&&typeof fn.ownKeys=="function"?ho=fn.ownKeys:Object.getOwnPropertySymbols?ho=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:ho=function(r){return Object.getOwnPropertyNames(r)};function wm(a){console&&console.warn&&console.warn(a)}var hf=Number.isNaN||function(r){return r!==r};function He(){He.init.call(this)}Dc.exports=He;Dc.exports.once=Sm;He.EventEmitter=He;He.prototype._events=void 0;He.prototype._eventsCount=0;He.prototype._maxListeners=void 0;var Xh=10;function vo(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(He,"defaultMaxListeners",{enumerable:!0,get:function(){return Xh},set:function(a){if(typeof a!="number"||a<0||hf(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");Xh=a}});He.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};He.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||hf(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function lf(a){return a._maxListeners===void 0?He.defaultMaxListeners:a._maxListeners}He.prototype.getMaxListeners=function(){return lf(this)};He.prototype.emit=function(r){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=r==="error",c=this._events;if(c!==void 0)s=s&&c.error===void 0;else if(!s)return!1;if(s){var l;if(t.length>0&&(l=t[0]),l instanceof Error)throw l;var p=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw p.context=l,p}var m=c[r];if(m===void 0)return!1;if(typeof m=="function")Yh(m,this,t);else for(var y=m.length,O=yf(m,y),n=0;n<y;++n)Yh(O[n],this,t);return!0};function ff(a,r,t,n){var s,c,l;if(vo(t),c=a._events,c===void 0?(c=a._events=Object.create(null),a._eventsCount=0):(c.newListener!==void 0&&(a.emit("newListener",r,t.listener?t.listener:t),c=a._events),l=c[r]),l===void 0)l=c[r]=t,++a._eventsCount;else if(typeof l=="function"?l=c[r]=n?[t,l]:[l,t]:n?l.unshift(t):l.push(t),s=lf(a),s>0&&l.length>s&&!l.warned){l.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=a,p.type=r,p.count=l.length,wm(p)}return a}He.prototype.addListener=function(r,t){return ff(this,r,t,!1)};He.prototype.on=He.prototype.addListener;He.prototype.prependListener=function(r,t){return ff(this,r,t,!0)};function Em(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pf(a,r,t){var n={fired:!1,wrapFn:void 0,target:a,type:r,listener:t},s=Em.bind(n);return s.listener=t,n.wrapFn=s,s}He.prototype.once=function(r,t){return vo(t),this.on(r,pf(this,r,t)),this};He.prototype.prependOnceListener=function(r,t){return vo(t),this.prependListener(r,pf(this,r,t)),this};He.prototype.removeListener=function(r,t){var n,s,c,l,p;if(vo(t),s=this._events,s===void 0)return this;if(n=s[r],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[r],s.removeListener&&this.emit("removeListener",r,n.listener||t));else if(typeof n!="function"){for(c=-1,l=n.length-1;l>=0;l--)if(n[l]===t||n[l].listener===t){p=n[l].listener,c=l;break}if(c<0)return this;c===0?n.shift():xm(n,c),n.length===1&&(s[r]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",r,p||t)}return this};He.prototype.off=He.prototype.removeListener;He.prototype.removeAllListeners=function(r){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[r]),this;if(arguments.length===0){var c=Object.keys(n),l;for(s=0;s<c.length;++s)l=c[s],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[r],typeof t=="function")this.removeListener(r,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(r,t[s]);return this};function df(a,r,t){var n=a._events;if(n===void 0)return[];var s=n[r];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?Im(s):yf(s,s.length)}He.prototype.listeners=function(r){return df(this,r,!0)};He.prototype.rawListeners=function(r){return df(this,r,!1)};He.listenerCount=function(a,r){return typeof a.listenerCount=="function"?a.listenerCount(r):gf.call(a,r)};He.prototype.listenerCount=gf;function gf(a){var r=this._events;if(r!==void 0){var t=r[a];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}He.prototype.eventNames=function(){return this._eventsCount>0?ho(this._events):[]};function yf(a,r){for(var t=new Array(r),n=0;n<r;++n)t[n]=a[n];return t}function xm(a,r){for(;r+1<a.length;r++)a[r]=a[r+1];a.pop()}function Im(a){for(var r=new Array(a.length),t=0;t<r.length;++t)r[t]=a[t].listener||a[t];return r}function Sm(a,r){return new Promise(function(t,n){function s(l){a.removeListener(r,c),n(l)}function c(){typeof a.removeListener=="function"&&a.removeListener("error",s),t([].slice.call(arguments))}vf(a,r,c,{once:!0}),r!=="error"&&Pm(a,s,{once:!0})})}function Pm(a,r,t){typeof a.on=="function"&&vf(a,"error",r,t)}function vf(a,r,t,n){if(typeof a.on=="function")n.once?a.once(r,t):a.on(r,t);else if(typeof a.addEventListener=="function")a.addEventListener(r,function s(c){n.once&&a.removeEventListener(r,s),t(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}var yr=Dc.exports;const Lc=Nc(yr);var _o={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var pc=function(a,r){return pc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},pc(a,r)};function Om(a,r){pc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var dc=function(){return dc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},dc.apply(this,arguments)};function Am(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function Cm(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function Rm(a,r){return function(t,n){r(t,n,a)}}function Tm(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Nm(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function m(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function $m(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Dm(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Lm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function gc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function _f(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Fm(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(_f(arguments[r]));return a}function jm(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Kn(a){return this instanceof Kn?(this.v=a,this):new Kn(a)}function Mm(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(C){n[C]&&(s[C]=function(U){return new Promise(function(L,K){c.push([C,U,L,K])>1||p(C,U)})})}function p(C,U){try{m(n[C](U))}catch(L){q(c[0][3],L)}}function m(C){C.value instanceof Kn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,U){C(U),c.shift(),c.length&&p(c[0][0],c[0][1])}}function qm(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Kn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Um(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof gc=="function"?gc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function zm(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Bm(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Hm(a){return a&&a.__esModule?a:{default:a}}function km(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Vm(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Km=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return dc},__asyncDelegator:qm,__asyncGenerator:Mm,__asyncValues:Um,__await:Kn,__awaiter:Nm,__classPrivateFieldGet:km,__classPrivateFieldSet:Vm,__createBinding:Dm,__decorate:Cm,__exportStar:Lm,__extends:Om,__generator:$m,__importDefault:Hm,__importStar:Bm,__makeTemplateObject:zm,__metadata:Tm,__param:Rm,__read:_f,__rest:Am,__spread:Fm,__spreadArrays:jm,__values:gc},Symbol.toStringTag,{value:"Module"})),mf=Xn(Km);var Zn={};Object.defineProperty(Zn,"__esModule",{value:!0});function Gm(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a)}catch{return a}}Zn.safeJsonParse=Gm;function Wm(a){return typeof a=="string"?a:JSON.stringify(a,(r,t)=>typeof t>"u"?null:t)}Zn.safeJsonStringify=Wm;var Dn={exports:{}},Zh;function Jm(){return Zh||(Zh=1,function(){let a;function r(){}a=r,a.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},a.prototype.setItem=function(t,n){this[t]=String(n)},a.prototype.removeItem=function(t){delete this[t]},a.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},a.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ur<"u"&&ur.localStorage?Dn.exports=ur.localStorage:typeof window<"u"&&window.localStorage?Dn.exports=window.localStorage:Dn.exports=new r}()),Dn.exports}var Xa={},Ln={},Qh;function Ym(){if(Qh)return Ln;Qh=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.IKeyValueStorage=void 0;class a{}return Ln.IKeyValueStorage=a,Ln}var Fn={},el;function Xm(){if(el)return Fn;el=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.parseEntry=void 0;const a=Zn;function r(t){var n;return[t[0],a.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}return Fn.parseEntry=r,Fn}var tl;function Zm(){return tl||(tl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=mf;r.__exportStar(Ym(),a),r.__exportStar(Xm(),a)}(Xa)),Xa}Object.defineProperty(_o,"__esModule",{value:!0});_o.KeyValueStorage=void 0;const hn=mf,rl=Zn,Qm=hn.__importDefault(Jm()),e1=Zm();class bf{constructor(){this.localStorage=Qm.default}getKeys(){return hn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return hn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(e1.parseEntry)})}getItem(r){return hn.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(r);if(t!==null)return rl.safeJsonParse(t)})}setItem(r,t){return hn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,rl.safeJsonStringify(t))})}removeItem(r){return hn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}_o.KeyValueStorage=bf;var t1=_o.default=bf,dn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yc=function(a,r){return yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},yc(a,r)};function r1(a,r){yc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var vc=function(){return vc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},vc.apply(this,arguments)};function i1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function n1(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function s1(a,r){return function(t,n){r(t,n,a)}}function o1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function a1(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function m(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function c1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function u1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function h1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function _c(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function wf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function l1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(wf(arguments[r]));return a}function f1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Gn(a){return this instanceof Gn?(this.v=a,this):new Gn(a)}function p1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(C){n[C]&&(s[C]=function(U){return new Promise(function(L,K){c.push([C,U,L,K])>1||p(C,U)})})}function p(C,U){try{m(n[C](U))}catch(L){q(c[0][3],L)}}function m(C){C.value instanceof Gn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,U){C(U),c.shift(),c.length&&p(c[0][0],c[0][1])}}function d1(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Gn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function g1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof _c=="function"?_c(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function y1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function v1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function _1(a){return a&&a.__esModule?a:{default:a}}function m1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function b1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const w1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return vc},__asyncDelegator:d1,__asyncGenerator:p1,__asyncValues:g1,__await:Gn,__awaiter:a1,__classPrivateFieldGet:m1,__classPrivateFieldSet:b1,__createBinding:u1,__decorate:n1,__exportStar:h1,__extends:r1,__generator:c1,__importDefault:_1,__importStar:v1,__makeTemplateObject:y1,__metadata:o1,__param:s1,__read:wf,__rest:i1,__spread:l1,__spreadArrays:f1,__values:_c},Symbol.toStringTag,{value:"Module"})),mo=Xn(w1);var jn={},Za={},Mn={};let qi=class{};const E1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:qi},Symbol.toStringTag,{value:"Module"})),x1=Xn(E1);var il;function I1(){if(il)return Mn;il=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.IHeartBeat=void 0;const a=x1;class r extends a.IEvents{constructor(n){super()}}return Mn.IHeartBeat=r,Mn}var nl;function Ef(){return nl||(nl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),mo.__exportStar(I1(),a)}(Za)),Za}var Qa={},ji={},sl;function S1(){if(sl)return ji;sl=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.HEARTBEAT_EVENTS=ji.HEARTBEAT_INTERVAL=void 0;const a=se;return ji.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ji}var ol;function xf(){return ol||(ol=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),mo.__exportStar(S1(),a)}(Qa)),Qa}var al;function P1(){if(al)return jn;al=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.HeartBeat=void 0;const a=mo,r=yr,t=se,n=Ef(),s=xf();class c extends n.IHeartBeat{constructor(p){super(p),this.events=new r.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||s.HEARTBEAT_INTERVAL}static init(p){return a.__awaiter(this,void 0,void 0,function*(){const m=new c(p);return yield m.init(),m})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,m){this.events.on(p,m)}once(p,m){this.events.once(p,m)}off(p,m){this.events.off(p,m)}removeListener(p,m){this.events.removeListener(p,m)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return jn.HeartBeat=c,jn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=mo;r.__exportStar(P1(),a),r.__exportStar(Ef(),a),r.__exportStar(xf(),a)})(dn);var Re={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mc=function(a,r){return mc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},mc(a,r)};function O1(a,r){mc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var bc=function(){return bc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},bc.apply(this,arguments)};function A1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function C1(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function R1(a,r){return function(t,n){r(t,n,a)}}function T1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function N1(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function m(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function $1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function D1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function L1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function wc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function If(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function F1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(If(arguments[r]));return a}function j1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Wn(a){return this instanceof Wn?(this.v=a,this):new Wn(a)}function M1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(C){n[C]&&(s[C]=function(U){return new Promise(function(L,K){c.push([C,U,L,K])>1||p(C,U)})})}function p(C,U){try{m(n[C](U))}catch(L){q(c[0][3],L)}}function m(C){C.value instanceof Wn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,U){C(U),c.shift(),c.length&&p(c[0][0],c[0][1])}}function q1(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Wn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function U1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof wc=="function"?wc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function z1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function B1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function H1(a){return a&&a.__esModule?a:{default:a}}function k1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function V1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const K1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return bc},__asyncDelegator:q1,__asyncGenerator:M1,__asyncValues:U1,__await:Wn,__awaiter:N1,__classPrivateFieldGet:k1,__classPrivateFieldSet:V1,__createBinding:D1,__decorate:C1,__exportStar:L1,__extends:O1,__generator:$1,__importDefault:H1,__importStar:B1,__makeTemplateObject:z1,__metadata:T1,__param:R1,__read:If,__rest:A1,__spread:F1,__spreadArrays:j1,__values:wc},Symbol.toStringTag,{value:"Module"})),G1=Xn(K1);var ec,cl;function W1(){if(cl)return ec;cl=1;function a(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}ec=r;function r(t,n,s){var c=s&&s.stringify||a,l=1;if(typeof t=="object"&&t!==null){var p=n.length+l;if(p===1)return t;var m=new Array(p);m[0]=c(t);for(var y=1;y<p;y++)m[y]=c(n[y]);return m.join(" ")}if(typeof t!="string")return t;var O=n.length;if(O===0)return t;for(var q="",C=1-l,U=-1,L=t&&t.length||0,K=0;K<L;){if(t.charCodeAt(K)===37&&K+1<L){switch(U=U>-1?U:0,t.charCodeAt(K+1)){case 100:case 102:if(C>=O||n[C]==null)break;U<K&&(q+=t.slice(U,K)),q+=Number(n[C]),U=K+2,K++;break;case 105:if(C>=O||n[C]==null)break;U<K&&(q+=t.slice(U,K)),q+=Math.floor(Number(n[C])),U=K+2,K++;break;case 79:case 111:case 106:if(C>=O||n[C]===void 0)break;U<K&&(q+=t.slice(U,K));var ie=typeof n[C];if(ie==="string"){q+="'"+n[C]+"'",U=K+2,K++;break}if(ie==="function"){q+=n[C].name||"<anonymous>",U=K+2,K++;break}q+=c(n[C]),U=K+2,K++;break;case 115:if(C>=O)break;U<K&&(q+=t.slice(U,K)),q+=String(n[C]),U=K+2,K++;break;case 37:U<K&&(q+=t.slice(U,K)),q+="%",U=K+2,K++,C--;break}++C}++K}return U===-1?t:(U<L&&(q+=t.slice(U)),q)}return ec}var tc,ul;function J1(){if(ul)return tc;ul=1;const a=W1();tc=s;const r=le().console||{},t={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:L,res:L,err:C};function n($,z){return Array.isArray($)?$.filter(function(ye){return ye!=="!stdSerializers.err"}):$===!0?Object.keys(z):!1}function s($){$=$||{},$.browser=$.browser||{};const z=$.browser.transmit;if(z&&typeof z.send!="function")throw Error("pino: transmit option must have a send function");const W=$.browser.write||r;$.browser.write&&($.browser.asObject=!0);const ye=$.serializers||{},re=n($.browser.serialize,ye);let ue=$.browser.serialize;Array.isArray($.browser.serialize)&&$.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),$.enabled===!1&&($.level="silent");const Ue=$.level||"info",_=Object.create(W);_.log||(_.log=ie),Object.defineProperty(_,"levelVal",{get:X}),Object.defineProperty(_,"level",{get:ce,set:V});const x={transmit:z,serialize:re,asObject:$.browser.asObject,levels:Te,timestamp:U($)};_.levels=s.levels,_.level=Ue,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=ie,_.serializers=ye,_._serialize=re,_._stdErrSerialize=ue,_.child=B,z&&(_._logEvent=q());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,c(x,_,"error","log"),c(x,_,"fatal","error"),c(x,_,"warn","error"),c(x,_,"info","log"),c(x,_,"debug","log"),c(x,_,"trace","log")}function B(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},re&&k.serializers&&(G.serializers=k.serializers);const Ye=G.serializers;if(re&&Ye){var ke=Object.assign({},ye,Ye),jr=$.browser.serialize===!0?Object.keys(ke):re;delete k.serializers,m([k],jr,ke,this._stdErrSerialize)}function xe(St){this._childLevel=(St._childLevel|0)+1,this.error=y(St,k,"error"),this.fatal=y(St,k,"fatal"),this.warn=y(St,k,"warn"),this.info=y(St,k,"info"),this.debug=y(St,k,"debug"),this.trace=y(St,k,"trace"),ke&&(this.serializers=ke,this._serialize=jr),z&&(this._logEvent=q([].concat(St._logEvent.bindings,k)))}return xe.prototype=this,new xe(this)}return _}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=t,s.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function c($,z,W,ye){const re=Object.getPrototypeOf(z);z[W]=z.levelVal>z.levels.values[W]?ie:re[W]?re[W]:r[W]||r[ye]||ie,l($,z,W)}function l($,z,W){!$.transmit&&z[W]===ie||(z[W]=function(ye){return function(){const ue=$.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var _=0;_<Te.length;_++)Te[_]=arguments[_];if($.serialize&&!$.asObject&&m(Te,this._serialize,this.serializers,this._stdErrSerialize),$.asObject?ye.call(Ue,p(this,W,Te,ue)):ye.apply(Ue,Te),$.transmit){const x=$.transmit.level||z.level,X=s.levels.values[x],ce=s.levels.values[W];if(ce<X)return;O(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:x,transmitValue:s.levels.values[$.transmit.level||z.level],send:$.transmit.send,val:z.levelVal},Te)}}}(z[W]))}function p($,z,W,ye){$._serialize&&m(W,$._serialize,$.serializers,$._stdErrSerialize);const re=W.slice();let ue=re[0];const Te={};ye&&(Te.time=ye),Te.level=s.levels.values[z];let Ue=($._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof re[0]=="object";)Object.assign(Te,re.shift());ue=re.length?a(re.shift(),re):void 0}else typeof ue=="string"&&(ue=a(re.shift(),re));return ue!==void 0&&(Te.msg=ue),Te}function m($,z,W,ye){for(const re in $)if(ye&&$[re]instanceof Error)$[re]=s.stdSerializers.err($[re]);else if(typeof $[re]=="object"&&!Array.isArray($[re]))for(const ue in $[re])z&&z.indexOf(ue)>-1&&ue in W&&($[re][ue]=W[ue]($[re][ue]))}function y($,z,W){return function(){const ye=new Array(1+arguments.length);ye[0]=z;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return $[W].apply(this,ye)}}function O($,z,W){const ye=z.send,re=z.ts,ue=z.methodLevel,Te=z.methodValue,Ue=z.val,_=$._logEvent.bindings;m(W,$._serialize||Object.keys($.serializers),$.serializers,$._stdErrSerialize===void 0?!0:$._stdErrSerialize),$._logEvent.ts=re,$._logEvent.messages=W.filter(function(x){return _.indexOf(x)===-1}),$._logEvent.level.label=ue,$._logEvent.level.value=Te,ye(ue,$._logEvent,Ue),$._logEvent=q(_)}function q($){return{ts:0,messages:[],bindings:$||[],level:{label:"",value:0}}}function C($){const z={type:$.constructor.name,msg:$.message,stack:$.stack};for(const W in $)z[W]===void 0&&(z[W]=$[W]);return z}function U($){return typeof $.timestamp=="function"?$.timestamp:$.timestamp===!1?Ee:ge}function L(){return{}}function K($){return $}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function $(z){return typeof z<"u"&&z}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return $(self)||$(window)||$(this)||{}}}return tc}var Mi={},hl;function Sf(){return hl||(hl=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.PINO_CUSTOM_CONTEXT_KEY=Mi.PINO_LOGGER_DEFAULTS=void 0,Mi.PINO_LOGGER_DEFAULTS={level:"info"},Mi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Mi}var er={},ll;function Y1(){if(ll)return er;ll=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const a=Sf();function r(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||a.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=r;function t(p,m=a.PINO_CUSTOM_CONTEXT_KEY){return p[m]||""}er.getBrowserLoggerContext=t;function n(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){return p[y]=m,p}er.setBrowserLoggerContext=n;function s(p,m=a.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof p.bindings>"u"?y=t(p,m):y=p.bindings().context||"",y}er.getLoggerContext=s;function c(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=s(p,y);return O.trim()?`${O}/${m}`:m}er.formatChildLoggerContext=c;function l(p,m,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=c(p,m,y),q=p.child({context:O});return n(q,O,y)}return er.generateChildLogger=l,er}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=G1,t=r.__importDefault(J1());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return t.default}}),r.__exportStar(Sf(),a),r.__exportStar(Y1(),a)})(Re);class X1 extends qi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class Z1 extends qi{constructor(r,t){super(),this.core=r,this.logger=t,this.records=new Map}}class Q1{constructor(r,t){this.logger=r,this.core=t}}let eb=class extends qi{constructor(r,t){super(),this.relayer=r,this.logger=t}},tb=class extends qi{constructor(r){super()}},rb=class{constructor(r,t,n,s){this.core=r,this.logger=t,this.name=n}};class ib extends qi{constructor(r,t){super(),this.relayer=r,this.logger=t}}let nb=class extends qi{constructor(r,t){super(),this.core=r,this.logger=t}},sb=class{constructor(r,t){this.projectId=r,this.logger=t}},ob=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},ab=class{constructor(r){this.client=r}};const cb=a=>JSON.stringify(a,(r,t)=>typeof t=="bigint"?t.toString()+"n":t),ub=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=a.replace(r,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Fc(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return ub(a)}catch{return a}}function Jn(a){return typeof a=="string"?a:cb(a)||""}var jc={},Pf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=F_,t=tf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function p(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(m,y){if(y===void 0&&(y=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var O=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=m[O++],y--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(O=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,O,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=m[O++],y--;return this},p.prototype.finish=function(m){if(!this._finished){var y=this._bytesHashed,O=this._bufferLength,q=y/536870912|0,C=y<<3,U=y%128<112?128:256;this._buffer[O]=128;for(var L=O+1;L<U-8;L++)this._buffer[L]=0;r.writeUint32BE(q,this._buffer,U-8),r.writeUint32BE(C,this._buffer,U-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,U),this._finished=!0}for(var L=0;L<this.digestLength/8;L++)r.writeUint32BE(this._stateHi[L],m,L*8),r.writeUint32BE(this._stateLo[L],m,L*8+4);return this},p.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(m){t.wipe(m.stateHi),t.wipe(m.stateLo),m.buffer&&t.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},p}();a.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(p,m,y,O,q,C,U){for(var L=y[0],K=y[1],ie=y[2],Ee=y[3],ge=y[4],pe=y[5],he=y[6],le=y[7],$=O[0],z=O[1],W=O[2],ye=O[3],re=O[4],ue=O[5],Te=O[6],Ue=O[7],_,x,X,ce,V,B,k,G;U>=128;){for(var Ye=0;Ye<16;Ye++){var ke=8*Ye+C;p[Ye]=r.readUint32BE(q,ke),m[Ye]=r.readUint32BE(q,ke+4)}for(var Ye=0;Ye<80;Ye++){var jr=L,xe=K,St=ie,N=Ee,T=ge,A=pe,h=he,E=le,ee=$,fe=z,be=W,Ne=ye,De=re,Pe=ue,Pt=Te,mt=Ue;if(_=le,x=Ue,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),x=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=ge&pe^~ge&he,x=re&ue^~re&Te,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=s[Ye*2],x=s[Ye*2+1],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=p[Ye%16],x=m[Ye%16],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,X=k&65535|G<<16,ce=V&65535|B<<16,_=X,x=ce,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=(L>>>28|$<<32-28)^($>>>34-32|L<<32-(34-32))^($>>>39-32|L<<32-(39-32)),x=($>>>28|L<<32-28)^(L>>>34-32|$<<32-(34-32))^(L>>>39-32|$<<32-(39-32)),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=L&K^L&ie^K&ie,x=$&z^$&W^z&W,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,E=k&65535|G<<16,mt=V&65535|B<<16,_=N,x=Ne,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=X,x=ce,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,N=k&65535|G<<16,Ne=V&65535|B<<16,K=jr,ie=xe,Ee=St,ge=N,pe=T,he=A,le=h,L=E,z=ee,W=fe,ye=be,re=Ne,ue=De,Te=Pe,Ue=Pt,$=mt,Ye%16===15)for(var ke=0;ke<16;ke++)_=p[ke],x=m[ke],V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=p[(ke+9)%16],x=m[(ke+9)%16],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,X=p[(ke+1)%16],ce=m[(ke+1)%16],_=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,x=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,X=p[(ke+14)%16],ce=m[(ke+14)%16],_=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,x=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,p[ke]=k&65535|G<<16,m[ke]=V&65535|B<<16}_=L,x=$,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[0],x=O[0],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[0]=L=k&65535|G<<16,O[0]=$=V&65535|B<<16,_=K,x=z,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[1],x=O[1],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[1]=K=k&65535|G<<16,O[1]=z=V&65535|B<<16,_=ie,x=W,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[2],x=O[2],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[2]=ie=k&65535|G<<16,O[2]=W=V&65535|B<<16,_=Ee,x=ye,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[3],x=O[3],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[3]=Ee=k&65535|G<<16,O[3]=ye=V&65535|B<<16,_=ge,x=re,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[4],x=O[4],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[4]=ge=k&65535|G<<16,O[4]=re=V&65535|B<<16,_=pe,x=ue,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[5],x=O[5],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[5]=pe=k&65535|G<<16,O[5]=ue=V&65535|B<<16,_=he,x=Te,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[6],x=O[6],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[6]=he=k&65535|G<<16,O[6]=Te=V&65535|B<<16,_=le,x=Ue,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[7],x=O[7],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[7]=le=k&65535|G<<16,O[7]=Ue=V&65535|B<<16,C+=128,U-=128}return C}function l(p){var m=new n;m.update(p);var y=m.digest();return m.clean(),y}a.hash=l})(Pf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=rf,t=Pf,n=tf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function s(N){const T=new Float64Array(16);if(N)for(let A=0;A<N.length;A++)T[A]=N[A];return T}const c=new Uint8Array(32);c[0]=9;const l=s(),p=s([1]),m=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),O=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),q=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function U(N,T){for(let A=0;A<16;A++)N[A]=T[A]|0}function L(N){let T=1;for(let A=0;A<16;A++){let h=N[A]+T+65535;T=Math.floor(h/65536),N[A]=h-T*65536}N[0]+=T-1+37*(T-1)}function K(N,T,A){const h=~(A-1);for(let E=0;E<16;E++){const ee=h&(N[E]^T[E]);N[E]^=ee,T[E]^=ee}}function ie(N,T){const A=s(),h=s();for(let E=0;E<16;E++)h[E]=T[E];L(h),L(h),L(h);for(let E=0;E<2;E++){A[0]=h[0]-65517;for(let fe=1;fe<15;fe++)A[fe]=h[fe]-65535-(A[fe-1]>>16&1),A[fe-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,K(h,A,1-ee)}for(let E=0;E<16;E++)N[2*E]=h[E]&255,N[2*E+1]=h[E]>>8}function Ee(N,T){let A=0;for(let h=0;h<32;h++)A|=N[h]^T[h];return(1&A-1>>>8)-1}function ge(N,T){const A=new Uint8Array(32),h=new Uint8Array(32);return ie(A,N),ie(h,T),Ee(A,h)}function pe(N){const T=new Uint8Array(32);return ie(T,N),T[0]&1}function he(N,T){for(let A=0;A<16;A++)N[A]=T[2*A]+(T[2*A+1]<<8);N[15]&=32767}function le(N,T,A){for(let h=0;h<16;h++)N[h]=T[h]+A[h]}function $(N,T,A){for(let h=0;h<16;h++)N[h]=T[h]-A[h]}function z(N,T,A){let h,E,ee=0,fe=0,be=0,Ne=0,De=0,Pe=0,Pt=0,mt=0,ot=0,Fe=0,Ze=0,Qe=0,at=0,ze=0,et=0,$e=0,Ve=0,ht=0,Me=0,Ot=0,Ft=0,Bt=0,Ht=0,qt=0,Wt=0,rr=0,Mr=0,Jt=0,Kr=0,ai=0,xi=0,lt=A[0],it=A[1],ft=A[2],pt=A[3],ct=A[4],nt=A[5],At=A[6],Ct=A[7],dt=A[8],Rt=A[9],gt=A[10],bt=A[11],yt=A[12],Xe=A[13],Tt=A[14],Nt=A[15];h=T[0],ee+=h*lt,fe+=h*it,be+=h*ft,Ne+=h*pt,De+=h*ct,Pe+=h*nt,Pt+=h*At,mt+=h*Ct,ot+=h*dt,Fe+=h*Rt,Ze+=h*gt,Qe+=h*bt,at+=h*yt,ze+=h*Xe,et+=h*Tt,$e+=h*Nt,h=T[1],fe+=h*lt,be+=h*it,Ne+=h*ft,De+=h*pt,Pe+=h*ct,Pt+=h*nt,mt+=h*At,ot+=h*Ct,Fe+=h*dt,Ze+=h*Rt,Qe+=h*gt,at+=h*bt,ze+=h*yt,et+=h*Xe,$e+=h*Tt,Ve+=h*Nt,h=T[2],be+=h*lt,Ne+=h*it,De+=h*ft,Pe+=h*pt,Pt+=h*ct,mt+=h*nt,ot+=h*At,Fe+=h*Ct,Ze+=h*dt,Qe+=h*Rt,at+=h*gt,ze+=h*bt,et+=h*yt,$e+=h*Xe,Ve+=h*Tt,ht+=h*Nt,h=T[3],Ne+=h*lt,De+=h*it,Pe+=h*ft,Pt+=h*pt,mt+=h*ct,ot+=h*nt,Fe+=h*At,Ze+=h*Ct,Qe+=h*dt,at+=h*Rt,ze+=h*gt,et+=h*bt,$e+=h*yt,Ve+=h*Xe,ht+=h*Tt,Me+=h*Nt,h=T[4],De+=h*lt,Pe+=h*it,Pt+=h*ft,mt+=h*pt,ot+=h*ct,Fe+=h*nt,Ze+=h*At,Qe+=h*Ct,at+=h*dt,ze+=h*Rt,et+=h*gt,$e+=h*bt,Ve+=h*yt,ht+=h*Xe,Me+=h*Tt,Ot+=h*Nt,h=T[5],Pe+=h*lt,Pt+=h*it,mt+=h*ft,ot+=h*pt,Fe+=h*ct,Ze+=h*nt,Qe+=h*At,at+=h*Ct,ze+=h*dt,et+=h*Rt,$e+=h*gt,Ve+=h*bt,ht+=h*yt,Me+=h*Xe,Ot+=h*Tt,Ft+=h*Nt,h=T[6],Pt+=h*lt,mt+=h*it,ot+=h*ft,Fe+=h*pt,Ze+=h*ct,Qe+=h*nt,at+=h*At,ze+=h*Ct,et+=h*dt,$e+=h*Rt,Ve+=h*gt,ht+=h*bt,Me+=h*yt,Ot+=h*Xe,Ft+=h*Tt,Bt+=h*Nt,h=T[7],mt+=h*lt,ot+=h*it,Fe+=h*ft,Ze+=h*pt,Qe+=h*ct,at+=h*nt,ze+=h*At,et+=h*Ct,$e+=h*dt,Ve+=h*Rt,ht+=h*gt,Me+=h*bt,Ot+=h*yt,Ft+=h*Xe,Bt+=h*Tt,Ht+=h*Nt,h=T[8],ot+=h*lt,Fe+=h*it,Ze+=h*ft,Qe+=h*pt,at+=h*ct,ze+=h*nt,et+=h*At,$e+=h*Ct,Ve+=h*dt,ht+=h*Rt,Me+=h*gt,Ot+=h*bt,Ft+=h*yt,Bt+=h*Xe,Ht+=h*Tt,qt+=h*Nt,h=T[9],Fe+=h*lt,Ze+=h*it,Qe+=h*ft,at+=h*pt,ze+=h*ct,et+=h*nt,$e+=h*At,Ve+=h*Ct,ht+=h*dt,Me+=h*Rt,Ot+=h*gt,Ft+=h*bt,Bt+=h*yt,Ht+=h*Xe,qt+=h*Tt,Wt+=h*Nt,h=T[10],Ze+=h*lt,Qe+=h*it,at+=h*ft,ze+=h*pt,et+=h*ct,$e+=h*nt,Ve+=h*At,ht+=h*Ct,Me+=h*dt,Ot+=h*Rt,Ft+=h*gt,Bt+=h*bt,Ht+=h*yt,qt+=h*Xe,Wt+=h*Tt,rr+=h*Nt,h=T[11],Qe+=h*lt,at+=h*it,ze+=h*ft,et+=h*pt,$e+=h*ct,Ve+=h*nt,ht+=h*At,Me+=h*Ct,Ot+=h*dt,Ft+=h*Rt,Bt+=h*gt,Ht+=h*bt,qt+=h*yt,Wt+=h*Xe,rr+=h*Tt,Mr+=h*Nt,h=T[12],at+=h*lt,ze+=h*it,et+=h*ft,$e+=h*pt,Ve+=h*ct,ht+=h*nt,Me+=h*At,Ot+=h*Ct,Ft+=h*dt,Bt+=h*Rt,Ht+=h*gt,qt+=h*bt,Wt+=h*yt,rr+=h*Xe,Mr+=h*Tt,Jt+=h*Nt,h=T[13],ze+=h*lt,et+=h*it,$e+=h*ft,Ve+=h*pt,ht+=h*ct,Me+=h*nt,Ot+=h*At,Ft+=h*Ct,Bt+=h*dt,Ht+=h*Rt,qt+=h*gt,Wt+=h*bt,rr+=h*yt,Mr+=h*Xe,Jt+=h*Tt,Kr+=h*Nt,h=T[14],et+=h*lt,$e+=h*it,Ve+=h*ft,ht+=h*pt,Me+=h*ct,Ot+=h*nt,Ft+=h*At,Bt+=h*Ct,Ht+=h*dt,qt+=h*Rt,Wt+=h*gt,rr+=h*bt,Mr+=h*yt,Jt+=h*Xe,Kr+=h*Tt,ai+=h*Nt,h=T[15],$e+=h*lt,Ve+=h*it,ht+=h*ft,Me+=h*pt,Ot+=h*ct,Ft+=h*nt,Bt+=h*At,Ht+=h*Ct,qt+=h*dt,Wt+=h*Rt,rr+=h*gt,Mr+=h*bt,Jt+=h*yt,Kr+=h*Xe,ai+=h*Tt,xi+=h*Nt,ee+=38*Ve,fe+=38*ht,be+=38*Me,Ne+=38*Ot,De+=38*Ft,Pe+=38*Bt,Pt+=38*Ht,mt+=38*qt,ot+=38*Wt,Fe+=38*rr,Ze+=38*Mr,Qe+=38*Jt,at+=38*Kr,ze+=38*ai,et+=38*xi,E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=be+E+65535,E=Math.floor(h/65536),be=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=Pt+E+65535,E=Math.floor(h/65536),Pt=h-E*65536,h=mt+E+65535,E=Math.floor(h/65536),mt=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=Fe+E+65535,E=Math.floor(h/65536),Fe=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=at+E+65535,E=Math.floor(h/65536),at=h-E*65536,h=ze+E+65535,E=Math.floor(h/65536),ze=h-E*65536,h=et+E+65535,E=Math.floor(h/65536),et=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,ee+=E-1+37*(E-1),E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=be+E+65535,E=Math.floor(h/65536),be=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=Pt+E+65535,E=Math.floor(h/65536),Pt=h-E*65536,h=mt+E+65535,E=Math.floor(h/65536),mt=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=Fe+E+65535,E=Math.floor(h/65536),Fe=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=at+E+65535,E=Math.floor(h/65536),at=h-E*65536,h=ze+E+65535,E=Math.floor(h/65536),ze=h-E*65536,h=et+E+65535,E=Math.floor(h/65536),et=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,ee+=E-1+37*(E-1),N[0]=ee,N[1]=fe,N[2]=be,N[3]=Ne,N[4]=De,N[5]=Pe,N[6]=Pt,N[7]=mt,N[8]=ot,N[9]=Fe,N[10]=Ze,N[11]=Qe,N[12]=at,N[13]=ze,N[14]=et,N[15]=$e}function W(N,T){z(N,T,T)}function ye(N,T){const A=s();let h;for(h=0;h<16;h++)A[h]=T[h];for(h=253;h>=0;h--)W(A,A),h!==2&&h!==4&&z(A,A,T);for(h=0;h<16;h++)N[h]=A[h]}function re(N,T){const A=s();let h;for(h=0;h<16;h++)A[h]=T[h];for(h=250;h>=0;h--)W(A,A),h!==1&&z(A,A,T);for(h=0;h<16;h++)N[h]=A[h]}function ue(N,T){const A=s(),h=s(),E=s(),ee=s(),fe=s(),be=s(),Ne=s(),De=s(),Pe=s();$(A,N[1],N[0]),$(Pe,T[1],T[0]),z(A,A,Pe),le(h,N[0],N[1]),le(Pe,T[0],T[1]),z(h,h,Pe),z(E,N[3],T[3]),z(E,E,y),z(ee,N[2],T[2]),le(ee,ee,ee),$(fe,h,A),$(be,ee,E),le(Ne,ee,E),le(De,h,A),z(N[0],fe,be),z(N[1],De,Ne),z(N[2],Ne,be),z(N[3],fe,De)}function Te(N,T,A){for(let h=0;h<4;h++)K(N[h],T[h],A)}function Ue(N,T){const A=s(),h=s(),E=s();ye(E,T[2]),z(A,T[0],E),z(h,T[1],E),ie(N,h),N[31]^=pe(A)<<7}function _(N,T,A){U(N[0],l),U(N[1],p),U(N[2],p),U(N[3],l);for(let h=255;h>=0;--h){const E=A[h/8|0]>>(h&7)&1;Te(N,T,E),ue(T,N),ue(N,N),Te(N,T,E)}}function x(N,T){const A=[s(),s(),s(),s()];U(A[0],O),U(A[1],q),U(A[2],p),z(A[3],O,q),_(N,A,T)}function X(N){if(N.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const T=(0,t.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const A=new Uint8Array(32),h=[s(),s(),s(),s()];x(h,T),Ue(A,h);const E=new Uint8Array(64);return E.set(N),E.set(A,32),{publicKey:A,secretKey:E}}a.generateKeyPairFromSeed=X;function ce(N){const T=(0,r.randomBytes)(32,N),A=X(T);return(0,n.wipe)(T),A}a.generateKeyPair=ce;function V(N){if(N.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}a.extractPublicKeyFromSecretKey=V;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(N,T){let A,h,E,ee;for(h=63;h>=32;--h){for(A=0,E=h-32,ee=h-12;E<ee;++E)T[E]+=A-16*T[h]*B[E-(h-32)],A=Math.floor((T[E]+128)/256),T[E]-=A*256;T[E]+=A,T[h]=0}for(A=0,E=0;E<32;E++)T[E]+=A-(T[31]>>4)*B[E],A=T[E]>>8,T[E]&=255;for(E=0;E<32;E++)T[E]-=A*B[E];for(h=0;h<32;h++)T[h+1]+=T[h]>>8,N[h]=T[h]&255}function G(N){const T=new Float64Array(64);for(let A=0;A<64;A++)T[A]=N[A];for(let A=0;A<64;A++)N[A]=0;k(N,T)}function Ye(N,T){const A=new Float64Array(64),h=[s(),s(),s(),s()],E=(0,t.hash)(N.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const fe=new t.SHA512;fe.update(ee.subarray(32)),fe.update(T);const be=fe.digest();fe.clean(),G(be),x(h,be),Ue(ee,h),fe.reset(),fe.update(ee.subarray(0,32)),fe.update(N.subarray(32)),fe.update(T);const Ne=fe.digest();G(Ne);for(let De=0;De<32;De++)A[De]=be[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)A[De+Pe]+=Ne[De]*E[Pe];return k(ee.subarray(32),A),ee}a.sign=Ye;function ke(N,T){const A=s(),h=s(),E=s(),ee=s(),fe=s(),be=s(),Ne=s();return U(N[2],p),he(N[1],T),W(E,N[1]),z(ee,E,m),$(E,E,N[2]),le(ee,N[2],ee),W(fe,ee),W(be,fe),z(Ne,be,fe),z(A,Ne,E),z(A,A,ee),re(A,A),z(A,A,E),z(A,A,ee),z(A,A,ee),z(N[0],A,ee),W(h,N[0]),z(h,h,ee),ge(h,E)&&z(N[0],N[0],C),W(h,N[0]),z(h,h,ee),ge(h,E)?-1:(pe(N[0])===T[31]>>7&&$(N[0],l,N[0]),z(N[3],N[0],N[1]),0)}function jr(N,T,A){const h=new Uint8Array(32),E=[s(),s(),s(),s()],ee=[s(),s(),s(),s()];if(A.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(ke(ee,N))return!1;const fe=new t.SHA512;fe.update(A.subarray(0,32)),fe.update(N),fe.update(T);const be=fe.digest();return G(be),_(E,ee,be),x(ee,A.subarray(32)),ue(E,ee),Ue(h,E),!Ee(A,h)}a.verify=jr;function xe(N){let T=[s(),s(),s(),s()];if(ke(T,N))throw new Error("Ed25519: invalid public key");let A=s(),h=s(),E=T[1];le(A,p,E),$(h,p,E),ye(h,h),z(A,A,h);let ee=new Uint8Array(32);return ie(ee,A),ee}a.convertPublicKeyToX25519=xe;function St(N){const T=(0,t.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const A=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),A}a.convertSecretKeyToX25519=St})(jc);const hb="EdDSA",lb="JWT",Of=".",Af="base64url",fb="utf8",pb="utf8",db=":",gb="did",yb="key",fl="base58btc",vb="z",_b="K36",mb=32;function fo(a){return yo($c(Jn(a),fb),Af)}function Cf(a){const r=$c(_b,fl),t=vb+yo(j_([r,a]),fl);return[gb,yb,t].join(db)}function bb(a){return yo(a,Af)}function wb(a){return $c([fo(a.header),fo(a.payload)].join(Of),pb)}function Eb(a){return[fo(a.header),fo(a.payload),bb(a.signature)].join(Of)}function pl(a=rf.randomBytes(mb)){return jc.generateKeyPairFromSeed(a)}async function xb(a,r,t,n,s=se.fromMiliseconds(Date.now())){const c={alg:hb,typ:lb},l=Cf(n.publicKey),p=s+t,m={iss:l,sub:a,aud:r,iat:s,exp:p},y=wb({header:c,payload:m}),O=jc.sign(n.secretKey,y);return Eb({header:c,payload:m,signature:O})}const Ib="PARSE_ERROR",Sb="INVALID_REQUEST",Pb="METHOD_NOT_FOUND",Ob="INVALID_PARAMS",Rf="INTERNAL_ERROR",Mc="SERVER_ERROR",Ab=[-32700,-32600,-32601,-32602,-32603],Vn={[Ib]:{code:-32700,message:"Parse error"},[Sb]:{code:-32600,message:"Invalid Request"},[Pb]:{code:-32601,message:"Method not found"},[Ob]:{code:-32602,message:"Invalid params"},[Rf]:{code:-32603,message:"Internal error"},[Mc]:{code:-32e3,message:"Server error"}},Tf=Mc;function Cb(a){return Ab.includes(a)}function dl(a){return Object.keys(Vn).includes(a)?Vn[a]:Vn[Tf]}function Rb(a){const r=Object.values(Vn).find(t=>t.code===a);return r||Vn[Tf]}function Nf(a,r,t){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${r}`):a}var $f={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ec=function(a,r){return Ec=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ec(a,r)};function Tb(a,r){Ec(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var xc=function(){return xc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},xc.apply(this,arguments)};function Nb(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function $b(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function Db(a,r){return function(t,n){r(t,n,a)}}function Lb(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Fb(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function m(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):s(O.value).then(p,m)}y((n=n.apply(a,r||[])).next())})}function jb(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return m([y,O])}}function m(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Mb(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function qb(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function Ic(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function Df(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(p){l={error:p}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Ub(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(Df(arguments[r]));return a}function zb(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,s++)n[s]=c[l];return n}function Yn(a){return this instanceof Yn?(this.v=a,this):new Yn(a)}function Bb(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(C){n[C]&&(s[C]=function(U){return new Promise(function(L,K){c.push([C,U,L,K])>1||p(C,U)})})}function p(C,U){try{m(n[C](U))}catch(L){q(c[0][3],L)}}function m(C){C.value instanceof Yn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,U){C(U),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Hb(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Yn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function kb(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof Ic=="function"?Ic(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,m){l=a[c](l),s(p,m,l.done,l.value)})}}function s(c,l,p,m){Promise.resolve(m).then(function(y){c({value:y,done:p})},l)}}function Vb(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Kb(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Gb(a){return a&&a.__esModule?a:{default:a}}function Wb(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Jb(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Yb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xc},__asyncDelegator:Hb,__asyncGenerator:Bb,__asyncValues:kb,__await:Yn,__awaiter:Fb,__classPrivateFieldGet:Wb,__classPrivateFieldSet:Jb,__createBinding:Mb,__decorate:$b,__exportStar:qb,__extends:Tb,__generator:jb,__importDefault:Gb,__importStar:Kb,__makeTemplateObject:Vb,__metadata:Lb,__param:Db,__read:Df,__rest:Nb,__spread:Ub,__spreadArrays:zb,__values:Ic},Symbol.toStringTag,{value:"Module"})),Xb=Xn(Yb);var ni={},gl;function Zb(){if(gl)return ni;gl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(ur===null||ur===void 0?void 0:ur.crypto)||(ur===null||ur===void 0?void 0:ur.msCrypto)||{}}ni.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=r;function t(){return!!a()&&!!r()}return ni.isBrowserCryptoAvailable=t,ni}var si={},yl;function Qb(){if(yl)return si;yl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=r;function t(){return!a()&&!r()}return si.isBrowser=t,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Xb;r.__exportStar(Zb(),a),r.__exportStar(Qb(),a)})($f);function Lf(a=3){const r=Date.now()*Math.pow(10,a),t=Math.floor(Math.random()*Math.pow(10,a));return r+t}function qc(a=6){return BigInt(Lf(a))}function bo(a,r,t){return{id:t||Lf(),jsonrpc:"2.0",method:a,params:r}}function Uc(a,r){return{id:a,jsonrpc:"2.0",result:r}}function wo(a,r,t){return{id:a,jsonrpc:"2.0",error:ew(r,t)}}function ew(a,r){return typeof a>"u"?dl(Rf):(typeof a=="string"&&(a=Object.assign(Object.assign({},dl(Mc)),{message:a})),typeof r<"u"&&(a.data=r),Cb(a.code)&&(a=Rb(a.code)),a)}class tw{}class rw extends tw{constructor(){super()}}class iw extends rw{constructor(r){super()}}const nw="^https?:",sw="^wss?:";function ow(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function Ff(a,r){const t=ow(a);return typeof t>"u"?!1:new RegExp(r).test(t)}function vl(a){return Ff(a,nw)}function _l(a){return Ff(a,sw)}function aw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function jf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function zc(a){return jf(a)&&"method"in a}function Eo(a){return jf(a)&&(oi(a)||Fr(a))}function oi(a){return"result"in a}function Fr(a){return"error"in a}class wi extends iw{constructor(r){super(r),this.events=new yr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async request(r,t){return this.requestStrict(bo(r.method,r.params||[],r.id||qc().toString()),t)}async requestStrict(r,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${r.id}`,c=>{Fr(c)?s(c.error):n(c.result)});try{await this.connection.send(r,t)}catch(c){s(c)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),Eo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const cw=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),uw=()=>typeof window<"u",ml=a=>a.split("?")[0],bl=10,hw=cw();class lw{constructor(r){if(this.url=r,this.events=new yr.EventEmitter,this.registering=!1,!_l(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Jn(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!_l(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((t,n)=>{const s=$f.isReactNative()?void 0:{rejectUnauthorized:!aw(r)},c=new hw(r,[],s);uw()?c.onerror=l=>{const p=l;n(this.emitError(p.error))}:c.on("error",l=>{n(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(r){r.onmessage=t=>this.onPayload(t),r.onclose=t=>this.onClose(t),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Fc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=wo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return Nf(r,ml(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>bl&&this.events.setMaxListeners(bl)}emitError(r){const t=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${ml(this.url)}`));return this.events.emit("register_error",t),t}}var po={exports:{}};po.exports;(function(a,r){var t=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,p="[object Arguments]",m="[object Array]",y="[object AsyncFunction]",O="[object Boolean]",q="[object Date]",C="[object Error]",U="[object Function]",L="[object GeneratorFunction]",K="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",$="[object Set]",z="[object String]",W="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",B="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Ye=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,jr=/^(?:0|[1-9]\d*)$/,xe={};xe[Ue]=xe[_]=xe[x]=xe[X]=xe[ce]=xe[V]=xe[B]=xe[k]=xe[G]=!0,xe[p]=xe[m]=xe[ue]=xe[O]=xe[Te]=xe[q]=xe[C]=xe[U]=xe[K]=xe[ie]=xe[ge]=xe[le]=xe[$]=xe[z]=xe[re]=!1;var St=typeof ur=="object"&&ur&&ur.Object===Object&&ur,N=typeof self=="object"&&self&&self.Object===Object&&self,T=St||N||Function("return this")(),A=r&&!r.nodeType&&r,h=A&&!0&&a&&!a.nodeType&&a,E=h&&h.exports===A,ee=E&&St.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=fe&&fe.isTypedArray;function Ne(v,I){for(var M=-1,Y=v==null?0:v.length,Ge=0,ve=[];++M<Y;){var tt=v[M];I(tt,M,v)&&(ve[Ge++]=tt)}return ve}function De(v,I){for(var M=-1,Y=I.length,Ge=v.length;++M<Y;)v[Ge+M]=I[M];return v}function Pe(v,I){for(var M=-1,Y=v==null?0:v.length;++M<Y;)if(I(v[M],M,v))return!0;return!1}function Pt(v,I){for(var M=-1,Y=Array(v);++M<v;)Y[M]=I(M);return Y}function mt(v){return function(I){return v(I)}}function ot(v,I){return v.has(I)}function Fe(v,I){return v==null?void 0:v[I]}function Ze(v){var I=-1,M=Array(v.size);return v.forEach(function(Y,Ge){M[++I]=[Ge,Y]}),M}function Qe(v,I){return function(M){return v(I(M))}}function at(v){var I=-1,M=Array(v.size);return v.forEach(function(Y){M[++I]=Y}),M}var ze=Array.prototype,et=Function.prototype,$e=Object.prototype,Ve=T["__core-js_shared__"],ht=et.toString,Me=$e.hasOwnProperty,Ot=function(){var v=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ft=$e.toString,Bt=RegExp("^"+ht.call(Me).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=E?T.Buffer:void 0,qt=T.Symbol,Wt=T.Uint8Array,rr=$e.propertyIsEnumerable,Mr=ze.splice,Jt=qt?qt.toStringTag:void 0,Kr=Object.getOwnPropertySymbols,ai=Ht?Ht.isBuffer:void 0,xi=Qe(Object.keys,Object),lt=hr(T,"DataView"),it=hr(T,"Map"),ft=hr(T,"Promise"),pt=hr(T,"Set"),ct=hr(T,"WeakMap"),nt=hr(Object,"create"),At=Wr(lt),Ct=Wr(it),dt=Wr(ft),Rt=Wr(pt),gt=Wr(ct),bt=qt?qt.prototype:void 0,yt=bt?bt.valueOf:void 0;function Xe(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function Tt(){this.__data__=nt?nt(null):{},this.size=0}function Nt(v){var I=this.has(v)&&delete this.__data__[v];return this.size-=I?1:0,I}function So(v){var I=this.__data__;if(nt){var M=I[v];return M===n?void 0:M}return Me.call(I,v)?I[v]:void 0}function Po(v){var I=this.__data__;return nt?I[v]!==void 0:Me.call(I,v)}function Oo(v,I){var M=this.__data__;return this.size+=this.has(v)?0:1,M[v]=nt&&I===void 0?n:I,this}Xe.prototype.clear=Tt,Xe.prototype.delete=Nt,Xe.prototype.get=So,Xe.prototype.has=Po,Xe.prototype.set=Oo;function vr(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function Ao(){this.__data__=[],this.size=0}function Co(v){var I=this.__data__,M=Ii(I,v);if(M<0)return!1;var Y=I.length-1;return M==Y?I.pop():Mr.call(I,M,1),--this.size,!0}function Ro(v){var I=this.__data__,M=Ii(I,v);return M<0?void 0:I[M][1]}function To(v){return Ii(this.__data__,v)>-1}function No(v,I){var M=this.__data__,Y=Ii(M,v);return Y<0?(++this.size,M.push([v,I])):M[Y][1]=I,this}vr.prototype.clear=Ao,vr.prototype.delete=Co,vr.prototype.get=Ro,vr.prototype.has=To,vr.prototype.set=No;function Gr(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function zi(){this.size=0,this.__data__={hash:new Xe,map:new(it||vr),string:new Xe}}function $o(v){var I=ci(this,v).delete(v);return this.size-=I?1:0,I}function Bi(v){return ci(this,v).get(v)}function Do(v){return ci(this,v).has(v)}function Lo(v,I){var M=ci(this,v),Y=M.size;return M.set(v,I),this.size+=M.size==Y?0:1,this}Gr.prototype.clear=zi,Gr.prototype.delete=$o,Gr.prototype.get=Bi,Gr.prototype.has=Do,Gr.prototype.set=Lo;function Hi(v){var I=-1,M=v==null?0:v.length;for(this.__data__=new Gr;++I<M;)this.add(v[I])}function es(v){return this.__data__.set(v,n),this}function ts(v){return this.__data__.has(v)}Hi.prototype.add=Hi.prototype.push=es,Hi.prototype.has=ts;function Cr(v){var I=this.__data__=new vr(v);this.size=I.size}function Fo(){this.__data__=new vr,this.size=0}function jo(v){var I=this.__data__,M=I.delete(v);return this.size=I.size,M}function Mo(v){return this.__data__.get(v)}function qo(v){return this.__data__.has(v)}function rs(v,I){var M=this.__data__;if(M instanceof vr){var Y=M.__data__;if(!it||Y.length<t-1)return Y.push([v,I]),this.size=++M.size,this;M=this.__data__=new Gr(Y)}return M.set(v,I),this.size=M.size,this}Cr.prototype.clear=Fo,Cr.prototype.delete=jo,Cr.prototype.get=Mo,Cr.prototype.has=qo,Cr.prototype.set=rs;function is(v,I){var M=Ki(v),Y=!M&&gs(v),Ge=!M&&!Y&&vn(v),ve=!M&&!Y&&!Ge&&_s(v),tt=M||Y||Ge||ve,$t=tt?Pt(v.length,String):[],Ae=$t.length;for(var We in v)(I||Me.call(v,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||ve&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||hs(We,Ae)))&&$t.push(We);return $t}function Ii(v,I){for(var M=v.length;M--;)if(ds(v[M][0],I))return M;return-1}function gn(v,I,M){var Y=I(v);return Ki(v)?Y:De(Y,M(v))}function Si(v){return v==null?v===void 0?ye:Ee:Jt&&Jt in Object(v)?cs(v):Bo(v)}function yn(v){return Oi(v)&&Si(v)==p}function Pi(v,I,M,Y,Ge){return v===I?!0:v==null||I==null||!Oi(v)&&!Oi(I)?v!==v&&I!==I:ns(v,I,M,Y,Pi,Ge)}function ns(v,I,M,Y,Ge,ve){var tt=Ki(v),$t=Ki(I),Ae=tt?m:qr(v),We=$t?m:qr(I);Ae=Ae==p?ge:Ae,We=We==p?ge:We;var wt=Ae==ge,ir=We==ge,Dt=Ae==We;if(Dt&&vn(v)){if(!vn(I))return!1;tt=!0,wt=!1}if(Dt&&!wt)return ve||(ve=new Cr),tt||_s(v)?ki(v,I,M,Y,Ge,ve):zo(v,I,Ae,M,Y,Ge,ve);if(!(M&s)){var rt=wt&&Me.call(v,"__wrapped__"),Yt=ir&&Me.call(I,"__wrapped__");if(rt||Yt){var Rr=rt?v.value():v,_r=Yt?I.value():I;return ve||(ve=new Cr),Ge(Rr,_r,M,Y,ve)}}return Dt?(ve||(ve=new Cr),as(v,I,M,Y,Ge,ve)):!1}function Uo(v){if(!vs(v)||fs(v))return!1;var I=Gi(v)?Bt:ke;return I.test(Wr(v))}function ss(v){return Oi(v)&&ys(v.length)&&!!xe[Si(v)]}function os(v){if(!ps(v))return xi(v);var I=[];for(var M in Object(v))Me.call(v,M)&&M!="constructor"&&I.push(M);return I}function ki(v,I,M,Y,Ge,ve){var tt=M&s,$t=v.length,Ae=I.length;if($t!=Ae&&!(tt&&Ae>$t))return!1;var We=ve.get(v);if(We&&ve.get(I))return We==I;var wt=-1,ir=!0,Dt=M&c?new Hi:void 0;for(ve.set(v,I),ve.set(I,v);++wt<$t;){var rt=v[wt],Yt=I[wt];if(Y)var Rr=tt?Y(Yt,rt,wt,I,v,ve):Y(rt,Yt,wt,v,I,ve);if(Rr!==void 0){if(Rr)continue;ir=!1;break}if(Dt){if(!Pe(I,function(_r,Ur){if(!ot(Dt,Ur)&&(rt===_r||Ge(rt,_r,M,Y,ve)))return Dt.push(Ur)})){ir=!1;break}}else if(!(rt===Yt||Ge(rt,Yt,M,Y,ve))){ir=!1;break}}return ve.delete(v),ve.delete(I),ir}function zo(v,I,M,Y,Ge,ve,tt){switch(M){case Te:if(v.byteLength!=I.byteLength||v.byteOffset!=I.byteOffset)return!1;v=v.buffer,I=I.buffer;case ue:return!(v.byteLength!=I.byteLength||!ve(new Wt(v),new Wt(I)));case O:case q:case ie:return ds(+v,+I);case C:return v.name==I.name&&v.message==I.message;case le:case z:return v==I+"";case K:var $t=Ze;case $:var Ae=Y&s;if($t||($t=at),v.size!=I.size&&!Ae)return!1;var We=tt.get(v);if(We)return We==I;Y|=c,tt.set(v,I);var wt=ki($t(v),$t(I),Y,Ge,ve,tt);return tt.delete(v),wt;case W:if(yt)return yt.call(v)==yt.call(I)}return!1}function as(v,I,M,Y,Ge,ve){var tt=M&s,$t=Vi(v),Ae=$t.length,We=Vi(I),wt=We.length;if(Ae!=wt&&!tt)return!1;for(var ir=Ae;ir--;){var Dt=$t[ir];if(!(tt?Dt in I:Me.call(I,Dt)))return!1}var rt=ve.get(v);if(rt&&ve.get(I))return rt==I;var Yt=!0;ve.set(v,I),ve.set(I,v);for(var Rr=tt;++ir<Ae;){Dt=$t[ir];var _r=v[Dt],Ur=I[Dt];if(Y)var _n=tt?Y(Ur,_r,Dt,I,v,ve):Y(_r,Ur,Dt,v,I,ve);if(!(_n===void 0?_r===Ur||Ge(_r,Ur,M,Y,ve):_n)){Yt=!1;break}Rr||(Rr=Dt=="constructor")}if(Yt&&!Rr){var Ai=v.constructor,Ut=I.constructor;Ai!=Ut&&"constructor"in v&&"constructor"in I&&!(typeof Ai=="function"&&Ai instanceof Ai&&typeof Ut=="function"&&Ut instanceof Ut)&&(Yt=!1)}return ve.delete(v),ve.delete(I),Yt}function Vi(v){return gn(v,Vo,us)}function ci(v,I){var M=v.__data__;return ls(I)?M[typeof I=="string"?"string":"hash"]:M.map}function hr(v,I){var M=Fe(v,I);return Uo(M)?M:void 0}function cs(v){var I=Me.call(v,Jt),M=v[Jt];try{v[Jt]=void 0;var Y=!0}catch{}var Ge=Ft.call(v);return Y&&(I?v[Jt]=M:delete v[Jt]),Ge}var us=Kr?function(v){return v==null?[]:(v=Object(v),Ne(Kr(v),function(I){return rr.call(v,I)}))}:Ke,qr=Si;(lt&&qr(new lt(new ArrayBuffer(1)))!=Te||it&&qr(new it)!=K||ft&&qr(ft.resolve())!=pe||pt&&qr(new pt)!=$||ct&&qr(new ct)!=re)&&(qr=function(v){var I=Si(v),M=I==ge?v.constructor:void 0,Y=M?Wr(M):"";if(Y)switch(Y){case At:return Te;case Ct:return K;case dt:return pe;case Rt:return $;case gt:return re}return I});function hs(v,I){return I=I??l,!!I&&(typeof v=="number"||jr.test(v))&&v>-1&&v%1==0&&v<I}function ls(v){var I=typeof v;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?v!=="__proto__":v===null}function fs(v){return!!Ot&&Ot in v}function ps(v){var I=v&&v.constructor,M=typeof I=="function"&&I.prototype||$e;return v===M}function Bo(v){return Ft.call(v)}function Wr(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function ds(v,I){return v===I||v!==v&&I!==I}var gs=yn(function(){return arguments}())?yn:function(v){return Oi(v)&&Me.call(v,"callee")&&!rr.call(v,"callee")},Ki=Array.isArray;function Ho(v){return v!=null&&ys(v.length)&&!Gi(v)}var vn=ai||Be;function ko(v,I){return Pi(v,I)}function Gi(v){if(!vs(v))return!1;var I=Si(v);return I==U||I==L||I==y||I==he}function ys(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function vs(v){var I=typeof v;return v!=null&&(I=="object"||I=="function")}function Oi(v){return v!=null&&typeof v=="object"}var _s=be?mt(be):ss;function Vo(v){return Ho(v)?is(v):os(v)}function Ke(){return[]}function Be(){return!1}a.exports=ko})(po,po.exports);var fw=po.exports;const pw=Nc(fw);function dw(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<a.length;s++){var c=a.charAt(s),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=s}var p=a.length,m=a.charAt(0),y=Math.log(p)/Math.log(256),O=Math.log(256)/Math.log(p);function q(L){if(L instanceof Uint8Array||(ArrayBuffer.isView(L)?L=new Uint8Array(L.buffer,L.byteOffset,L.byteLength):Array.isArray(L)&&(L=Uint8Array.from(L))),!(L instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(L.length===0)return"";for(var K=0,ie=0,Ee=0,ge=L.length;Ee!==ge&&L[Ee]===0;)Ee++,K++;for(var pe=(ge-Ee)*O+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=L[Ee],$=0,z=pe-1;(le!==0||$<ie)&&z!==-1;z--,$++)le+=256*he[z]>>>0,he[z]=le%p>>>0,le=le/p>>>0;if(le!==0)throw new Error("Non-zero carry");ie=$,Ee++}for(var W=pe-ie;W!==pe&&he[W]===0;)W++;for(var ye=m.repeat(K);W<pe;++W)ye+=a.charAt(he[W]);return ye}function C(L){if(typeof L!="string")throw new TypeError("Expected String");if(L.length===0)return new Uint8Array;var K=0;if(L[K]!==" "){for(var ie=0,Ee=0;L[K]===m;)ie++,K++;for(var ge=(L.length-K)*y+1>>>0,pe=new Uint8Array(ge);L[K];){var he=t[L.charCodeAt(K)];if(he===255)return;for(var le=0,$=ge-1;(he!==0||le<Ee)&&$!==-1;$--,le++)he+=p*pe[$]>>>0,pe[$]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,K++}if(L[K]!==" "){for(var z=ge-Ee;z!==ge&&pe[z]===0;)z++;for(var W=new Uint8Array(ie+(ge-z)),ye=ie;z!==ge;)W[ye++]=pe[z++];return W}}}function U(L){var K=C(L);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:q,decodeUnsafe:C,decode:U}}var gw=dw,yw=gw;const Mf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},vw=a=>new TextEncoder().encode(a),_w=a=>new TextDecoder().decode(a);class mw{constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class bw{constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return qf(this,r)}}class ww{constructor(r){this.decoders=r}or(r){return qf(this,r)}decode(r){const t=r[0],n=this.decoders[t];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const qf=(a,r)=>new ww({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class Ew{constructor(r,t,n,s){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new mw(r,t,n),this.decoder=new bw(r,t,s)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const xo=({name:a,prefix:r,encode:t,decode:n})=>new Ew(a,r,t,n),Qn=({prefix:a,name:r,alphabet:t})=>{const{encode:n,decode:s}=yw(t,r);return xo({prefix:a,name:r,encode:n,decode:c=>Mf(s(c))})},xw=(a,r,t,n)=>{const s={};for(let O=0;O<r.length;++O)s[r[O]]=O;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let p=0,m=0,y=0;for(let O=0;O<c;++O){const q=s[a[O]];if(q===void 0)throw new SyntaxError(`Non-${n} character`);m=m<<t|q,p+=t,p>=8&&(p-=8,l[y++]=255&m>>p)}if(p>=t||255&m<<8-p)throw new SyntaxError("Unexpected end of data");return l},Iw=(a,r,t)=>{const n=r[r.length-1]==="=",s=(1<<t)-1;let c="",l=0,p=0;for(let m=0;m<a.length;++m)for(p=p<<8|a[m],l+=8;l>t;)l-=t,c+=r[s&p>>l];if(l&&(c+=r[s&p<<t-l]),n)for(;c.length*t&7;)c+="=";return c},Vt=({name:a,prefix:r,bitsPerChar:t,alphabet:n})=>xo({prefix:r,name:a,encode(s){return Iw(s,n,t)},decode(s){return xw(s,n,t,a)}}),Sw=xo({prefix:"\0",name:"identity",encode:a=>_w(a),decode:a=>vw(a)});var Pw=Object.freeze({__proto__:null,identity:Sw});const Ow=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Aw=Object.freeze({__proto__:null,base2:Ow});const Cw=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Rw=Object.freeze({__proto__:null,base8:Cw});const Tw=Qn({prefix:"9",name:"base10",alphabet:"0123456789"});var Nw=Object.freeze({__proto__:null,base10:Tw});const $w=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Dw=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Lw=Object.freeze({__proto__:null,base16:$w,base16upper:Dw});const Fw=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jw=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mw=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qw=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Uw=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zw=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bw=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Hw=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kw=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Vw=Object.freeze({__proto__:null,base32:Fw,base32upper:jw,base32pad:Mw,base32padupper:qw,base32hex:Uw,base32hexupper:zw,base32hexpad:Bw,base32hexpadupper:Hw,base32z:kw});const Kw=Qn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gw=Qn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ww=Object.freeze({__proto__:null,base36:Kw,base36upper:Gw});const Jw=Qn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yw=Qn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xw=Object.freeze({__proto__:null,base58btc:Jw,base58flickr:Yw});const Zw=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qw=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eE=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tE=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var rE=Object.freeze({__proto__:null,base64:Zw,base64pad:Qw,base64url:eE,base64urlpad:tE});const Uf=Array.from(""),iE=Uf.reduce((a,r,t)=>(a[t]=r,a),[]),nE=Uf.reduce((a,r,t)=>(a[r.codePointAt(0)]=t,a),[]);function sE(a){return a.reduce((r,t)=>(r+=iE[t],r),"")}function oE(a){const r=[];for(const t of a){const n=nE[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const aE=xo({prefix:"",name:"base256emoji",encode:sE,decode:oE});var cE=Object.freeze({__proto__:null,base256emoji:aE}),uE=zf,wl=128,hE=127,lE=~hE,fE=Math.pow(2,31);function zf(a,r,t){r=r||[],t=t||0;for(var n=t;a>=fE;)r[t++]=a&255|wl,a/=128;for(;a&lE;)r[t++]=a&255|wl,a>>>=7;return r[t]=a|0,zf.bytes=t-n+1,r}var pE=Sc,dE=128,El=127;function Sc(a,n){var t=0,n=n||0,s=0,c=n,l,p=a.length;do{if(c>=p)throw Sc.bytes=0,new RangeError("Could not decode varint");l=a[c++],t+=s<28?(l&El)<<s:(l&El)*Math.pow(2,s),s+=7}while(l>=dE);return Sc.bytes=c-n,t}var gE=Math.pow(2,7),yE=Math.pow(2,14),vE=Math.pow(2,21),_E=Math.pow(2,28),mE=Math.pow(2,35),bE=Math.pow(2,42),wE=Math.pow(2,49),EE=Math.pow(2,56),xE=Math.pow(2,63),IE=function(a){return a<gE?1:a<yE?2:a<vE?3:a<_E?4:a<mE?5:a<bE?6:a<wE?7:a<EE?8:a<xE?9:10},SE={encode:uE,decode:pE,encodingLength:IE},Bf=SE;const xl=(a,r,t=0)=>(Bf.encode(a,r,t),r),Il=a=>Bf.encodingLength(a),Pc=(a,r)=>{const t=r.byteLength,n=Il(a),s=n+Il(t),c=new Uint8Array(s+t);return xl(a,c,0),xl(t,c,n),c.set(r,s),new PE(a,t,r,c)};class PE{constructor(r,t,n,s){this.code=r,this.size=t,this.digest=n,this.bytes=s}}const Hf=({name:a,code:r,encode:t})=>new OE(a,r,t);class OE{constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){const t=this.encode(r);return t instanceof Uint8Array?Pc(this.code,t):t.then(n=>Pc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const kf=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),AE=Hf({name:"sha2-256",code:18,encode:kf("SHA-256")}),CE=Hf({name:"sha2-512",code:19,encode:kf("SHA-512")});var RE=Object.freeze({__proto__:null,sha256:AE,sha512:CE});const Vf=0,TE="identity",Kf=Mf,NE=a=>Pc(Vf,Kf(a)),$E={code:Vf,name:TE,encode:Kf,digest:NE};var DE=Object.freeze({__proto__:null,identity:$E});new TextEncoder,new TextDecoder;const Sl={...Pw,...Aw,...Rw,...Nw,...Lw,...Vw,...Ww,...Xw,...rE,...cE};({...RE,...DE});function Gf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function LE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Gf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Wf(a,r,t,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:t},decoder:{decode:n}}}const Pl=Wf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),rc=Wf("ascii","a",a=>{let r="a";for(let t=0;t<a.length;t++)r+=String.fromCharCode(a[t]);return r},a=>{a=a.substring(1);const r=LE(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);return r}),FE={utf8:Pl,"utf-8":Pl,hex:Sl.base16,latin1:rc,ascii:rc,binary:rc,...Sl};function jE(a,r="utf8"){const t=FE[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Gf(globalThis.Buffer.from(a,"utf-8")):t.decoder.decode(`${t.prefix}${a}`)}const Jf="wc",ME=2,Bc="core",bi=`${Jf}@2:${Bc}:`,qE={name:Bc,logger:"error"},UE={database:":memory:"},zE="crypto",Ol="client_ed25519_seed",BE=se.ONE_DAY,HE="keychain",kE="0.3",VE="messages",KE="0.3",GE=se.SIX_HOURS,WE="publisher",Yf="irn",JE="error",Xf="wss://relay.walletconnect.com",Al="wss://relay.walletconnect.org",YE="relayer",_t={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},XE="_subscription",qn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ZE=se.ONE_SECOND/2,QE="2.9.0",ex=1e4,tx="0.3",rx="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ix="subscription",nx="0.3",sx=se.FIVE_SECONDS*1e3,ox="pairing",ax="0.3",Un={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},cx="history",ux="0.3",hx="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},lx="0.3",ic="verify-api",Cl="https://verify.walletconnect.com";class fx{constructor(r,t){this.core=r,this.logger=t,this.keychain=new Map,this.name=HE,this.version=kE,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=Q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Re.generateChildLogger(t,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,af(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?cf(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class px{constructor(r,t,n){this.core=r,this.logger=t,this.name=zE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=pl(s);return Cf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=U_();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=pl(c),p=lc();return await xb(p,s,BE,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const p=this.getPrivateKey(s),m=z_(p,c);return this.setSymKey(m,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||B_(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const p=H_(l),m=Jn(c);if(Kh(p)){const C=p.senderPublicKey,U=p.receiverPublicKey;s=await this.generateSharedKey(C,U)}const y=this.getSymKey(s),{type:O,senderPublicKey:q}=p;return k_({type:O,symKey:y,message:m,senderPublicKey:q})},this.decode=async(s,c,l)=>{this.isInitialized();const p=V_(c,l);if(Kh(p)){const O=p.receiverPublicKey,q=p.senderPublicKey;s=await this.generateSharedKey(O,q)}const m=this.getSymKey(s),y=K_({symKey:m,encoded:c});return Fc(y)},this.getPayloadType=s=>{const c=Gh(s);return G_(c.type)},this.getPayloadSenderPublicKey=s=>{const c=Gh(s);return c.senderPublicKey?yo(c.senderPublicKey,W_):void 0},this.core=r,this.logger=Re.generateChildLogger(t,this.name),this.keychain=n||new fx(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(r,t){return await this.keychain.set(r,t),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(Ol)}catch{r=lc(),await this.keychain.set(Ol,r)}return jE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class dx extends Q1{constructor(r,t){super(r,t),this.logger=r,this.core=t,this.messages=new Map,this.name=VE,this.version=KE,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=ln(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=ln(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(r,this.name),this.core=t}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,af(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?cf(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class gx extends eb{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.events=new yr.EventEmitter,this.name=WE,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.queueTimeout=se.toMiliseconds(se.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const l=(c==null?void 0:c.ttl)||GE,p=fc(c),m=(c==null?void 0:c.prompt)||!1,y=(c==null?void 0:c.tag)||0,O=(c==null?void 0:c.id)||qc().toString(),q={topic:n,message:s,opts:{ttl:l,relay:p,prompt:m,tag:y,id:O}},C=setTimeout(()=>this.queue.set(O,q),this.queueTimeout);try{await await lo(this.rpcPublish(n,s,l,p,m,y,O),this.publishTimeout),clearTimeout(C),this.relayer.events.emit(_t.publish,q)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=r,this.logger=Re.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(r,t,n,s,c,l,p){var m,y,O,q;const C={method:ao(s.protocol).publish,params:{topic:r,message:t,ttl:n,prompt:c,tag:l},id:p};return mi((m=C.params)==null?void 0:m.prompt)&&((y=C.params)==null||delete y.prompt),mi((O=C.params)==null?void 0:O.tag)&&((q=C.params)==null||delete q.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:C}),this.relayer.request(C)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:t,message:n,opts:s}=r;await this.publish(t,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(_t.connection_stalled);return}this.checkQueue()}),this.relayer.on(_t.message_ack,r=>{this.onPublish(r.id.toString())})}}class yx{constructor(){this.map=new Map,this.set=(r,t)=>{const n=this.get(r);this.exists(r,t)||this.map.set(r,[...n,t])},this.get=r=>this.map.get(r)||[],this.exists=(r,t)=>this.get(r).includes(t),this.delete=(r,t)=>{if(typeof t>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,t))return;const s=n.filter(c=>c!==t);if(!s.length){this.map.delete(r);return}this.map.set(r,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var vx=Object.defineProperty,_x=Object.defineProperties,mx=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,wx=Object.prototype.propertyIsEnumerable,Tl=(a,r,t)=>r in a?vx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,zn=(a,r)=>{for(var t in r||(r={}))bx.call(r,t)&&Tl(a,t,r[t]);if(Rl)for(var t of Rl(r))wx.call(r,t)&&Tl(a,t,r[t]);return a},nc=(a,r)=>_x(a,mx(r));class Ex extends ib{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.subscriptions=new Map,this.topicMap=new yx,this.events=new yr.EventEmitter,this.name=ix,this.version=nx,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=fc(s),l={topic:n,relay:c};this.pending.set(n,l);const p=await this.rpcSubscribe(n,c);return this.onSubscribe(p,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new se.Watch;l.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=sx&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Re.generateChildLogger(t,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,t){let n=!1;try{n=this.getSubscription(r).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,t){const n=this.topicMap.get(r);await Promise.all(n.map(async s=>await this.unsubscribeById(r,s,t)))}async unsubscribeById(r,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}});try{const s=fc(n);await this.rpcUnsubscribe(r,t,s);const c=tr("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(r,t){const n={method:ao(t.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await lo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(_t.connection_stalled)}return ln(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const t=r[0].relay,n={method:ao(t.protocol).batchSubscribe,params:{topics:r.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await lo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(_t.connection_stalled)}}rpcUnsubscribe(r,t,n){const s={method:ao(n.protocol).unsubscribe,params:{topic:r,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(r,t){this.setSubscription(r,nc(zn({},t),{id:r})),this.pending.delete(t.topic)}onBatchSubscribe(r){r.length&&r.forEach(t=>{this.setSubscription(t.id,zn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(r,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,r)&&this.deleteSubscription(t,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,t){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:t}),this.addSubscription(r,t))}addSubscription(r,t){this.subscriptions.set(r,zn({},t)),this.topicMap.set(t.topic,r),this.events.emit(Vr.created,t)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const t=this.subscriptions.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}deleteSubscription(r,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:t});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Vr.deleted,nc(zn({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<r;t++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const t=await this.rpcBatchSubscribe(r);pn(t)&&this.onBatchSubscribe(t.map((n,s)=>nc(zn({},r[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(t=>{r.push(t)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(_t.connect,async()=>{await this.onConnect()}),this.relayer.on(_t.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async r=>{const t=Vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()}),this.events.on(Vr.deleted,async r=>{const t=Vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),r())},this.pollingInterval)})}}var xx=Object.defineProperty,Nl=Object.getOwnPropertySymbols,Ix=Object.prototype.hasOwnProperty,Sx=Object.prototype.propertyIsEnumerable,$l=(a,r,t)=>r in a?xx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Px=(a,r)=>{for(var t in r||(r={}))Ix.call(r,t)&&$l(a,t,r[t]);if(Nl)for(var t of Nl(r))Sx.call(r,t)&&$l(a,t,r[t]);return a};class Ox extends tb{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new yr.EventEmitter,this.name=YE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Re.generateChildLogger(r.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:r.logger||JE})),this.messages=new dx(this.logger,r.core),this.subscriber=new Ex(this,this.logger),this.publisher=new gx(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Xf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Al}...`),await this.restartTransport(Al)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},ex)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,t,n){this.isInitialized(),await this.publisher.publish(r,t,n),await this.recordMessageEvent({topic:r,message:t,publishedAt:Date.now()})}async subscribe(r,t){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return s||(await Promise.all([new Promise(c=>{this.subscriber.once(Vr.created,l=>{l.topic===r&&c()})}),new Promise(async c=>{s=await this.subscriber.subscribe(r,t),c()})]),s)}async unsubscribe(r,t){this.isInitialized(),await this.subscriber.unsubscribe(r,t)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(_t.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Vr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,n)=>{await lo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(s=>n(s)).then(()=>t()).finally(()=>this.removeListener(_t.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(_t.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.events.emit(_t.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(qn.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(t=>r.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new wi(new lw(J_({sdkVersion:QE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:t,message:n}=r;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(r){const{topic:t,message:n}=r;return await this.subscriber.isSubscribed(t)?this.messages.has(t,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),zc(r)){if(!r.method.endsWith(XE))return;const t=r.params,{topic:n,message:s,publishedAt:c}=t.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Px({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(r),await this.onMessageEvent(l)}else Eo(r)&&this.events.emit(_t.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(_t.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const t=Uc(r.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(qn.payload,r=>this.onProviderPayload(r)),this.provider.on(qn.connect,()=>{this.events.emit(_t.connect)}),this.provider.on(qn.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(qn.error,r=>{this.logger.error(r),this.events.emit(_t.error,r)})}registerEventListeners(){this.events.on(_t.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(_t.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},se.toMiliseconds(ZE))}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Ax=Object.defineProperty,Dl=Object.getOwnPropertySymbols,Cx=Object.prototype.hasOwnProperty,Rx=Object.prototype.propertyIsEnumerable,Ll=(a,r,t)=>r in a?Ax(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Fl=(a,r)=>{for(var t in r||(r={}))Cx.call(r,t)&&Ll(a,t,r[t]);if(Dl)for(var t of Dl(r))Rx.call(r,t)&&Ll(a,t,r[t]);return a};class Io extends rb{constructor(r,t,n,s=bi,c=void 0){super(r,t,n,s),this.core=r,this.logger=t,this.name=n,this.map=new Map,this.version=tx,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!mi(l)?this.map.set(this.getKey(l),l):M_(l)?this.map.set(l.id,l):q_(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,p)=>{this.isInitialized(),this.map.has(l)?await this.update(l,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:p}),this.map.set(l,p),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(p=>Object.keys(l).every(m=>pw(p[m],l[m]))):this.values),this.update=async(l,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:p});const m=Fl(Fl({},this.getData(l)),p);this.map.set(l,m),await this.persist()},this.delete=async(l,p)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:p}),this.map.delete(l),await this.persist())},this.logger=Re.generateChildLogger(t,this.name),this.storagePrefix=s,this.getKey=c}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const t=this.map.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Tx{constructor(r,t){this.core=r,this.logger=t,this.name=ox,this.version=ax,this.events=new Lc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[nf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=lc(),s=await this.core.crypto.setSymKey(n),c=Lr(se.FIVE_MINUTES),l={protocol:Yf},p={topic:s,expiry:c,relay:l,active:!1},m=Y_({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,p),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:m}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=X_(n.uri);if(this.pairings.keys.includes(s))throw new Error(`Pairing already exists: ${s}`);if(this.core.crypto.hasKeys(s))throw new Error(`Keychain already exists: ${s}`);const p=Lr(se.FIVE_MINUTES),m={topic:s,relay:l,expiry:p,active:!1};return await this.pairings.set(s,m),await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l}),this.core.expirer.set(s,p),n.activatePairing&&await this.activate({topic:s}),m},this.activate=async({topic:n})=>{this.isInitialized();const s=Lr(se.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:p,reject:m}=cn();this.events.once(Lt("pairing_ping",c),({error:y})=>{y?m(y):p()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=bo(s,c),p=await this.core.crypto.encode(n,l),m=Un[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,p,m),l.id},this.sendResult=async(n,s,c)=>{const l=Uc(n,c),p=await this.core.crypto.encode(s,l),m=await this.core.history.get(s,n),y=Un[m.request.method].res;await this.core.relayer.publish(s,p,y),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=wo(n,c),p=await this.core.crypto.encode(s,l),m=await this.core.history.get(s,n),y=Un[m.request.method]?Un[m.request.method].res:Un.unregistered_method.res;await this.core.relayer.publish(s,p,y),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>_i(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n,l=c.method;if(this.pairings.keys.includes(s))switch(l){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;if(this.pairings.keys.includes(s))switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit("pairing_ping",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{oi(s)?this.events.emit(Lt("pairing_ping",c),{}):Fr(s)&&this.events.emit(Lt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const p=tr("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,p),this.logger.error(p)}catch(p){await this.sendError(c,n,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!cr(n)){const{message:s}=Q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(s)}if(!Z_(n.uri)){const{message:s}=Q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(s)}},this.isValidPing=async n=>{if(!cr(n)){const{message:c}=Q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:c}=Q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!un(n,!1)){const{message:s}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(_i(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=Q("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=r,this.logger=Re.generateChildLogger(t,this.name),this.pairings=new Io(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(_t.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(t,n);zc(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Eo(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async r=>{const{topic:t}=sf(r.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class Nx extends Z1{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.records=new Map,this.events=new yr.EventEmitter,this.name=cx,this.version=ux,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:Lr(se.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(kr.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Fr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(kr.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(kr.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(t,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:bo(t.request.method,t.request.params,t.id),chainId:t.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const t=this.records.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(kr.created,r=>{const t=kr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(kr.updated,r=>{const t=kr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(kr.deleted,r=>{const t=kr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{se.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class $x extends nb{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.expirations=new Map,this.events=new yr.EventEmitter,this.name=hx,this.version=lx,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Or.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Or.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(t,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return Q_(r);if(typeof r=="number")return em(r);const{message:t}=Q("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(t)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const t=this.expirations.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(r,t){const{expiry:n}=t;se.toMiliseconds(n)-Date.now()<=0&&this.expire(r,t)}expire(r,t){this.expirations.delete(r),this.events.emit(Or.expired,{target:r,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,t)=>this.checkExpiry(t,r))}registerEventListeners(){this.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Or.created,r=>{const t=Or.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Or.expired,r=>{const t=Or.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Or.deleted,r=>{const t=Or.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Dx extends sb{constructor(r,t){super(r,t),this.projectId=r,this.logger=t,this.name=ic,this.initialized=!1,this.init=async n=>{tm()||!of()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||Cl,await this.createIframe())},this.register=async n=>{var s;if(this.initialized||await this.init(),!!this.iframe)try{(s=this.iframe.contentWindow)==null||s.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var s;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const c=this.startAbortTimer(se.FIVE_SECONDS),l=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?(s=await l.json())==null?void 0:s.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,s)=>{if(document.getElementById(ic))return n();const c=document.createElement("iframe");c.setAttribute("id",ic),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,n()}),c.addEventListener("error",l=>{s(l)}),document.body.append(c),this.iframe=c}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),se.toMiliseconds(se.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Re.generateChildLogger(t,this.name),this.verifyUrl=Cl,this.abortController=new AbortController,this.isDevEnv=rm()&&{}.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),se.toMiliseconds(r))}}var Lx=Object.defineProperty,jl=Object.getOwnPropertySymbols,Fx=Object.prototype.hasOwnProperty,jx=Object.prototype.propertyIsEnumerable,Ml=(a,r,t)=>r in a?Lx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,ql=(a,r)=>{for(var t in r||(r={}))Fx.call(r,t)&&Ml(a,t,r[t]);if(jl)for(var t of jl(r))jx.call(r,t)&&Ml(a,t,r[t]);return a};class Hc extends X1{constructor(r){super(r),this.protocol=Jf,this.version=ME,this.name=Bc,this.events=new yr.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Xf;const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||qE.logger}));this.logger=Re.generateChildLogger(t,this.name),this.heartbeat=new dn.HeartBeat,this.crypto=new px(this,this.logger,r==null?void 0:r.keychain),this.history=new Nx(this,this.logger),this.expirer=new $x(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new t1(ql(ql({},UE),r==null?void 0:r.storageOptions)),this.relayer=new Ox({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Tx(this,this.logger),this.verify=new Dx(this.projectId||"",this.logger)}static async init(r){const t=new Hc(r);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(rx,n),t}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const Mx=Hc,Zf="wc",Qf=2,ep="client",kc=`${Zf}@${Qf}:${ep}:`,sc={name:ep,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},qx="WALLETCONNECT_DEEPLINK_CHOICE",Ux="proposal",tp="Proposal expired",zx="session",no=se.SEVEN_DAYS,Bx="engine",Bn={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},oc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},Hx="request",kx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Vx=Object.defineProperty,Kx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,Wx=Object.prototype.hasOwnProperty,Jx=Object.prototype.propertyIsEnumerable,zl=(a,r,t)=>r in a?Vx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Pr=(a,r)=>{for(var t in r||(r={}))Wx.call(r,t)&&zl(a,t,r[t]);if(Ul)for(var t of Ul(r))Jx.call(r,t)&&zl(a,t,r[t]);return a},ac=(a,r)=>Kx(a,Gx(r));class Yx extends ab{constructor(r){super(r),this.name=Bx,this.events=new Lc,this.initialized=!1,this.ignoredPayloadTypes=[nf],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Bn)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const n=ac(Pr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:p,relays:m}=n;let y=s,O,q=!1;if(y&&(q=this.client.core.pairing.pairings.get(y).active),!y||!q){const{topic:pe,uri:he}=await this.client.core.pairing.create();y=pe,O=he}const C=await this.client.core.crypto.generateKeyPair(),U=Pr({requiredNamespaces:c,optionalNamespaces:l,relays:m??[{protocol:Yf}],proposer:{publicKey:C,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:L,resolve:K,done:ie}=cn(se.FIVE_MINUTES,tp);if(this.events.once(Lt("session_connect"),async({error:pe,session:he})=>{if(pe)L(pe);else if(he){he.self.publicKey=C;const le=ac(Pr({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:he.peer.metadata}),K(le)}}),!y){const{message:pe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(pe)}const Ee=await this.sendRequest(y,"wc_sessionPropose",U),ge=Lr(se.FIVE_MINUTES);return await this.setProposal(Ee,Pr({id:Ee,expiry:ge},U)),{uri:O,approval:ie}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=t,p=this.client.proposal.get(n);let{pairingTopic:m,proposer:y,requiredNamespaces:O,optionalNamespaces:q}=p;m=m||"",co(O)||(O=nm(c,"approve()"));const C=await this.client.core.crypto.generateKeyPair(),U=y.publicKey,L=await this.client.core.crypto.generateSharedKey(C,U);m&&n&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:y.metadata}),await this.sendResult(n,m,{relay:{protocol:s??"irn"},responderPublicKey:C}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const K=Pr({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:O,optionalNamespaces:q,pairingTopic:m,controller:{publicKey:C,metadata:this.client.metadata},expiry:Lr(no)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(L),await this.sendRequest(L,"wc_sessionSettle",K);const ie=ac(Pr({},K),{topic:L,pairingTopic:m,acknowledged:!1,self:K.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:C});return await this.client.session.set(L,ie),await this.setExpiry(L,Lr(no)),{topic:L,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(L)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:n,reason:s}=t,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:s}=t,c=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:s}),{done:l,resolve:p,reject:m}=cn();return this.events.once(Lt("session_update",c),({error:y})=>{y?m(y):p()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,s=await this.sendRequest(n,"wc_sessionExtend",{}),{done:c,resolve:l,reject:p}=cn();return this.events.once(Lt("session_extend",s),({error:m})=>{m?p(m):l()}),await this.setExpiry(n,Lr(no)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:s,topic:c,expiry:l}=t,p=await this.sendRequest(c,"wc_sessionRequest",{request:s,chainId:n},l),{done:m,resolve:y,reject:O}=cn(l);this.events.once(Lt("session_request",p),({error:C,result:U})=>{C?O(C):y(U)}),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:p});const q=await this.client.core.storage.getItem(qx);return sm({id:p,topic:c,wcDeepLink:q}),await m()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:c}=s;oi(s)?await this.sendResult(c,n,s.result):Fr(s)&&await this.sendError(c,n,s.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=await this.sendRequest(n,"wc_sessionPing",{}),{done:c,resolve:l,reject:p}=cn();this.events.once(Lt("session_ping",s),({error:m})=>{m?p(m):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:s,chainId:c}=t;await this.sendRequest(n,"wc_sessionEvent",{event:s,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=qc().toString();let c;const l=p=>{(p==null?void 0:p.id.toString())===s&&(this.client.core.relayer.events.removeListener(_t.message_ack,l),c())};await Promise.all([new Promise(p=>{c=p,this.client.core.relayer.on(_t.message_ack,l)}),this.sendRequest(n,"wc_sessionDelete",tr("USER_DISCONNECTED"),void 0,s)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>om(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,p;return((l=c.peerMetadata)==null?void 0:l.url)&&((p=c.peerMetadata)==null?void 0:p.url)===t.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(t,n)=>{const{self:s}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t)},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=Bn.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l}=t;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l}),n&&this.client.core.expirer.set(s,Lr(n))},this.sendRequest=async(t,n,s,c,l)=>{const p=bo(n,s);if(of()&&kx.includes(n)){const O=ln(JSON.stringify(p));await this.client.core.verify.register({attestationId:O})}const m=await this.client.core.crypto.encode(t,p),y=Bn[n].req;return c&&(y.ttl=c),l&&(y.id=l),this.client.core.history.set(t,p),this.client.core.relayer.publish(t,m,y),p.id},this.sendResult=async(t,n,s)=>{const c=Uc(t,s),l=await this.client.core.crypto.encode(n,c),p=await this.client.core.history.get(n,t),m=Bn[p.request.method].res;this.client.core.relayer.publish(n,l,m),await this.client.core.history.resolve(c)},this.sendError=async(t,n,s)=>{const c=wo(t,s),l=await this.client.core.crypto.encode(n,c),p=await this.client.core.history.get(n,t),m=Bn[p.request.method].res;this.client.core.relayer.publish(n,l,m),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{_i(s.expiry)&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{_i(s.expiry)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=t=>{const{topic:n,payload:s}=t,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:s}=t,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:s}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(t,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(Pr({},n.params));const l=Lr(se.FIVE_MINUTES),p=Pr({id:c,pairingTopic:t,expiry:l},s);await this.setProposal(c,p);const m=ln(JSON.stringify(n)),y=await this.getVerifyContext(m,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:y})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,n)=>{const{id:s}=n;if(oi(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const p=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const m=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const y=await this.client.core.crypto.generateSharedKey(p,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const O=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:O}),await this.client.core.pairing.activate({topic:t})}else Fr(n)&&(await this.client.proposal.delete(s,tr("USER_DISCONNECTED")),this.events.emit(Lt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:p,expiry:m,namespaces:y,requiredNamespaces:O,optionalNamespaces:q,sessionProperties:C,pairingTopic:U}=n.params,L=Pr({topic:t,relay:l,expiry:m,namespaces:y,acknowledged:!0,pairingTopic:U,requiredNamespaces:O,optionalNamespaces:q,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},C&&{sessionProperties:C});await this.sendResult(n.id,t,!0),this.events.emit(Lt("session_connect"),{session:L}),this.cleanupDuplicatePairings(L)}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,n)=>{const{id:s}=n;oi(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Lt("session_approve",s),{})):Fr(n)&&(await this.client.session.delete(t,tr("USER_DISCONNECTED")),this.events.emit(Lt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:s,id:c}=n;try{this.isValidUpdate(Pr({topic:t},s)),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:s})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Lt("session_update",s),{}):Fr(n)&&this.events.emit(Lt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Lr(no)),await this.sendResult(s,t,!0),this.client.events.emit("session_extend",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Lt("session_extend",s),{}):Fr(n)&&this.events.emit(Lt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult(s,t,!0),this.client.events.emit("session_ping",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,n)=>{const{id:s}=n;setTimeout(()=>{oi(n)?this.events.emit(Lt("session_ping",s),{}):Fr(n)&&this.events.emit(Lt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(_t.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(s,t,!0)]),this.client.events.emit("session_delete",{id:s,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(Pr({topic:t},c)),await this.setPendingSessionRequest({id:s,topic:t,params:c});const l=ln(JSON.stringify(n)),p=this.client.session.get(t),m=await this.getVerifyContext(l,p.peer.metadata);this.client.events.emit("session_request",{id:s,topic:t,params:c,verifyContext:m})}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Lt("session_request",s),{result:n.result}):Fr(n)&&this.events.emit(Lt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidEmit(Pr({topic:t},c)),this.client.events.emit("session_event",{id:s,topic:t,params:c})}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.isValidConnect=async t=>{if(!cr(t)){const{message:m}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(m)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:p}=t;if(mi(n)||await this.isValidPairingTopic(n),!am(p,!0)){const{message:m}=Q("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(m)}!mi(s)&&co(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!mi(c)&&co(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),mi(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,n)=>{const s=cm(t,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async t=>{if(!cr(t))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(n);const p=this.client.proposal.get(n),m=Ja(s,"approve()");if(m)throw new Error(m.message);const y=Wh(p.requiredNamespaces,s,"approve()");if(y)throw new Error(y.message);if(!un(c,!0)){const{message:O}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(O)}mi(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!cr(t)){const{message:c}=Q("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:n,reason:s}=t;if(await this.isValidProposalId(n),!um(s)){const{message:c}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!cr(t)){const{message:y}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}const{relay:n,controller:s,namespaces:c,expiry:l}=t;if(!hm(n)){const{message:y}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const p=lm(s,"onSessionSettleRequest()");if(p)throw new Error(p.message);const m=Ja(c,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(_i(l)){const{message:y}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async t=>{if(!cr(t)){const{message:m}=Q("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(m)}const{topic:n,namespaces:s}=t;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=Ja(s,"update()");if(l)throw new Error(l.message);const p=Wh(c.requiredNamespaces,s,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!cr(t)){const{message:s}=Q("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!cr(t)){const{message:m}=Q("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(m)}const{topic:n,request:s,chainId:c,expiry:l}=t;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Jh(p,c)){const{message:m}=Q("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(m)}if(!fm(s)){const{message:m}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(m)}if(!pm(p,c,s.method)){const{message:m}=Q("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(m)}if(l&&!dm(l,oc)){const{message:m}=Q("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${oc.min} and ${oc.max}`);throw new Error(m)}},this.isValidRespond=async t=>{if(!cr(t)){const{message:c}=Q("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:s}=t;if(await this.isValidSessionTopic(n),!gm(s)){const{message:c}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!cr(t)){const{message:s}=Q("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!cr(t)){const{message:p}=Q("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:n,event:s,chainId:c}=t;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Jh(l,c)){const{message:p}=Q("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!ym(s)){const{message:p}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}if(!vm(l,c,s.name)){const{message:p}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!cr(t)){const{message:s}=Q("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const s={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c,s.verified.validation=c===n.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(s=>{if(!un(s,!1)){const{message:c}=Q("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(_t.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(t,n);zc(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Eo(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.client.core.history.delete(t,s.id)):this.onRelayEventUnknownPayload({topic:t,payload:s})})}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async r=>{const{topic:t,id:n}=sf(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Q("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!un(r,!1)){const{message:t}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.core.pairing.pairings.get(r).expiry)){const{message:t}=Q("EXPIRED",`pairing topic: ${r}`);throw new Error(t)}}async isValidSessionTopic(r){if(!un(r,!1)){const{message:t}=Q("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(t)}if(!this.client.session.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:t}=Q("EXPIRED",`session topic: ${r}`);throw new Error(t)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(un(r,!1)){const{message:t}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(t)}else{const{message:t}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(t)}}async isValidProposalId(r){if(!_m(r)){const{message:t}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(t)}if(!this.client.proposal.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:t}=Q("EXPIRED",`proposal id: ${r}`);throw new Error(t)}}}class Xx extends Io{constructor(r,t){super(r,t,Ux,kc),this.core=r,this.logger=t}}class Zx extends Io{constructor(r,t){super(r,t,zx,kc),this.core=r,this.logger=t}}class Qx extends Io{constructor(r,t){super(r,t,Hx,kc,n=>n.id),this.core=r,this.logger=t}}let eI=class rp extends ob{constructor(r){super(r),this.protocol=Zf,this.version=Qf,this.name=sc.name,this.events=new yr.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||sc.name,this.metadata=(r==null?void 0:r.metadata)||im();const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||sc.logger}));this.core=(r==null?void 0:r.core)||new Mx(r),this.logger=Re.generateChildLogger(t,this.name),this.session=new Zx(this.core,this.logger),this.proposal=new Xx(this.core,this.logger),this.pendingRequest=new Qx(this.core,this.logger),this.engine=new Yx(this)}static async init(r){const t=new rp(r);return await t.initialize(),t}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Oc={exports:{}};(function(a,r){var t=typeof self<"u"?self:ur,n=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var p={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function m(_){return _&&DataView.prototype.isPrototypeOf(_)}if(p.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],O=ArrayBuffer.isView||function(_){return _&&y.indexOf(Object.prototype.toString.call(_))>-1};function q(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function C(_){return typeof _!="string"&&(_=String(_)),_}function U(_){var x={next:function(){var X=_.shift();return{done:X===void 0,value:X}}};return p.iterable&&(x[Symbol.iterator]=function(){return x}),x}function L(_){this.map={},_ instanceof L?_.forEach(function(x,X){this.append(X,x)},this):Array.isArray(_)?_.forEach(function(x){this.append(x[0],x[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(x){this.append(x,_[x])},this)}L.prototype.append=function(_,x){_=q(_),x=C(x);var X=this.map[_];this.map[_]=X?X+", "+x:x},L.prototype.delete=function(_){delete this.map[q(_)]},L.prototype.get=function(_){return _=q(_),this.has(_)?this.map[_]:null},L.prototype.has=function(_){return this.map.hasOwnProperty(q(_))},L.prototype.set=function(_,x){this.map[q(_)]=C(x)},L.prototype.forEach=function(_,x){for(var X in this.map)this.map.hasOwnProperty(X)&&_.call(x,this.map[X],X,this)},L.prototype.keys=function(){var _=[];return this.forEach(function(x,X){_.push(X)}),U(_)},L.prototype.values=function(){var _=[];return this.forEach(function(x){_.push(x)}),U(_)},L.prototype.entries=function(){var _=[];return this.forEach(function(x,X){_.push([X,x])}),U(_)},p.iterable&&(L.prototype[Symbol.iterator]=L.prototype.entries);function K(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function ie(_){return new Promise(function(x,X){_.onload=function(){x(_.result)},_.onerror=function(){X(_.error)}})}function Ee(_){var x=new FileReader,X=ie(x);return x.readAsArrayBuffer(_),X}function ge(_){var x=new FileReader,X=ie(x);return x.readAsText(_),X}function pe(_){for(var x=new Uint8Array(_),X=new Array(x.length),ce=0;ce<x.length;ce++)X[ce]=String.fromCharCode(x[ce]);return X.join("")}function he(_){if(_.slice)return _.slice(0);var x=new Uint8Array(_.byteLength);return x.set(new Uint8Array(_)),x.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:p.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:p.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():p.arrayBuffer&&p.blob&&m(_)?(this._bodyArrayBuffer=he(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||O(_))?this._bodyArrayBuffer=he(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var $=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function z(_){var x=_.toUpperCase();return $.indexOf(x)>-1?x:_}function W(_,x){x=x||{};var X=x.body;if(_ instanceof W){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,x.headers||(this.headers=new L(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!X&&_._bodyInit!=null&&(X=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new L(x.headers)),this.method=z(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ye(_){var x=new FormData;return _.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),B=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(V),decodeURIComponent(B))}}),x}function re(_){var x=new L,X=_.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),B=V.shift().trim();if(B){var k=V.join(":").trim();x.append(B,k)}}),x}le.call(W.prototype);function ue(_,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new L(x.headers),this.url=x.url||"",this._initBody(_)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new L(this.headers),url:this.url})},ue.error=function(){var _=new ue(null,{status:0,statusText:""});return _.type="error",_};var Te=[301,302,303,307,308];ue.redirect=function(_,x){if(Te.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:_}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(x,X){this.message=x,this.name=X;var ce=Error(x);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function Ue(_,x){return new Promise(function(X,ce){var V=new W(_,x);if(V.signal&&V.signal.aborted)return ce(new l.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function k(){B.abort()}B.onload=function(){var G={status:B.status,statusText:B.statusText,headers:re(B.getAllResponseHeaders()||"")};G.url="responseURL"in B?B.responseURL:G.headers.get("X-Request-URL");var Ye="response"in B?B.response:B.responseText;X(new ue(Ye,G))},B.onerror=function(){ce(new TypeError("Network request failed"))},B.ontimeout=function(){ce(new TypeError("Network request failed"))},B.onabort=function(){ce(new l.DOMException("Aborted","AbortError"))},B.open(V.method,V.url,!0),V.credentials==="include"?B.withCredentials=!0:V.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&p.blob&&(B.responseType="blob"),V.headers.forEach(function(G,Ye){B.setRequestHeader(Ye,G)}),V.signal&&(V.signal.addEventListener("abort",k),B.onreadystatechange=function(){B.readyState===4&&V.signal.removeEventListener("abort",k)}),B.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return Ue.polyfill=!0,c.fetch||(c.fetch=Ue,c.Headers=L,c.Request=W,c.Response=ue),l.Headers=L,l.Request=W,l.Response=ue,l.fetch=Ue,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;r=s.fetch,r.default=s.fetch,r.fetch=s.fetch,r.Headers=s.Headers,r.Request=s.Request,r.Response=s.Response,a.exports=r})(Oc,Oc.exports);var tI=Oc.exports;const Bl=Nc(tI),rI={Accept:"application/json","Content-Type":"application/json"},iI="POST",Hl={headers:rI,method:iI},kl=10;class Ui{constructor(r,t=!1){if(this.url=r,this.disableProviderPing=t,this.events=new yr.EventEmitter,this.isAvailable=!1,this.registering=!1,!vl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,t){this.isAvailable||await this.register();try{const n=Jn(r),c=await(await Bl(this.url,Object.assign(Object.assign({},Hl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!vl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const t=Jn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Bl(r,Object.assign(Object.assign({},Hl),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Fc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=wo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return Nf(r,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>kl&&this.events.setMaxListeners(kl)}}const Vl="error",nI="wss://relay.walletconnect.com",sI="wc",oI="universal_provider",Kl=`${sI}@2:${oI}:`,aI="https://rpc.walletconnect.com/v1",Ei={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ac={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var t,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",p="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",y=500,O="__lodash_placeholder__",q=1,C=2,U=4,L=1,K=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,$=64,z=128,W=256,ye=512,re=30,ue="...",Te=800,Ue=16,_=1,x=2,X=3,ce=1/0,V=9007199254740991,B=17976931348623157e292,k=0/0,G=4294967295,Ye=G-1,ke=G>>>1,jr=[["ary",z],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",$],["rearg",W]],xe="[object Arguments]",St="[object Array]",N="[object AsyncFunction]",T="[object Boolean]",A="[object Date]",h="[object DOMException]",E="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",De="[object Null]",Pe="[object Object]",Pt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",Fe="[object Set]",Ze="[object String]",Qe="[object Symbol]",at="[object Undefined]",ze="[object WeakMap]",et="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",Ot="[object Int8Array]",Ft="[object Int16Array]",Bt="[object Int32Array]",Ht="[object Uint8Array]",qt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",Mr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,lt=RegExp(ai.source),it=RegExp(xi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,bt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Xe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,So=/[()=,{}\[\]\/\s]/,Po=/\\(\\)?/g,Oo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,Ao=/^[-+]0x[0-9a-f]+$/i,Co=/^0b[01]+$/i,Ro=/^\[object .+?Constructor\]$/,To=/^0o[0-7]+$/i,No=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zi=/($^)/,$o=/['\n\r\u2028\u2029\\]/g,Bi="\\ud800-\\udfff",Do="\\u0300-\\u036f",Lo="\\ufe20-\\ufe2f",Hi="\\u20d0-\\u20ff",es=Do+Lo+Hi,ts="\\u2700-\\u27bf",Cr="a-z\\xdf-\\xf6\\xf8-\\xff",Fo="\\xac\\xb1\\xd7\\xf7",jo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mo="\\u2000-\\u206f",qo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rs="A-Z\\xc0-\\xd6\\xd8-\\xde",is="\\ufe0e\\ufe0f",Ii=Fo+jo+Mo+qo,gn="[']",Si="["+Bi+"]",yn="["+Ii+"]",Pi="["+es+"]",ns="\\d+",Uo="["+ts+"]",ss="["+Cr+"]",os="[^"+Bi+Ii+ns+ts+Cr+rs+"]",ki="\\ud83c[\\udffb-\\udfff]",zo="(?:"+Pi+"|"+ki+")",as="[^"+Bi+"]",Vi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+rs+"]",cs="\\u200d",us="(?:"+ss+"|"+os+")",qr="(?:"+hr+"|"+os+")",hs="(?:"+gn+"(?:d|ll|m|re|s|t|ve))?",ls="(?:"+gn+"(?:D|LL|M|RE|S|T|VE))?",fs=zo+"?",ps="["+is+"]?",Bo="(?:"+cs+"(?:"+[as,Vi,ci].join("|")+")"+ps+fs+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ds="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",gs=ps+fs+Bo,Ki="(?:"+[Uo,Vi,ci].join("|")+")"+gs,Ho="(?:"+[as+Pi+"?",Pi,Vi,ci,Si].join("|")+")",vn=RegExp(gn,"g"),ko=RegExp(Pi,"g"),Gi=RegExp(ki+"(?="+ki+")|"+Ho+gs,"g"),ys=RegExp([hr+"?"+ss+"+"+hs+"(?="+[yn,hr,"$"].join("|")+")",qr+"+"+ls+"(?="+[yn,hr+us,"$"].join("|")+")",hr+"?"+us+"+"+hs,hr+"+"+ls,ds,Wr,ns,Ki].join("|"),"g"),vs=RegExp("["+cs+Bi+es+is+"]"),Oi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_s=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Vo=-1,Ke={};Ke[ht]=Ke[Me]=Ke[Ot]=Ke[Ft]=Ke[Bt]=Ke[Ht]=Ke[qt]=Ke[Wt]=Ke[rr]=!0,Ke[xe]=Ke[St]=Ke[$e]=Ke[T]=Ke[Ve]=Ke[A]=Ke[E]=Ke[ee]=Ke[be]=Ke[Ne]=Ke[Pe]=Ke[ot]=Ke[Fe]=Ke[Ze]=Ke[ze]=!1;var Be={};Be[xe]=Be[St]=Be[$e]=Be[Ve]=Be[T]=Be[A]=Be[ht]=Be[Me]=Be[Ot]=Be[Ft]=Be[Bt]=Be[be]=Be[Ne]=Be[Pe]=Be[ot]=Be[Fe]=Be[Ze]=Be[Qe]=Be[Ht]=Be[qt]=Be[Wt]=Be[rr]=!0,Be[E]=Be[ee]=Be[ze]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,ve=parseInt,tt=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,$t=typeof self=="object"&&self&&self.Object===Object&&self,Ae=tt||$t||Function("return this")(),We=r&&!r.nodeType&&r,wt=We&&!0&&a&&!a.nodeType&&a,ir=wt&&wt.exports===We,Dt=ir&&tt.process,rt=function(){try{var S=wt&&wt.require&&wt.require("util").types;return S||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),Yt=rt&&rt.isArrayBuffer,Rr=rt&&rt.isDate,_r=rt&&rt.isMap,Ur=rt&&rt.isRegExp,_n=rt&&rt.isSet,Ai=rt&&rt.isTypedArray;function Ut(S,D,R){switch(R.length){case 0:return S.call(D);case 1:return S.call(D,R[0]);case 2:return S.call(D,R[0],R[1]);case 3:return S.call(D,R[0],R[1],R[2])}return S.apply(D,R)}function sp(S,D,R,Z){for(var de=-1,Le=S==null?0:S.length;++de<Le;){var jt=S[de];D(Z,jt,R(jt),S)}return Z}function mr(S,D){for(var R=-1,Z=S==null?0:S.length;++R<Z&&D(S[R],R,S)!==!1;);return S}function op(S,D){for(var R=S==null?0:S.length;R--&&D(S[R],R,S)!==!1;);return S}function Gc(S,D){for(var R=-1,Z=S==null?0:S.length;++R<Z;)if(!D(S[R],R,S))return!1;return!0}function ui(S,D){for(var R=-1,Z=S==null?0:S.length,de=0,Le=[];++R<Z;){var jt=S[R];D(jt,R,S)&&(Le[de++]=jt)}return Le}function ms(S,D){var R=S==null?0:S.length;return!!R&&Wi(S,D,0)>-1}function Ko(S,D,R){for(var Z=-1,de=S==null?0:S.length;++Z<de;)if(R(D,S[Z]))return!0;return!1}function st(S,D){for(var R=-1,Z=S==null?0:S.length,de=Array(Z);++R<Z;)de[R]=D(S[R],R,S);return de}function hi(S,D){for(var R=-1,Z=D.length,de=S.length;++R<Z;)S[de+R]=D[R];return S}function Go(S,D,R,Z){var de=-1,Le=S==null?0:S.length;for(Z&&Le&&(R=S[++de]);++de<Le;)R=D(R,S[de],de,S);return R}function ap(S,D,R,Z){var de=S==null?0:S.length;for(Z&&de&&(R=S[--de]);de--;)R=D(R,S[de],de,S);return R}function Wo(S,D){for(var R=-1,Z=S==null?0:S.length;++R<Z;)if(D(S[R],R,S))return!0;return!1}var cp=Jo("length");function up(S){return S.split("")}function hp(S){return S.match(Nt)||[]}function Wc(S,D,R){var Z;return R(S,function(de,Le,jt){if(D(de,Le,jt))return Z=Le,!1}),Z}function bs(S,D,R,Z){for(var de=S.length,Le=R+(Z?1:-1);Z?Le--:++Le<de;)if(D(S[Le],Le,S))return Le;return-1}function Wi(S,D,R){return D===D?Ep(S,D,R):bs(S,Jc,R)}function lp(S,D,R,Z){for(var de=R-1,Le=S.length;++de<Le;)if(Z(S[de],D))return de;return-1}function Jc(S){return S!==S}function Yc(S,D){var R=S==null?0:S.length;return R?Xo(S,D)/R:k}function Jo(S){return function(D){return D==null?t:D[S]}}function Yo(S){return function(D){return S==null?t:S[D]}}function Xc(S,D,R,Z,de){return de(S,function(Le,jt,Je){R=Z?(Z=!1,Le):D(R,Le,jt,Je)}),R}function fp(S,D){var R=S.length;for(S.sort(D);R--;)S[R]=S[R].value;return S}function Xo(S,D){for(var R,Z=-1,de=S.length;++Z<de;){var Le=D(S[Z]);Le!==t&&(R=R===t?Le:R+Le)}return R}function Zo(S,D){for(var R=-1,Z=Array(S);++R<S;)Z[R]=D(R);return Z}function pp(S,D){return st(D,function(R){return[R,S[R]]})}function Zc(S){return S&&S.slice(0,ru(S)+1).replace(gt,"")}function lr(S){return function(D){return S(D)}}function Qo(S,D){return st(D,function(R){return S[R]})}function mn(S,D){return S.has(D)}function Qc(S,D){for(var R=-1,Z=S.length;++R<Z&&Wi(D,S[R],0)>-1;);return R}function eu(S,D){for(var R=S.length;R--&&Wi(D,S[R],0)>-1;);return R}function dp(S,D){for(var R=S.length,Z=0;R--;)S[R]===D&&++Z;return Z}var gp=Yo(v),yp=Yo(I);function vp(S){return"\\"+Y[S]}function _p(S,D){return S==null?t:S[D]}function Ji(S){return vs.test(S)}function mp(S){return Oi.test(S)}function bp(S){for(var D,R=[];!(D=S.next()).done;)R.push(D.value);return R}function ea(S){var D=-1,R=Array(S.size);return S.forEach(function(Z,de){R[++D]=[de,Z]}),R}function tu(S,D){return function(R){return S(D(R))}}function li(S,D){for(var R=-1,Z=S.length,de=0,Le=[];++R<Z;){var jt=S[R];(jt===D||jt===O)&&(S[R]=O,Le[de++]=R)}return Le}function ws(S){var D=-1,R=Array(S.size);return S.forEach(function(Z){R[++D]=Z}),R}function wp(S){var D=-1,R=Array(S.size);return S.forEach(function(Z){R[++D]=[Z,Z]}),R}function Ep(S,D,R){for(var Z=R-1,de=S.length;++Z<de;)if(S[Z]===D)return Z;return-1}function xp(S,D,R){for(var Z=R+1;Z--;)if(S[Z]===D)return Z;return Z}function Yi(S){return Ji(S)?Sp(S):cp(S)}function Tr(S){return Ji(S)?Pp(S):up(S)}function ru(S){for(var D=S.length;D--&&bt.test(S.charAt(D)););return D}var Ip=Yo(M);function Sp(S){for(var D=Gi.lastIndex=0;Gi.test(S);)++D;return D}function Pp(S){return S.match(Gi)||[]}function Op(S){return S.match(ys)||[]}var Ap=function S(D){D=D==null?Ae:Xi.defaults(Ae.Object(),D,Xi.pick(Ae,_s));var R=D.Array,Z=D.Date,de=D.Error,Le=D.Function,jt=D.Math,Je=D.Object,ta=D.RegExp,Cp=D.String,br=D.TypeError,Es=R.prototype,Rp=Le.prototype,Zi=Je.prototype,xs=D["__core-js_shared__"],Is=Rp.toString,qe=Zi.hasOwnProperty,Tp=0,iu=function(){var e=/[^.]+$/.exec(xs&&xs.keys&&xs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ss=Zi.toString,Np=Is.call(Je),$p=Ae._,Dp=ta("^"+Is.call(qe).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ps=ir?D.Buffer:t,fi=D.Symbol,Os=D.Uint8Array,nu=Ps?Ps.allocUnsafe:t,As=tu(Je.getPrototypeOf,Je),su=Je.create,ou=Zi.propertyIsEnumerable,Cs=Es.splice,au=fi?fi.isConcatSpreadable:t,bn=fi?fi.iterator:t,Ci=fi?fi.toStringTag:t,Rs=function(){try{var e=Di(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Lp=D.clearTimeout!==Ae.clearTimeout&&D.clearTimeout,Fp=Z&&Z.now!==Ae.Date.now&&Z.now,jp=D.setTimeout!==Ae.setTimeout&&D.setTimeout,Ts=jt.ceil,Ns=jt.floor,ra=Je.getOwnPropertySymbols,Mp=Ps?Ps.isBuffer:t,cu=D.isFinite,qp=Es.join,Up=tu(Je.keys,Je),Mt=jt.max,Kt=jt.min,zp=Z.now,Bp=D.parseInt,uu=jt.random,Hp=Es.reverse,ia=Di(D,"DataView"),wn=Di(D,"Map"),na=Di(D,"Promise"),Qi=Di(D,"Set"),En=Di(D,"WeakMap"),xn=Di(Je,"create"),$s=En&&new En,en={},kp=Li(ia),Vp=Li(wn),Kp=Li(na),Gp=Li(Qi),Wp=Li(En),Ds=fi?fi.prototype:t,In=Ds?Ds.valueOf:t,hu=Ds?Ds.toString:t;function d(e){if(vt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof wr)return e;if(qe.call(e,"__wrapped__"))return lh(e)}return new wr(e)}var tn=function(){function e(){}return function(i){if(!ut(i))return{};if(su)return su(i);e.prototype=i;var o=new e;return e.prototype=t,o}}();function Ls(){}function wr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}d.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:d}},d.prototype=Ls.prototype,d.prototype.constructor=d,wr.prototype=tn(Ls.prototype),wr.prototype.constructor=wr;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Jp(){var e=new Oe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Yp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Xp(){var e=this.__wrapped__.value(),i=this.__dir__,o=_e(e),u=i<0,f=o?e.length:0,g=ug(0,f,this.__views__),b=g.start,w=g.end,P=w-b,F=u?w:b-1,j=this.__iteratees__,H=j.length,J=0,te=Kt(P,this.__takeCount__);if(!o||!u&&f==P&&te==P)return Du(e,this.__actions__);var oe=[];e:for(;P--&&J<te;){F+=i;for(var we=-1,ae=e[F];++we<H;){var Se=j[we],Ce=Se.iteratee,dr=Se.type,Qt=Ce(ae);if(dr==x)ae=Qt;else if(!Qt){if(dr==_)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=tn(Ls.prototype),Oe.prototype.constructor=Oe;function Ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Zp(){this.__data__=xn?xn(null):{},this.size=0}function Qp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function ed(e){var i=this.__data__;if(xn){var o=i[e];return o===m?t:o}return qe.call(i,e)?i[e]:t}function td(e){var i=this.__data__;return xn?i[e]!==t:qe.call(i,e)}function rd(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=xn&&i===t?m:i,this}Ri.prototype.clear=Zp,Ri.prototype.delete=Qp,Ri.prototype.get=ed,Ri.prototype.has=td,Ri.prototype.set=rd;function Jr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function id(){this.__data__=[],this.size=0}function nd(e){var i=this.__data__,o=Fs(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Cs.call(i,o,1),--this.size,!0}function sd(e){var i=this.__data__,o=Fs(i,e);return o<0?t:i[o][1]}function od(e){return Fs(this.__data__,e)>-1}function ad(e,i){var o=this.__data__,u=Fs(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Jr.prototype.clear=id,Jr.prototype.delete=nd,Jr.prototype.get=sd,Jr.prototype.has=od,Jr.prototype.set=ad;function Yr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function cd(){this.size=0,this.__data__={hash:new Ri,map:new(wn||Jr),string:new Ri}}function ud(e){var i=Ws(this,e).delete(e);return this.size-=i?1:0,i}function hd(e){return Ws(this,e).get(e)}function ld(e){return Ws(this,e).has(e)}function fd(e,i){var o=Ws(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Yr.prototype.clear=cd,Yr.prototype.delete=ud,Yr.prototype.get=hd,Yr.prototype.has=ld,Yr.prototype.set=fd;function Ti(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Yr;++i<o;)this.add(e[i])}function pd(e){return this.__data__.set(e,m),this}function dd(e){return this.__data__.has(e)}Ti.prototype.add=Ti.prototype.push=pd,Ti.prototype.has=dd;function Nr(e){var i=this.__data__=new Jr(e);this.size=i.size}function gd(){this.__data__=new Jr,this.size=0}function yd(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function vd(e){return this.__data__.get(e)}function _d(e){return this.__data__.has(e)}function md(e,i){var o=this.__data__;if(o instanceof Jr){var u=o.__data__;if(!wn||u.length<s-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Yr(u)}return o.set(e,i),this.size=o.size,this}Nr.prototype.clear=gd,Nr.prototype.delete=yd,Nr.prototype.get=vd,Nr.prototype.has=_d,Nr.prototype.set=md;function lu(e,i){var o=_e(e),u=!o&&Fi(e),f=!o&&!u&&vi(e),g=!o&&!u&&!f&&on(e),b=o||u||f||g,w=b?Zo(e.length,Cp):[],P=w.length;for(var F in e)(i||qe.call(e,F))&&!(b&&(F=="length"||f&&(F=="offset"||F=="parent")||g&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||ei(F,P)))&&w.push(F);return w}function fu(e){var i=e.length;return i?e[ga(0,i-1)]:t}function bd(e,i){return Js(nr(e),Ni(i,0,e.length))}function wd(e){return Js(nr(e))}function sa(e,i,o){(o!==t&&!$r(e[i],o)||o===t&&!(i in e))&&Xr(e,i,o)}function Sn(e,i,o){var u=e[i];(!(qe.call(e,i)&&$r(u,o))||o===t&&!(i in e))&&Xr(e,i,o)}function Fs(e,i){for(var o=e.length;o--;)if($r(e[o][0],i))return o;return-1}function Ed(e,i,o,u){return pi(e,function(f,g,b){i(u,f,o(f),b)}),u}function pu(e,i){return e&&Br(i,zt(i),e)}function xd(e,i){return e&&Br(i,or(i),e)}function Xr(e,i,o){i=="__proto__"&&Rs?Rs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function oa(e,i){for(var o=-1,u=i.length,f=R(u),g=e==null;++o<u;)f[o]=g?t:Ua(e,i[o]);return f}function Ni(e,i,o){return e===e&&(o!==t&&(e=e<=o?e:o),i!==t&&(e=e>=i?e:i)),e}function Er(e,i,o,u,f,g){var b,w=i&q,P=i&C,F=i&U;if(o&&(b=f?o(e,u,f,g):o(e)),b!==t)return b;if(!ut(e))return e;var j=_e(e);if(j){if(b=lg(e),!w)return nr(e,b)}else{var H=Gt(e),J=H==ee||H==fe;if(vi(e))return ju(e,w);if(H==Pe||H==xe||J&&!f){if(b=P||J?{}:rh(e),!w)return P?eg(e,xd(b,e)):Qd(e,pu(b,e))}else{if(!Be[H])return f?e:{};b=fg(e,H,w)}}g||(g=new Nr);var te=g.get(e);if(te)return te;g.set(e,b),Th(e)?e.forEach(function(ae){b.add(Er(ae,i,o,ae,e,g))}):Ch(e)&&e.forEach(function(ae,Se){b.set(Se,Er(ae,i,o,Se,e,g))});var oe=F?P?Pa:Sa:P?or:zt,we=j?t:oe(e);return mr(we||e,function(ae,Se){we&&(Se=ae,ae=e[Se]),Sn(b,Se,Er(ae,i,o,Se,e,g))}),b}function Id(e){var i=zt(e);return function(o){return du(o,e,i)}}function du(e,i,o){var u=o.length;if(e==null)return!u;for(e=Je(e);u--;){var f=o[u],g=i[f],b=e[f];if(b===t&&!(f in e)||!g(b))return!1}return!0}function gu(e,i,o){if(typeof e!="function")throw new br(l);return Nn(function(){e.apply(t,o)},i)}function Pn(e,i,o,u){var f=-1,g=ms,b=!0,w=e.length,P=[],F=i.length;if(!w)return P;o&&(i=st(i,lr(o))),u?(g=Ko,b=!1):i.length>=s&&(g=mn,b=!1,i=new Ti(i));e:for(;++f<w;){var j=e[f],H=o==null?j:o(j);if(j=u||j!==0?j:0,b&&H===H){for(var J=F;J--;)if(i[J]===H)continue e;P.push(j)}else g(i,H,u)||P.push(j)}return P}var pi=Bu(zr),yu=Bu(ca,!0);function Sd(e,i){var o=!0;return pi(e,function(u,f,g){return o=!!i(u,f,g),o}),o}function js(e,i,o){for(var u=-1,f=e.length;++u<f;){var g=e[u],b=i(g);if(b!=null&&(w===t?b===b&&!pr(b):o(b,w)))var w=b,P=g}return P}function Pd(e,i,o,u){var f=e.length;for(o=me(o),o<0&&(o=-o>f?0:f+o),u=u===t||u>f?f:me(u),u<0&&(u+=f),u=o>u?0:$h(u);o<u;)e[o++]=i;return e}function vu(e,i){var o=[];return pi(e,function(u,f,g){i(u,f,g)&&o.push(u)}),o}function kt(e,i,o,u,f){var g=-1,b=e.length;for(o||(o=dg),f||(f=[]);++g<b;){var w=e[g];i>0&&o(w)?i>1?kt(w,i-1,o,u,f):hi(f,w):u||(f[f.length]=w)}return f}var aa=Hu(),_u=Hu(!0);function zr(e,i){return e&&aa(e,i,zt)}function ca(e,i){return e&&_u(e,i,zt)}function Ms(e,i){return ui(i,function(o){return ti(e[o])})}function $i(e,i){i=gi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Hr(i[o++])];return o&&o==u?e:t}function mu(e,i,o){var u=i(e);return _e(e)?u:hi(u,o(e))}function Xt(e){return e==null?e===t?at:De:Ci&&Ci in Je(e)?cg(e):wg(e)}function ua(e,i){return e>i}function Od(e,i){return e!=null&&qe.call(e,i)}function Ad(e,i){return e!=null&&i in Je(e)}function Cd(e,i,o){return e>=Kt(i,o)&&e<Mt(i,o)}function ha(e,i,o){for(var u=o?Ko:ms,f=e[0].length,g=e.length,b=g,w=R(g),P=1/0,F=[];b--;){var j=e[b];b&&i&&(j=st(j,lr(i))),P=Kt(j.length,P),w[b]=!o&&(i||f>=120&&j.length>=120)?new Ti(b&&j):t}j=e[0];var H=-1,J=w[0];e:for(;++H<f&&F.length<P;){var te=j[H],oe=i?i(te):te;if(te=o||te!==0?te:0,!(J?mn(J,oe):u(F,oe,o))){for(b=g;--b;){var we=w[b];if(!(we?mn(we,oe):u(e[b],oe,o)))continue e}J&&J.push(oe),F.push(te)}}return F}function Rd(e,i,o,u){return zr(e,function(f,g,b){i(u,o(f),g,b)}),u}function On(e,i,o){i=gi(i,e),e=oh(e,i);var u=e==null?e:e[Hr(Ir(i))];return u==null?t:Ut(u,e,o)}function bu(e){return vt(e)&&Xt(e)==xe}function Td(e){return vt(e)&&Xt(e)==$e}function Nd(e){return vt(e)&&Xt(e)==A}function An(e,i,o,u,f){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:$d(e,i,o,u,An,f)}function $d(e,i,o,u,f,g){var b=_e(e),w=_e(i),P=b?St:Gt(e),F=w?St:Gt(i);P=P==xe?Pe:P,F=F==xe?Pe:F;var j=P==Pe,H=F==Pe,J=P==F;if(J&&vi(e)){if(!vi(i))return!1;b=!0,j=!1}if(J&&!j)return g||(g=new Nr),b||on(e)?Qu(e,i,o,u,f,g):og(e,i,P,o,u,f,g);if(!(o&L)){var te=j&&qe.call(e,"__wrapped__"),oe=H&&qe.call(i,"__wrapped__");if(te||oe){var we=te?e.value():e,ae=oe?i.value():i;return g||(g=new Nr),f(we,ae,o,u,g)}}return J?(g||(g=new Nr),ag(e,i,o,u,f,g)):!1}function Dd(e){return vt(e)&&Gt(e)==be}function la(e,i,o,u){var f=o.length,g=f,b=!u;if(e==null)return!g;for(e=Je(e);f--;){var w=o[f];if(b&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++f<g;){w=o[f];var P=w[0],F=e[P],j=w[1];if(b&&w[2]){if(F===t&&!(P in e))return!1}else{var H=new Nr;if(u)var J=u(F,j,P,e,i,H);if(!(J===t?An(j,F,L|K,u,H):J))return!1}}return!0}function wu(e){if(!ut(e)||yg(e))return!1;var i=ti(e)?Dp:Ro;return i.test(Li(e))}function Ld(e){return vt(e)&&Xt(e)==ot}function Fd(e){return vt(e)&&Gt(e)==Fe}function jd(e){return vt(e)&&to(e.length)&&!!Ke[Xt(e)]}function Eu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?_e(e)?Su(e[0],e[1]):Iu(e):kh(e)}function fa(e){if(!Tn(e))return Up(e);var i=[];for(var o in Je(e))qe.call(e,o)&&o!="constructor"&&i.push(o);return i}function Md(e){if(!ut(e))return bg(e);var i=Tn(e),o=[];for(var u in e)u=="constructor"&&(i||!qe.call(e,u))||o.push(u);return o}function pa(e,i){return e<i}function xu(e,i){var o=-1,u=sr(e)?R(e.length):[];return pi(e,function(f,g,b){u[++o]=i(f,g,b)}),u}function Iu(e){var i=Aa(e);return i.length==1&&i[0][2]?nh(i[0][0],i[0][1]):function(o){return o===e||la(o,e,i)}}function Su(e,i){return Ra(e)&&ih(i)?nh(Hr(e),i):function(o){var u=Ua(o,e);return u===t&&u===i?za(o,e):An(i,u,L|K)}}function qs(e,i,o,u,f){e!==i&&aa(i,function(g,b){if(f||(f=new Nr),ut(g))qd(e,i,b,o,qs,u,f);else{var w=u?u(Na(e,b),g,b+"",e,i,f):t;w===t&&(w=g),sa(e,b,w)}},or)}function qd(e,i,o,u,f,g,b){var w=Na(e,o),P=Na(i,o),F=b.get(P);if(F){sa(e,o,F);return}var j=g?g(w,P,o+"",e,i,b):t,H=j===t;if(H){var J=_e(P),te=!J&&vi(P),oe=!J&&!te&&on(P);j=P,J||te||oe?_e(w)?j=w:Et(w)?j=nr(w):te?(H=!1,j=ju(P,!0)):oe?(H=!1,j=Mu(P,!0)):j=[]:$n(P)||Fi(P)?(j=w,Fi(w)?j=Dh(w):(!ut(w)||ti(w))&&(j=rh(P))):H=!1}H&&(b.set(P,j),f(j,P,u,g,b),b.delete(P)),sa(e,o,j)}function Pu(e,i){var o=e.length;if(o)return i+=i<0?o:0,ei(i,o)?e[i]:t}function Ou(e,i,o){i.length?i=st(i,function(g){return _e(g)?function(b){return $i(b,g.length===1?g[0]:g)}:g}):i=[ar];var u=-1;i=st(i,lr(ne()));var f=xu(e,function(g,b,w){var P=st(i,function(F){return F(g)});return{criteria:P,index:++u,value:g}});return fp(f,function(g,b){return Zd(g,b,o)})}function Ud(e,i){return Au(e,i,function(o,u){return za(e,u)})}function Au(e,i,o){for(var u=-1,f=i.length,g={};++u<f;){var b=i[u],w=$i(e,b);o(w,b)&&Cn(g,gi(b,e),w)}return g}function zd(e){return function(i){return $i(i,e)}}function da(e,i,o,u){var f=u?lp:Wi,g=-1,b=i.length,w=e;for(e===i&&(i=nr(i)),o&&(w=st(e,lr(o)));++g<b;)for(var P=0,F=i[g],j=o?o(F):F;(P=f(w,j,P,u))>-1;)w!==e&&Cs.call(w,P,1),Cs.call(e,P,1);return e}function Cu(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==g){var g=f;ei(f)?Cs.call(e,f,1):_a(e,f)}}return e}function ga(e,i){return e+Ns(uu()*(i-e+1))}function Bd(e,i,o,u){for(var f=-1,g=Mt(Ts((i-e)/(o||1)),0),b=R(g);g--;)b[u?g:++f]=e,e+=o;return b}function ya(e,i){var o="";if(!e||i<1||i>V)return o;do i%2&&(o+=e),i=Ns(i/2),i&&(e+=e);while(i);return o}function Ie(e,i){return $a(sh(e,i,ar),e+"")}function Hd(e){return fu(an(e))}function kd(e,i){var o=an(e);return Js(o,Ni(i,0,o.length))}function Cn(e,i,o,u){if(!ut(e))return e;i=gi(i,e);for(var f=-1,g=i.length,b=g-1,w=e;w!=null&&++f<g;){var P=Hr(i[f]),F=o;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(f!=b){var j=w[P];F=u?u(j,P,w):t,F===t&&(F=ut(j)?j:ei(i[f+1])?[]:{})}Sn(w,P,F),w=w[P]}return e}var Ru=$s?function(e,i){return $s.set(e,i),e}:ar,Vd=Rs?function(e,i){return Rs(e,"toString",{configurable:!0,enumerable:!1,value:Ha(i),writable:!0})}:ar;function Kd(e){return Js(an(e))}function xr(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var g=R(f);++u<f;)g[u]=e[u+i];return g}function Gd(e,i){var o;return pi(e,function(u,f,g){return o=i(u,f,g),!o}),!!o}function Us(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=ke){for(;u<f;){var g=u+f>>>1,b=e[g];b!==null&&!pr(b)&&(o?b<=i:b<i)?u=g+1:f=g}return f}return va(e,i,ar,o)}function va(e,i,o,u){var f=0,g=e==null?0:e.length;if(g===0)return 0;i=o(i);for(var b=i!==i,w=i===null,P=pr(i),F=i===t;f<g;){var j=Ns((f+g)/2),H=o(e[j]),J=H!==t,te=H===null,oe=H===H,we=pr(H);if(b)var ae=u||oe;else F?ae=oe&&(u||J):w?ae=oe&&J&&(u||!te):P?ae=oe&&J&&!te&&(u||!we):te||we?ae=!1:ae=u?H<=i:H<i;ae?f=j+1:g=j}return Kt(g,Ye)}function Tu(e,i){for(var o=-1,u=e.length,f=0,g=[];++o<u;){var b=e[o],w=i?i(b):b;if(!o||!$r(w,P)){var P=w;g[f++]=b===0?0:b}}return g}function Nu(e){return typeof e=="number"?e:pr(e)?k:+e}function fr(e){if(typeof e=="string")return e;if(_e(e))return st(e,fr)+"";if(pr(e))return hu?hu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function di(e,i,o){var u=-1,f=ms,g=e.length,b=!0,w=[],P=w;if(o)b=!1,f=Ko;else if(g>=s){var F=i?null:ng(e);if(F)return ws(F);b=!1,f=mn,P=new Ti}else P=i?[]:w;e:for(;++u<g;){var j=e[u],H=i?i(j):j;if(j=o||j!==0?j:0,b&&H===H){for(var J=P.length;J--;)if(P[J]===H)continue e;i&&P.push(H),w.push(j)}else f(P,H,o)||(P!==w&&P.push(H),w.push(j))}return w}function _a(e,i){return i=gi(i,e),e=oh(e,i),e==null||delete e[Hr(Ir(i))]}function $u(e,i,o,u){return Cn(e,i,o($i(e,i)),u)}function zs(e,i,o,u){for(var f=e.length,g=u?f:-1;(u?g--:++g<f)&&i(e[g],g,e););return o?xr(e,u?0:g,u?g+1:f):xr(e,u?g+1:0,u?f:g)}function Du(e,i){var o=e;return o instanceof Oe&&(o=o.value()),Go(i,function(u,f){return f.func.apply(f.thisArg,hi([u],f.args))},o)}function ma(e,i,o){var u=e.length;if(u<2)return u?di(e[0]):[];for(var f=-1,g=R(u);++f<u;)for(var b=e[f],w=-1;++w<u;)w!=f&&(g[f]=Pn(g[f]||b,e[w],i,o));return di(kt(g,1),i,o)}function Lu(e,i,o){for(var u=-1,f=e.length,g=i.length,b={};++u<f;){var w=u<g?i[u]:t;o(b,e[u],w)}return b}function ba(e){return Et(e)?e:[]}function wa(e){return typeof e=="function"?e:ar}function gi(e,i){return _e(e)?e:Ra(e,i)?[e]:hh(je(e))}var Wd=Ie;function yi(e,i,o){var u=e.length;return o=o===t?u:o,!i&&o>=u?e:xr(e,i,o)}var Fu=Lp||function(e){return Ae.clearTimeout(e)};function ju(e,i){if(i)return e.slice();var o=e.length,u=nu?nu(o):new e.constructor(o);return e.copy(u),u}function Ea(e){var i=new e.constructor(e.byteLength);return new Os(i).set(new Os(e)),i}function Jd(e,i){var o=i?Ea(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Yd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function Xd(e){return In?Je(In.call(e)):{}}function Mu(e,i){var o=i?Ea(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function qu(e,i){if(e!==i){var o=e!==t,u=e===null,f=e===e,g=pr(e),b=i!==t,w=i===null,P=i===i,F=pr(i);if(!w&&!F&&!g&&e>i||g&&b&&P&&!w&&!F||u&&b&&P||!o&&P||!f)return 1;if(!u&&!g&&!F&&e<i||F&&o&&f&&!u&&!g||w&&o&&f||!b&&f||!P)return-1}return 0}function Zd(e,i,o){for(var u=-1,f=e.criteria,g=i.criteria,b=f.length,w=o.length;++u<b;){var P=qu(f[u],g[u]);if(P){if(u>=w)return P;var F=o[u];return P*(F=="desc"?-1:1)}}return e.index-i.index}function Uu(e,i,o,u){for(var f=-1,g=e.length,b=o.length,w=-1,P=i.length,F=Mt(g-b,0),j=R(P+F),H=!u;++w<P;)j[w]=i[w];for(;++f<b;)(H||f<g)&&(j[o[f]]=e[f]);for(;F--;)j[w++]=e[f++];return j}function zu(e,i,o,u){for(var f=-1,g=e.length,b=-1,w=o.length,P=-1,F=i.length,j=Mt(g-w,0),H=R(j+F),J=!u;++f<j;)H[f]=e[f];for(var te=f;++P<F;)H[te+P]=i[P];for(;++b<w;)(J||f<g)&&(H[te+o[b]]=e[f++]);return H}function nr(e,i){var o=-1,u=e.length;for(i||(i=R(u));++o<u;)i[o]=e[o];return i}function Br(e,i,o,u){var f=!o;o||(o={});for(var g=-1,b=i.length;++g<b;){var w=i[g],P=u?u(o[w],e[w],w,o,e):t;P===t&&(P=e[w]),f?Xr(o,w,P):Sn(o,w,P)}return o}function Qd(e,i){return Br(e,Ca(e),i)}function eg(e,i){return Br(e,eh(e),i)}function Bs(e,i){return function(o,u){var f=_e(o)?sp:Ed,g=i?i():{};return f(o,e,ne(u,2),g)}}function rn(e){return Ie(function(i,o){var u=-1,f=o.length,g=f>1?o[f-1]:t,b=f>2?o[2]:t;for(g=e.length>3&&typeof g=="function"?(f--,g):t,b&&Zt(o[0],o[1],b)&&(g=f<3?t:g,f=1),i=Je(i);++u<f;){var w=o[u];w&&e(i,w,u,g)}return i})}function Bu(e,i){return function(o,u){if(o==null)return o;if(!sr(o))return e(o,u);for(var f=o.length,g=i?f:-1,b=Je(o);(i?g--:++g<f)&&u(b[g],g,b)!==!1;);return o}}function Hu(e){return function(i,o,u){for(var f=-1,g=Je(i),b=u(i),w=b.length;w--;){var P=b[e?w:++f];if(o(g[P],P,g)===!1)break}return i}}function tg(e,i,o){var u=i&ie,f=Rn(e);function g(){var b=this&&this!==Ae&&this instanceof g?f:e;return b.apply(u?o:this,arguments)}return g}function ku(e){return function(i){i=je(i);var o=Ji(i)?Tr(i):t,u=o?o[0]:i.charAt(0),f=o?yi(o,1).join(""):i.slice(1);return u[e]()+f}}function nn(e){return function(i){return Go(Bh(zh(i).replace(vn,"")),e,"")}}function Rn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=tn(e.prototype),u=e.apply(o,i);return ut(u)?u:o}}function rg(e,i,o){var u=Rn(e);function f(){for(var g=arguments.length,b=R(g),w=g,P=sn(f);w--;)b[w]=arguments[w];var F=g<3&&b[0]!==P&&b[g-1]!==P?[]:li(b,P);if(g-=F.length,g<o)return Ju(e,i,Hs,f.placeholder,t,b,F,t,t,o-g);var j=this&&this!==Ae&&this instanceof f?u:e;return Ut(j,this,b)}return f}function Vu(e){return function(i,o,u){var f=Je(i);if(!sr(i)){var g=ne(o,3);i=zt(i),o=function(w){return g(f[w],w,f)}}var b=e(i,o,u);return b>-1?f[g?i[b]:b]:t}}function Ku(e){return Qr(function(i){var o=i.length,u=o,f=wr.prototype.thru;for(e&&i.reverse();u--;){var g=i[u];if(typeof g!="function")throw new br(l);if(f&&!b&&Gs(g)=="wrapper")var b=new wr([],!0)}for(u=b?u:o;++u<o;){g=i[u];var w=Gs(g),P=w=="wrapper"?Oa(g):t;P&&Ta(P[0])&&P[1]==(z|pe|le|W)&&!P[4].length&&P[9]==1?b=b[Gs(P[0])].apply(b,P[3]):b=g.length==1&&Ta(g)?b[w]():b.thru(g)}return function(){var F=arguments,j=F[0];if(b&&F.length==1&&_e(j))return b.plant(j).value();for(var H=0,J=o?i[H].apply(this,F):j;++H<o;)J=i[H].call(this,J);return J}})}function Hs(e,i,o,u,f,g,b,w,P,F){var j=i&z,H=i&ie,J=i&Ee,te=i&(pe|he),oe=i&ye,we=J?t:Rn(e);function ae(){for(var Se=arguments.length,Ce=R(Se),dr=Se;dr--;)Ce[dr]=arguments[dr];if(te)var Qt=sn(ae),gr=dp(Ce,Qt);if(u&&(Ce=Uu(Ce,u,f,te)),g&&(Ce=zu(Ce,g,b,te)),Se-=gr,te&&Se<F){var xt=li(Ce,Qt);return Ju(e,i,Hs,ae.placeholder,o,Ce,xt,w,P,F-Se)}var Dr=H?o:this,ii=J?Dr[e]:e;return Se=Ce.length,w?Ce=Eg(Ce,w):oe&&Se>1&&Ce.reverse(),j&&P<Se&&(Ce.length=P),this&&this!==Ae&&this instanceof ae&&(ii=we||Rn(ii)),ii.apply(Dr,Ce)}return ae}function Gu(e,i){return function(o,u){return Rd(o,e,i(u),{})}}function ks(e,i){return function(o,u){var f;if(o===t&&u===t)return i;if(o!==t&&(f=o),u!==t){if(f===t)return u;typeof o=="string"||typeof u=="string"?(o=fr(o),u=fr(u)):(o=Nu(o),u=Nu(u)),f=e(o,u)}return f}}function xa(e){return Qr(function(i){return i=st(i,lr(ne())),Ie(function(o){var u=this;return e(i,function(f){return Ut(f,u,o)})})})}function Vs(e,i){i=i===t?" ":fr(i);var o=i.length;if(o<2)return o?ya(i,e):i;var u=ya(i,Ts(e/Yi(i)));return Ji(i)?yi(Tr(u),0,e).join(""):u.slice(0,e)}function ig(e,i,o,u){var f=i&ie,g=Rn(e);function b(){for(var w=-1,P=arguments.length,F=-1,j=u.length,H=R(j+P),J=this&&this!==Ae&&this instanceof b?g:e;++F<j;)H[F]=u[F];for(;P--;)H[F++]=arguments[++w];return Ut(J,f?o:this,H)}return b}function Wu(e){return function(i,o,u){return u&&typeof u!="number"&&Zt(i,o,u)&&(o=u=t),i=ri(i),o===t?(o=i,i=0):o=ri(o),u=u===t?i<o?1:-1:ri(u),Bd(i,o,u,e)}}function Ks(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Sr(i),o=Sr(o)),e(i,o)}}function Ju(e,i,o,u,f,g,b,w,P,F){var j=i&pe,H=j?b:t,J=j?t:b,te=j?g:t,oe=j?t:g;i|=j?le:$,i&=~(j?$:le),i&ge||(i&=~(ie|Ee));var we=[e,i,f,te,H,oe,J,w,P,F],ae=o.apply(t,we);return Ta(e)&&ah(ae,we),ae.placeholder=u,ch(ae,e,i)}function Ia(e){var i=jt[e];return function(o,u){if(o=Sr(o),u=u==null?0:Kt(me(u),292),u&&cu(o)){var f=(je(o)+"e").split("e"),g=i(f[0]+"e"+(+f[1]+u));return f=(je(g)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var ng=Qi&&1/ws(new Qi([,-0]))[1]==ce?function(e){return new Qi(e)}:Ka;function Yu(e){return function(i){var o=Gt(i);return o==be?ea(i):o==Fe?wp(i):pp(i,e(i))}}function Zr(e,i,o,u,f,g,b,w){var P=i&Ee;if(!P&&typeof e!="function")throw new br(l);var F=u?u.length:0;if(F||(i&=~(le|$),u=f=t),b=b===t?b:Mt(me(b),0),w=w===t?w:me(w),F-=f?f.length:0,i&$){var j=u,H=f;u=f=t}var J=P?t:Oa(e),te=[e,i,o,u,f,j,H,g,b,w];if(J&&mg(te,J),e=te[0],i=te[1],o=te[2],u=te[3],f=te[4],w=te[9]=te[9]===t?P?0:e.length:Mt(te[9]-F,0),!w&&i&(pe|he)&&(i&=~(pe|he)),!i||i==ie)var oe=tg(e,i,o);else i==pe||i==he?oe=rg(e,i,w):(i==le||i==(ie|le))&&!f.length?oe=ig(e,i,o,u):oe=Hs.apply(t,te);var we=J?Ru:ah;return ch(we(oe,te),e,i)}function Xu(e,i,o,u){return e===t||$r(e,Zi[o])&&!qe.call(u,o)?i:e}function Zu(e,i,o,u,f,g){return ut(e)&&ut(i)&&(g.set(i,e),qs(e,i,t,Zu,g),g.delete(i)),e}function sg(e){return $n(e)?t:e}function Qu(e,i,o,u,f,g){var b=o&L,w=e.length,P=i.length;if(w!=P&&!(b&&P>w))return!1;var F=g.get(e),j=g.get(i);if(F&&j)return F==i&&j==e;var H=-1,J=!0,te=o&K?new Ti:t;for(g.set(e,i),g.set(i,e);++H<w;){var oe=e[H],we=i[H];if(u)var ae=b?u(we,oe,H,i,e,g):u(oe,we,H,e,i,g);if(ae!==t){if(ae)continue;J=!1;break}if(te){if(!Wo(i,function(Se,Ce){if(!mn(te,Ce)&&(oe===Se||f(oe,Se,o,u,g)))return te.push(Ce)})){J=!1;break}}else if(!(oe===we||f(oe,we,o,u,g))){J=!1;break}}return g.delete(e),g.delete(i),J}function og(e,i,o,u,f,g,b){switch(o){case Ve:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!g(new Os(e),new Os(i)));case T:case A:case Ne:return $r(+e,+i);case E:return e.name==i.name&&e.message==i.message;case ot:case Ze:return e==i+"";case be:var w=ea;case Fe:var P=u&L;if(w||(w=ws),e.size!=i.size&&!P)return!1;var F=b.get(e);if(F)return F==i;u|=K,b.set(e,i);var j=Qu(w(e),w(i),u,f,g,b);return b.delete(e),j;case Qe:if(In)return In.call(e)==In.call(i)}return!1}function ag(e,i,o,u,f,g){var b=o&L,w=Sa(e),P=w.length,F=Sa(i),j=F.length;if(P!=j&&!b)return!1;for(var H=P;H--;){var J=w[H];if(!(b?J in i:qe.call(i,J)))return!1}var te=g.get(e),oe=g.get(i);if(te&&oe)return te==i&&oe==e;var we=!0;g.set(e,i),g.set(i,e);for(var ae=b;++H<P;){J=w[H];var Se=e[J],Ce=i[J];if(u)var dr=b?u(Ce,Se,J,i,e,g):u(Se,Ce,J,e,i,g);if(!(dr===t?Se===Ce||f(Se,Ce,o,u,g):dr)){we=!1;break}ae||(ae=J=="constructor")}if(we&&!ae){var Qt=e.constructor,gr=i.constructor;Qt!=gr&&"constructor"in e&&"constructor"in i&&!(typeof Qt=="function"&&Qt instanceof Qt&&typeof gr=="function"&&gr instanceof gr)&&(we=!1)}return g.delete(e),g.delete(i),we}function Qr(e){return $a(sh(e,t,dh),e+"")}function Sa(e){return mu(e,zt,Ca)}function Pa(e){return mu(e,or,eh)}var Oa=$s?function(e){return $s.get(e)}:Ka;function Gs(e){for(var i=e.name+"",o=en[i],u=qe.call(en,i)?o.length:0;u--;){var f=o[u],g=f.func;if(g==null||g==e)return f.name}return i}function sn(e){var i=qe.call(d,"placeholder")?d:e;return i.placeholder}function ne(){var e=d.iteratee||ka;return e=e===ka?Eu:e,arguments.length?e(arguments[0],arguments[1]):e}function Ws(e,i){var o=e.__data__;return gg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Aa(e){for(var i=zt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,ih(f)]}return i}function Di(e,i){var o=_p(e,i);return wu(o)?o:t}function cg(e){var i=qe.call(e,Ci),o=e[Ci];try{e[Ci]=t;var u=!0}catch{}var f=Ss.call(e);return u&&(i?e[Ci]=o:delete e[Ci]),f}var Ca=ra?function(e){return e==null?[]:(e=Je(e),ui(ra(e),function(i){return ou.call(e,i)}))}:Ga,eh=ra?function(e){for(var i=[];e;)hi(i,Ca(e)),e=As(e);return i}:Ga,Gt=Xt;(ia&&Gt(new ia(new ArrayBuffer(1)))!=Ve||wn&&Gt(new wn)!=be||na&&Gt(na.resolve())!=Pt||Qi&&Gt(new Qi)!=Fe||En&&Gt(new En)!=ze)&&(Gt=function(e){var i=Xt(e),o=i==Pe?e.constructor:t,u=o?Li(o):"";if(u)switch(u){case kp:return Ve;case Vp:return be;case Kp:return Pt;case Gp:return Fe;case Wp:return ze}return i});function ug(e,i,o){for(var u=-1,f=o.length;++u<f;){var g=o[u],b=g.size;switch(g.type){case"drop":e+=b;break;case"dropRight":i-=b;break;case"take":i=Kt(i,e+b);break;case"takeRight":e=Mt(e,i-b);break}}return{start:e,end:i}}function hg(e){var i=e.match(Xe);return i?i[1].split(Tt):[]}function th(e,i,o){i=gi(i,e);for(var u=-1,f=i.length,g=!1;++u<f;){var b=Hr(i[u]);if(!(g=e!=null&&o(e,b)))break;e=e[b]}return g||++u!=f?g:(f=e==null?0:e.length,!!f&&to(f)&&ei(b,f)&&(_e(e)||Fi(e)))}function lg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function rh(e){return typeof e.constructor=="function"&&!Tn(e)?tn(As(e)):{}}function fg(e,i,o){var u=e.constructor;switch(i){case $e:return Ea(e);case T:case A:return new u(+e);case Ve:return Jd(e,o);case ht:case Me:case Ot:case Ft:case Bt:case Ht:case qt:case Wt:case rr:return Mu(e,o);case be:return new u;case Ne:case Ze:return new u(e);case ot:return Yd(e);case Fe:return new u;case Qe:return Xd(e)}}function pg(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function dg(e){return _e(e)||Fi(e)||!!(au&&e&&e[au])}function ei(e,i){var o=typeof e;return i=i??V,!!i&&(o=="number"||o!="symbol"&&No.test(e))&&e>-1&&e%1==0&&e<i}function Zt(e,i,o){if(!ut(o))return!1;var u=typeof i;return(u=="number"?sr(o)&&ei(i,o.length):u=="string"&&i in o)?$r(o[i],e):!1}function Ra(e,i){if(_e(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||pr(e)?!0:At.test(e)||!nt.test(e)||i!=null&&e in Je(i)}function gg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ta(e){var i=Gs(e),o=d[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var u=Oa(o);return!!u&&e===u[0]}function yg(e){return!!iu&&iu in e}var vg=xs?ti:Wa;function Tn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||Zi;return e===o}function ih(e){return e===e&&!ut(e)}function nh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==t||e in Je(o))}}function _g(e){var i=Qs(e,function(u){return o.size===y&&o.clear(),u}),o=i.cache;return i}function mg(e,i){var o=e[1],u=i[1],f=o|u,g=f<(ie|Ee|z),b=u==z&&o==pe||u==z&&o==W&&e[7].length<=i[8]||u==(z|W)&&i[7].length<=i[8]&&o==pe;if(!(g||b))return e;u&ie&&(e[2]=i[2],f|=o&ie?0:ge);var w=i[3];if(w){var P=e[3];e[3]=P?Uu(P,w,i[4]):w,e[4]=P?li(e[3],O):i[4]}return w=i[5],w&&(P=e[5],e[5]=P?zu(P,w,i[6]):w,e[6]=P?li(e[5],O):i[6]),w=i[7],w&&(e[7]=w),u&z&&(e[8]=e[8]==null?i[8]:Kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function bg(e){var i=[];if(e!=null)for(var o in Je(e))i.push(o);return i}function wg(e){return Ss.call(e)}function sh(e,i,o){return i=Mt(i===t?e.length-1:i,0),function(){for(var u=arguments,f=-1,g=Mt(u.length-i,0),b=R(g);++f<g;)b[f]=u[i+f];f=-1;for(var w=R(i+1);++f<i;)w[f]=u[f];return w[i]=o(b),Ut(e,this,w)}}function oh(e,i){return i.length<2?e:$i(e,xr(i,0,-1))}function Eg(e,i){for(var o=e.length,u=Kt(i.length,o),f=nr(e);u--;){var g=i[u];e[u]=ei(g,o)?f[g]:t}return e}function Na(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var ah=uh(Ru),Nn=jp||function(e,i){return Ae.setTimeout(e,i)},$a=uh(Vd);function ch(e,i,o){var u=i+"";return $a(e,pg(u,xg(hg(u),o)))}function uh(e){var i=0,o=0;return function(){var u=zp(),f=Ue-(u-o);if(o=u,f>0){if(++i>=Te)return arguments[0]}else i=0;return e.apply(t,arguments)}}function Js(e,i){var o=-1,u=e.length,f=u-1;for(i=i===t?u:i;++o<i;){var g=ga(o,f),b=e[g];e[g]=e[o],e[o]=b}return e.length=i,e}var hh=_g(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ct,function(o,u,f,g){i.push(f?g.replace(Po,"$1"):u||o)}),i});function Hr(e){if(typeof e=="string"||pr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Li(e){if(e!=null){try{return Is.call(e)}catch{}try{return e+""}catch{}}return""}function xg(e,i){return mr(jr,function(o){var u="_."+o[0];i&o[1]&&!ms(e,u)&&e.push(u)}),e.sort()}function lh(e){if(e instanceof Oe)return e.clone();var i=new wr(e.__wrapped__,e.__chain__);return i.__actions__=nr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Ig(e,i,o){(o?Zt(e,i,o):i===t)?i=1:i=Mt(me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,g=0,b=R(Ts(u/i));f<u;)b[g++]=xr(e,f,f+=i);return b}function Sg(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var g=e[i];g&&(f[u++]=g)}return f}function Pg(){var e=arguments.length;if(!e)return[];for(var i=R(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return hi(_e(o)?nr(o):[o],kt(i,1))}var Og=Ie(function(e,i){return Et(e)?Pn(e,kt(i,1,Et,!0)):[]}),Ag=Ie(function(e,i){var o=Ir(i);return Et(o)&&(o=t),Et(e)?Pn(e,kt(i,1,Et,!0),ne(o,2)):[]}),Cg=Ie(function(e,i){var o=Ir(i);return Et(o)&&(o=t),Et(e)?Pn(e,kt(i,1,Et,!0),t,o):[]});function Rg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),xr(e,i<0?0:i,u)):[]}function Tg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,xr(e,0,i<0?0:i)):[]}function Ng(e,i){return e&&e.length?zs(e,ne(i,3),!0,!0):[]}function $g(e,i){return e&&e.length?zs(e,ne(i,3),!0):[]}function Dg(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&Zt(e,i,o)&&(o=0,u=f),Pd(e,i,o,u)):[]}function fh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=Mt(u+f,0)),bs(e,ne(i,3),f)}function ph(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==t&&(f=me(o),f=o<0?Mt(u+f,0):Kt(f,u-1)),bs(e,ne(i,3),f,!0)}function dh(e){var i=e==null?0:e.length;return i?kt(e,1):[]}function Lg(e){var i=e==null?0:e.length;return i?kt(e,ce):[]}function Fg(e,i){var o=e==null?0:e.length;return o?(i=i===t?1:me(i),kt(e,i)):[]}function jg(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function gh(e){return e&&e.length?e[0]:t}function Mg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=Mt(u+f,0)),Wi(e,i,f)}function qg(e){var i=e==null?0:e.length;return i?xr(e,0,-1):[]}var Ug=Ie(function(e){var i=st(e,ba);return i.length&&i[0]===e[0]?ha(i):[]}),zg=Ie(function(e){var i=Ir(e),o=st(e,ba);return i===Ir(o)?i=t:o.pop(),o.length&&o[0]===e[0]?ha(o,ne(i,2)):[]}),Bg=Ie(function(e){var i=Ir(e),o=st(e,ba);return i=typeof i=="function"?i:t,i&&o.pop(),o.length&&o[0]===e[0]?ha(o,t,i):[]});function Hg(e,i){return e==null?"":qp.call(e,i)}function Ir(e){var i=e==null?0:e.length;return i?e[i-1]:t}function kg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==t&&(f=me(o),f=f<0?Mt(u+f,0):Kt(f,u-1)),i===i?xp(e,i,f):bs(e,Jc,f,!0)}function Vg(e,i){return e&&e.length?Pu(e,me(i)):t}var Kg=Ie(yh);function yh(e,i){return e&&e.length&&i&&i.length?da(e,i):e}function Gg(e,i,o){return e&&e.length&&i&&i.length?da(e,i,ne(o,2)):e}function Wg(e,i,o){return e&&e.length&&i&&i.length?da(e,i,t,o):e}var Jg=Qr(function(e,i){var o=e==null?0:e.length,u=oa(e,i);return Cu(e,st(i,function(f){return ei(f,o)?+f:f}).sort(qu)),u});function Yg(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],g=e.length;for(i=ne(i,3);++u<g;){var b=e[u];i(b,u,e)&&(o.push(b),f.push(u))}return Cu(e,f),o}function Da(e){return e==null?e:Hp.call(e)}function Xg(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Zt(e,i,o)?(i=0,o=u):(i=i==null?0:me(i),o=o===t?u:me(o)),xr(e,i,o)):[]}function Zg(e,i){return Us(e,i)}function Qg(e,i,o){return va(e,i,ne(o,2))}function ey(e,i){var o=e==null?0:e.length;if(o){var u=Us(e,i);if(u<o&&$r(e[u],i))return u}return-1}function ty(e,i){return Us(e,i,!0)}function ry(e,i,o){return va(e,i,ne(o,2),!0)}function iy(e,i){var o=e==null?0:e.length;if(o){var u=Us(e,i,!0)-1;if($r(e[u],i))return u}return-1}function ny(e){return e&&e.length?Tu(e):[]}function sy(e,i){return e&&e.length?Tu(e,ne(i,2)):[]}function oy(e){var i=e==null?0:e.length;return i?xr(e,1,i):[]}function ay(e,i,o){return e&&e.length?(i=o||i===t?1:me(i),xr(e,0,i<0?0:i)):[]}function cy(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,xr(e,i<0?0:i,u)):[]}function uy(e,i){return e&&e.length?zs(e,ne(i,3),!1,!0):[]}function hy(e,i){return e&&e.length?zs(e,ne(i,3)):[]}var ly=Ie(function(e){return di(kt(e,1,Et,!0))}),fy=Ie(function(e){var i=Ir(e);return Et(i)&&(i=t),di(kt(e,1,Et,!0),ne(i,2))}),py=Ie(function(e){var i=Ir(e);return i=typeof i=="function"?i:t,di(kt(e,1,Et,!0),t,i)});function dy(e){return e&&e.length?di(e):[]}function gy(e,i){return e&&e.length?di(e,ne(i,2)):[]}function yy(e,i){return i=typeof i=="function"?i:t,e&&e.length?di(e,t,i):[]}function La(e){if(!(e&&e.length))return[];var i=0;return e=ui(e,function(o){if(Et(o))return i=Mt(o.length,i),!0}),Zo(i,function(o){return st(e,Jo(o))})}function vh(e,i){if(!(e&&e.length))return[];var o=La(e);return i==null?o:st(o,function(u){return Ut(i,t,u)})}var vy=Ie(function(e,i){return Et(e)?Pn(e,i):[]}),_y=Ie(function(e){return ma(ui(e,Et))}),my=Ie(function(e){var i=Ir(e);return Et(i)&&(i=t),ma(ui(e,Et),ne(i,2))}),by=Ie(function(e){var i=Ir(e);return i=typeof i=="function"?i:t,ma(ui(e,Et),t,i)}),wy=Ie(La);function Ey(e,i){return Lu(e||[],i||[],Sn)}function xy(e,i){return Lu(e||[],i||[],Cn)}var Iy=Ie(function(e){var i=e.length,o=i>1?e[i-1]:t;return o=typeof o=="function"?(e.pop(),o):t,vh(e,o)});function _h(e){var i=d(e);return i.__chain__=!0,i}function Sy(e,i){return i(e),e}function Ys(e,i){return i(e)}var Py=Qr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(g){return oa(g,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!ei(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:Ys,args:[f],thisArg:t}),new wr(u,this.__chain__).thru(function(g){return i&&!g.length&&g.push(t),g}))});function Oy(){return _h(this)}function Ay(){return new wr(this.value(),this.__chain__)}function Cy(){this.__values__===t&&(this.__values__=Nh(this.value()));var e=this.__index__>=this.__values__.length,i=e?t:this.__values__[this.__index__++];return{done:e,value:i}}function Ry(){return this}function Ty(e){for(var i,o=this;o instanceof Ls;){var u=lh(o);u.__index__=0,u.__values__=t,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function Ny(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:Ys,args:[Da],thisArg:t}),new wr(i,this.__chain__)}return this.thru(Da)}function $y(){return Du(this.__wrapped__,this.__actions__)}var Dy=Bs(function(e,i,o){qe.call(e,o)?++e[o]:Xr(e,o,1)});function Ly(e,i,o){var u=_e(e)?Gc:Sd;return o&&Zt(e,i,o)&&(i=t),u(e,ne(i,3))}function Fy(e,i){var o=_e(e)?ui:vu;return o(e,ne(i,3))}var jy=Vu(fh),My=Vu(ph);function qy(e,i){return kt(Xs(e,i),1)}function Uy(e,i){return kt(Xs(e,i),ce)}function zy(e,i,o){return o=o===t?1:me(o),kt(Xs(e,i),o)}function mh(e,i){var o=_e(e)?mr:pi;return o(e,ne(i,3))}function bh(e,i){var o=_e(e)?op:yu;return o(e,ne(i,3))}var By=Bs(function(e,i,o){qe.call(e,o)?e[o].push(i):Xr(e,o,[i])});function Hy(e,i,o,u){e=sr(e)?e:an(e),o=o&&!u?me(o):0;var f=e.length;return o<0&&(o=Mt(f+o,0)),ro(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&Wi(e,i,o)>-1}var ky=Ie(function(e,i,o){var u=-1,f=typeof i=="function",g=sr(e)?R(e.length):[];return pi(e,function(b){g[++u]=f?Ut(i,b,o):On(b,i,o)}),g}),Vy=Bs(function(e,i,o){Xr(e,o,i)});function Xs(e,i){var o=_e(e)?st:xu;return o(e,ne(i,3))}function Ky(e,i,o,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),o=u?t:o,_e(o)||(o=o==null?[]:[o]),Ou(e,i,o))}var Gy=Bs(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function Wy(e,i,o){var u=_e(e)?Go:Xc,f=arguments.length<3;return u(e,ne(i,4),o,f,pi)}function Jy(e,i,o){var u=_e(e)?ap:Xc,f=arguments.length<3;return u(e,ne(i,4),o,f,yu)}function Yy(e,i){var o=_e(e)?ui:vu;return o(e,eo(ne(i,3)))}function Xy(e){var i=_e(e)?fu:Hd;return i(e)}function Zy(e,i,o){(o?Zt(e,i,o):i===t)?i=1:i=me(i);var u=_e(e)?bd:kd;return u(e,i)}function Qy(e){var i=_e(e)?wd:Kd;return i(e)}function ev(e){if(e==null)return 0;if(sr(e))return ro(e)?Yi(e):e.length;var i=Gt(e);return i==be||i==Fe?e.size:fa(e).length}function tv(e,i,o){var u=_e(e)?Wo:Gd;return o&&Zt(e,i,o)&&(i=t),u(e,ne(i,3))}var rv=Ie(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Zt(e,i[0],i[1])?i=[]:o>2&&Zt(i[0],i[1],i[2])&&(i=[i[0]]),Ou(e,kt(i,1),[])}),Zs=Fp||function(){return Ae.Date.now()};function iv(e,i){if(typeof i!="function")throw new br(l);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function wh(e,i,o){return i=o?t:i,i=e&&i==null?e.length:i,Zr(e,z,t,t,t,t,i)}function Eh(e,i){var o;if(typeof i!="function")throw new br(l);return e=me(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=t),o}}var Fa=Ie(function(e,i,o){var u=ie;if(o.length){var f=li(o,sn(Fa));u|=le}return Zr(e,u,i,o,f)}),xh=Ie(function(e,i,o){var u=ie|Ee;if(o.length){var f=li(o,sn(xh));u|=le}return Zr(i,u,e,o,f)});function Ih(e,i,o){i=o?t:i;var u=Zr(e,pe,t,t,t,t,t,i);return u.placeholder=Ih.placeholder,u}function Sh(e,i,o){i=o?t:i;var u=Zr(e,he,t,t,t,t,t,i);return u.placeholder=Sh.placeholder,u}function Ph(e,i,o){var u,f,g,b,w,P,F=0,j=!1,H=!1,J=!0;if(typeof e!="function")throw new br(l);i=Sr(i)||0,ut(o)&&(j=!!o.leading,H="maxWait"in o,g=H?Mt(Sr(o.maxWait)||0,i):g,J="trailing"in o?!!o.trailing:J);function te(xt){var Dr=u,ii=f;return u=f=t,F=xt,b=e.apply(ii,Dr),b}function oe(xt){return F=xt,w=Nn(Se,i),j?te(xt):b}function we(xt){var Dr=xt-P,ii=xt-F,Vh=i-Dr;return H?Kt(Vh,g-ii):Vh}function ae(xt){var Dr=xt-P,ii=xt-F;return P===t||Dr>=i||Dr<0||H&&ii>=g}function Se(){var xt=Zs();if(ae(xt))return Ce(xt);w=Nn(Se,we(xt))}function Ce(xt){return w=t,J&&u?te(xt):(u=f=t,b)}function dr(){w!==t&&Fu(w),F=0,u=P=f=w=t}function Qt(){return w===t?b:Ce(Zs())}function gr(){var xt=Zs(),Dr=ae(xt);if(u=arguments,f=this,P=xt,Dr){if(w===t)return oe(P);if(H)return Fu(w),w=Nn(Se,i),te(P)}return w===t&&(w=Nn(Se,i)),b}return gr.cancel=dr,gr.flush=Qt,gr}var nv=Ie(function(e,i){return gu(e,1,i)}),sv=Ie(function(e,i,o){return gu(e,Sr(i)||0,o)});function ov(e){return Zr(e,ye)}function Qs(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new br(l);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],g=o.cache;if(g.has(f))return g.get(f);var b=e.apply(this,u);return o.cache=g.set(f,b)||g,b};return o.cache=new(Qs.Cache||Yr),o}Qs.Cache=Yr;function eo(e){if(typeof e!="function")throw new br(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function av(e){return Eh(2,e)}var cv=Wd(function(e,i){i=i.length==1&&_e(i[0])?st(i[0],lr(ne())):st(kt(i,1),lr(ne()));var o=i.length;return Ie(function(u){for(var f=-1,g=Kt(u.length,o);++f<g;)u[f]=i[f].call(this,u[f]);return Ut(e,this,u)})}),ja=Ie(function(e,i){var o=li(i,sn(ja));return Zr(e,le,t,i,o)}),Oh=Ie(function(e,i){var o=li(i,sn(Oh));return Zr(e,$,t,i,o)}),uv=Qr(function(e,i){return Zr(e,W,t,t,t,i)});function hv(e,i){if(typeof e!="function")throw new br(l);return i=i===t?i:me(i),Ie(e,i)}function lv(e,i){if(typeof e!="function")throw new br(l);return i=i==null?0:Mt(me(i),0),Ie(function(o){var u=o[i],f=yi(o,0,i);return u&&hi(f,u),Ut(e,this,f)})}function fv(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new br(l);return ut(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),Ph(e,i,{leading:u,maxWait:i,trailing:f})}function pv(e){return wh(e,1)}function dv(e,i){return ja(wa(i),e)}function gv(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function yv(e){return Er(e,U)}function vv(e,i){return i=typeof i=="function"?i:t,Er(e,U,i)}function _v(e){return Er(e,q|U)}function mv(e,i){return i=typeof i=="function"?i:t,Er(e,q|U,i)}function bv(e,i){return i==null||du(e,i,zt(i))}function $r(e,i){return e===i||e!==e&&i!==i}var wv=Ks(ua),Ev=Ks(function(e,i){return e>=i}),Fi=bu(function(){return arguments}())?bu:function(e){return vt(e)&&qe.call(e,"callee")&&!ou.call(e,"callee")},_e=R.isArray,xv=Yt?lr(Yt):Td;function sr(e){return e!=null&&to(e.length)&&!ti(e)}function Et(e){return vt(e)&&sr(e)}function Iv(e){return e===!0||e===!1||vt(e)&&Xt(e)==T}var vi=Mp||Wa,Sv=Rr?lr(Rr):Nd;function Pv(e){return vt(e)&&e.nodeType===1&&!$n(e)}function Ov(e){if(e==null)return!0;if(sr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||vi(e)||on(e)||Fi(e)))return!e.length;var i=Gt(e);if(i==be||i==Fe)return!e.size;if(Tn(e))return!fa(e).length;for(var o in e)if(qe.call(e,o))return!1;return!0}function Av(e,i){return An(e,i)}function Cv(e,i,o){o=typeof o=="function"?o:t;var u=o?o(e,i):t;return u===t?An(e,i,t,o):!!u}function Ma(e){if(!vt(e))return!1;var i=Xt(e);return i==E||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!$n(e)}function Rv(e){return typeof e=="number"&&cu(e)}function ti(e){if(!ut(e))return!1;var i=Xt(e);return i==ee||i==fe||i==N||i==mt}function Ah(e){return typeof e=="number"&&e==me(e)}function to(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var Ch=_r?lr(_r):Dd;function Tv(e,i){return e===i||la(e,i,Aa(i))}function Nv(e,i,o){return o=typeof o=="function"?o:t,la(e,i,Aa(i),o)}function $v(e){return Rh(e)&&e!=+e}function Dv(e){if(vg(e))throw new de(c);return wu(e)}function Lv(e){return e===null}function Fv(e){return e==null}function Rh(e){return typeof e=="number"||vt(e)&&Xt(e)==Ne}function $n(e){if(!vt(e)||Xt(e)!=Pe)return!1;var i=As(e);if(i===null)return!0;var o=qe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Is.call(o)==Np}var qa=Ur?lr(Ur):Ld;function jv(e){return Ah(e)&&e>=-V&&e<=V}var Th=_n?lr(_n):Fd;function ro(e){return typeof e=="string"||!_e(e)&&vt(e)&&Xt(e)==Ze}function pr(e){return typeof e=="symbol"||vt(e)&&Xt(e)==Qe}var on=Ai?lr(Ai):jd;function Mv(e){return e===t}function qv(e){return vt(e)&&Gt(e)==ze}function Uv(e){return vt(e)&&Xt(e)==et}var zv=Ks(pa),Bv=Ks(function(e,i){return e<=i});function Nh(e){if(!e)return[];if(sr(e))return ro(e)?Tr(e):nr(e);if(bn&&e[bn])return bp(e[bn]());var i=Gt(e),o=i==be?ea:i==Fe?ws:an;return o(e)}function ri(e){if(!e)return e===0?e:0;if(e=Sr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*B}return e===e?e:0}function me(e){var i=ri(e),o=i%1;return i===i?o?i-o:i:0}function $h(e){return e?Ni(me(e),0,G):0}function Sr(e){if(typeof e=="number")return e;if(pr(e))return k;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Zc(e);var o=Co.test(e);return o||To.test(e)?ve(e.slice(2),o?2:8):Ao.test(e)?k:+e}function Dh(e){return Br(e,or(e))}function Hv(e){return e?Ni(me(e),-V,V):e===0?e:0}function je(e){return e==null?"":fr(e)}var kv=rn(function(e,i){if(Tn(i)||sr(i)){Br(i,zt(i),e);return}for(var o in i)qe.call(i,o)&&Sn(e,o,i[o])}),Lh=rn(function(e,i){Br(i,or(i),e)}),io=rn(function(e,i,o,u){Br(i,or(i),e,u)}),Vv=rn(function(e,i,o,u){Br(i,zt(i),e,u)}),Kv=Qr(oa);function Gv(e,i){var o=tn(e);return i==null?o:pu(o,i)}var Wv=Ie(function(e,i){e=Je(e);var o=-1,u=i.length,f=u>2?i[2]:t;for(f&&Zt(i[0],i[1],f)&&(u=1);++o<u;)for(var g=i[o],b=or(g),w=-1,P=b.length;++w<P;){var F=b[w],j=e[F];(j===t||$r(j,Zi[F])&&!qe.call(e,F))&&(e[F]=g[F])}return e}),Jv=Ie(function(e){return e.push(t,Zu),Ut(Fh,t,e)});function Yv(e,i){return Wc(e,ne(i,3),zr)}function Xv(e,i){return Wc(e,ne(i,3),ca)}function Zv(e,i){return e==null?e:aa(e,ne(i,3),or)}function Qv(e,i){return e==null?e:_u(e,ne(i,3),or)}function e0(e,i){return e&&zr(e,ne(i,3))}function t0(e,i){return e&&ca(e,ne(i,3))}function r0(e){return e==null?[]:Ms(e,zt(e))}function i0(e){return e==null?[]:Ms(e,or(e))}function Ua(e,i,o){var u=e==null?t:$i(e,i);return u===t?o:u}function n0(e,i){return e!=null&&th(e,i,Od)}function za(e,i){return e!=null&&th(e,i,Ad)}var s0=Gu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ss.call(i)),e[i]=o},Ha(ar)),o0=Gu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ss.call(i)),qe.call(e,i)?e[i].push(o):e[i]=[o]},ne),a0=Ie(On);function zt(e){return sr(e)?lu(e):fa(e)}function or(e){return sr(e)?lu(e,!0):Md(e)}function c0(e,i){var o={};return i=ne(i,3),zr(e,function(u,f,g){Xr(o,i(u,f,g),u)}),o}function u0(e,i){var o={};return i=ne(i,3),zr(e,function(u,f,g){Xr(o,f,i(u,f,g))}),o}var h0=rn(function(e,i,o){qs(e,i,o)}),Fh=rn(function(e,i,o,u){qs(e,i,o,u)}),l0=Qr(function(e,i){var o={};if(e==null)return o;var u=!1;i=st(i,function(g){return g=gi(g,e),u||(u=g.length>1),g}),Br(e,Pa(e),o),u&&(o=Er(o,q|C|U,sg));for(var f=i.length;f--;)_a(o,i[f]);return o});function f0(e,i){return jh(e,eo(ne(i)))}var p0=Qr(function(e,i){return e==null?{}:Ud(e,i)});function jh(e,i){if(e==null)return{};var o=st(Pa(e),function(u){return[u]});return i=ne(i),Au(e,o,function(u,f){return i(u,f[0])})}function d0(e,i,o){i=gi(i,e);var u=-1,f=i.length;for(f||(f=1,e=t);++u<f;){var g=e==null?t:e[Hr(i[u])];g===t&&(u=f,g=o),e=ti(g)?g.call(e):g}return e}function g0(e,i,o){return e==null?e:Cn(e,i,o)}function y0(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:Cn(e,i,o,u)}var Mh=Yu(zt),qh=Yu(or);function v0(e,i,o){var u=_e(e),f=u||vi(e)||on(e);if(i=ne(i,4),o==null){var g=e&&e.constructor;f?o=u?new g:[]:ut(e)?o=ti(g)?tn(As(e)):{}:o={}}return(f?mr:zr)(e,function(b,w,P){return i(o,b,w,P)}),o}function _0(e,i){return e==null?!0:_a(e,i)}function m0(e,i,o){return e==null?e:$u(e,i,wa(o))}function b0(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:$u(e,i,wa(o),u)}function an(e){return e==null?[]:Qo(e,zt(e))}function w0(e){return e==null?[]:Qo(e,or(e))}function E0(e,i,o){return o===t&&(o=i,i=t),o!==t&&(o=Sr(o),o=o===o?o:0),i!==t&&(i=Sr(i),i=i===i?i:0),Ni(Sr(e),i,o)}function x0(e,i,o){return i=ri(i),o===t?(o=i,i=0):o=ri(o),e=Sr(e),Cd(e,i,o)}function I0(e,i,o){if(o&&typeof o!="boolean"&&Zt(e,i,o)&&(i=o=t),o===t&&(typeof i=="boolean"?(o=i,i=t):typeof e=="boolean"&&(o=e,e=t)),e===t&&i===t?(e=0,i=1):(e=ri(e),i===t?(i=e,e=0):i=ri(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=uu();return Kt(e+f*(i-e+Ge("1e-"+((f+"").length-1))),i)}return ga(e,i)}var S0=nn(function(e,i,o){return i=i.toLowerCase(),e+(o?Uh(i):i)});function Uh(e){return Ba(je(e).toLowerCase())}function zh(e){return e=je(e),e&&e.replace(Gr,gp).replace(ko,"")}function P0(e,i,o){e=je(e),i=fr(i);var u=e.length;o=o===t?u:Ni(me(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function O0(e){return e=je(e),e&&it.test(e)?e.replace(xi,yp):e}function A0(e){return e=je(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var C0=nn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),R0=nn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),T0=ku("toLowerCase");function N0(e,i,o){e=je(e),i=me(i);var u=i?Yi(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Vs(Ns(f),o)+e+Vs(Ts(f),o)}function $0(e,i,o){e=je(e),i=me(i);var u=i?Yi(e):0;return i&&u<i?e+Vs(i-u,o):e}function D0(e,i,o){e=je(e),i=me(i);var u=i?Yi(e):0;return i&&u<i?Vs(i-u,o)+e:e}function L0(e,i,o){return o||i==null?i=0:i&&(i=+i),Bp(je(e).replace(gt,""),i||0)}function F0(e,i,o){return(o?Zt(e,i,o):i===t)?i=1:i=me(i),ya(je(e),i)}function j0(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var M0=nn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function q0(e,i,o){return o&&typeof o!="number"&&Zt(e,i,o)&&(i=o=t),o=o===t?G:o>>>0,o?(e=je(e),e&&(typeof i=="string"||i!=null&&!qa(i))&&(i=fr(i),!i&&Ji(e))?yi(Tr(e),0,o):e.split(i,o)):[]}var U0=nn(function(e,i,o){return e+(o?" ":"")+Ba(i)});function z0(e,i,o){return e=je(e),o=o==null?0:Ni(me(o),0,e.length),i=fr(i),e.slice(o,o+i.length)==i}function B0(e,i,o){var u=d.templateSettings;o&&Zt(e,i,o)&&(i=t),e=je(e),i=io({},i,u,Xu);var f=io({},i.imports,u.imports,Xu),g=zt(f),b=Qo(f,g),w,P,F=0,j=i.interpolate||zi,H="__p += '",J=ta((i.escape||zi).source+"|"+j.source+"|"+(j===ct?Oo:zi).source+"|"+(i.evaluate||zi).source+"|$","g"),te="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vo+"]")+`
`;e.replace(J,function(ae,Se,Ce,dr,Qt,gr){return Ce||(Ce=dr),H+=e.slice(F,gr).replace($o,vp),Se&&(w=!0,H+=`' +
__e(`+Se+`) +
'`),Qt&&(P=!0,H+=`';
`+Qt+`;
__p += '`),Ce&&(H+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),F=gr+ae.length,ae}),H+=`';
`;var oe=qe.call(i,"variable")&&i.variable;if(!oe)H=`with (obj) {
`+H+`
}
`;else if(So.test(oe))throw new de(p);H=(P?H.replace(Mr,""):H).replace(Jt,"$1").replace(Kr,"$1;"),H="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var we=Hh(function(){return Le(g,te+"return "+H).apply(t,b)});if(we.source=H,Ma(we))throw we;return we}function H0(e){return je(e).toLowerCase()}function k0(e){return je(e).toUpperCase()}function V0(e,i,o){if(e=je(e),e&&(o||i===t))return Zc(e);if(!e||!(i=fr(i)))return e;var u=Tr(e),f=Tr(i),g=Qc(u,f),b=eu(u,f)+1;return yi(u,g,b).join("")}function K0(e,i,o){if(e=je(e),e&&(o||i===t))return e.slice(0,ru(e)+1);if(!e||!(i=fr(i)))return e;var u=Tr(e),f=eu(u,Tr(i))+1;return yi(u,0,f).join("")}function G0(e,i,o){if(e=je(e),e&&(o||i===t))return e.replace(gt,"");if(!e||!(i=fr(i)))return e;var u=Tr(e),f=Qc(u,Tr(i));return yi(u,f).join("")}function W0(e,i){var o=re,u=ue;if(ut(i)){var f="separator"in i?i.separator:f;o="length"in i?me(i.length):o,u="omission"in i?fr(i.omission):u}e=je(e);var g=e.length;if(Ji(e)){var b=Tr(e);g=b.length}if(o>=g)return e;var w=o-Yi(u);if(w<1)return u;var P=b?yi(b,0,w).join(""):e.slice(0,w);if(f===t)return P+u;if(b&&(w+=P.length-w),qa(f)){if(e.slice(w).search(f)){var F,j=P;for(f.global||(f=ta(f.source,je(vr.exec(f))+"g")),f.lastIndex=0;F=f.exec(j);)var H=F.index;P=P.slice(0,H===t?w:H)}}else if(e.indexOf(fr(f),w)!=w){var J=P.lastIndexOf(f);J>-1&&(P=P.slice(0,J))}return P+u}function J0(e){return e=je(e),e&&lt.test(e)?e.replace(ai,Ip):e}var Y0=nn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),Ba=ku("toUpperCase");function Bh(e,i,o){return e=je(e),i=o?t:i,i===t?mp(e)?Op(e):hp(e):e.match(i)||[]}var Hh=Ie(function(e,i){try{return Ut(e,t,i)}catch(o){return Ma(o)?o:new de(o)}}),X0=Qr(function(e,i){return mr(i,function(o){o=Hr(o),Xr(e,o,Fa(e[o],e))}),e});function Z0(e){var i=e==null?0:e.length,o=ne();return e=i?st(e,function(u){if(typeof u[1]!="function")throw new br(l);return[o(u[0]),u[1]]}):[],Ie(function(u){for(var f=-1;++f<i;){var g=e[f];if(Ut(g[0],this,u))return Ut(g[1],this,u)}})}function Q0(e){return Id(Er(e,q))}function Ha(e){return function(){return e}}function e_(e,i){return e==null||e!==e?i:e}var t_=Ku(),r_=Ku(!0);function ar(e){return e}function ka(e){return Eu(typeof e=="function"?e:Er(e,q))}function i_(e){return Iu(Er(e,q))}function n_(e,i){return Su(e,Er(i,q))}var s_=Ie(function(e,i){return function(o){return On(o,e,i)}}),o_=Ie(function(e,i){return function(o){return On(e,o,i)}});function Va(e,i,o){var u=zt(i),f=Ms(i,u);o==null&&!(ut(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=Ms(i,zt(i)));var g=!(ut(o)&&"chain"in o)||!!o.chain,b=ti(e);return mr(f,function(w){var P=i[w];e[w]=P,b&&(e.prototype[w]=function(){var F=this.__chain__;if(g||F){var j=e(this.__wrapped__),H=j.__actions__=nr(this.__actions__);return H.push({func:P,args:arguments,thisArg:e}),j.__chain__=F,j}return P.apply(e,hi([this.value()],arguments))})}),e}function a_(){return Ae._===this&&(Ae._=$p),this}function Ka(){}function c_(e){return e=me(e),Ie(function(i){return Pu(i,e)})}var u_=xa(st),h_=xa(Gc),l_=xa(Wo);function kh(e){return Ra(e)?Jo(Hr(e)):zd(e)}function f_(e){return function(i){return e==null?t:$i(e,i)}}var p_=Wu(),d_=Wu(!0);function Ga(){return[]}function Wa(){return!1}function g_(){return{}}function y_(){return""}function v_(){return!0}function __(e,i){if(e=me(e),e<1||e>V)return[];var o=G,u=Kt(e,G);i=ne(i),e-=G;for(var f=Zo(u,i);++o<e;)i(o);return f}function m_(e){return _e(e)?st(e,Hr):pr(e)?[e]:nr(hh(je(e)))}function b_(e){var i=++Tp;return je(e)+i}var w_=ks(function(e,i){return e+i},0),E_=Ia("ceil"),x_=ks(function(e,i){return e/i},1),I_=Ia("floor");function S_(e){return e&&e.length?js(e,ar,ua):t}function P_(e,i){return e&&e.length?js(e,ne(i,2),ua):t}function O_(e){return Yc(e,ar)}function A_(e,i){return Yc(e,ne(i,2))}function C_(e){return e&&e.length?js(e,ar,pa):t}function R_(e,i){return e&&e.length?js(e,ne(i,2),pa):t}var T_=ks(function(e,i){return e*i},1),N_=Ia("round"),$_=ks(function(e,i){return e-i},0);function D_(e){return e&&e.length?Xo(e,ar):0}function L_(e,i){return e&&e.length?Xo(e,ne(i,2)):0}return d.after=iv,d.ary=wh,d.assign=kv,d.assignIn=Lh,d.assignInWith=io,d.assignWith=Vv,d.at=Kv,d.before=Eh,d.bind=Fa,d.bindAll=X0,d.bindKey=xh,d.castArray=gv,d.chain=_h,d.chunk=Ig,d.compact=Sg,d.concat=Pg,d.cond=Z0,d.conforms=Q0,d.constant=Ha,d.countBy=Dy,d.create=Gv,d.curry=Ih,d.curryRight=Sh,d.debounce=Ph,d.defaults=Wv,d.defaultsDeep=Jv,d.defer=nv,d.delay=sv,d.difference=Og,d.differenceBy=Ag,d.differenceWith=Cg,d.drop=Rg,d.dropRight=Tg,d.dropRightWhile=Ng,d.dropWhile=$g,d.fill=Dg,d.filter=Fy,d.flatMap=qy,d.flatMapDeep=Uy,d.flatMapDepth=zy,d.flatten=dh,d.flattenDeep=Lg,d.flattenDepth=Fg,d.flip=ov,d.flow=t_,d.flowRight=r_,d.fromPairs=jg,d.functions=r0,d.functionsIn=i0,d.groupBy=By,d.initial=qg,d.intersection=Ug,d.intersectionBy=zg,d.intersectionWith=Bg,d.invert=s0,d.invertBy=o0,d.invokeMap=ky,d.iteratee=ka,d.keyBy=Vy,d.keys=zt,d.keysIn=or,d.map=Xs,d.mapKeys=c0,d.mapValues=u0,d.matches=i_,d.matchesProperty=n_,d.memoize=Qs,d.merge=h0,d.mergeWith=Fh,d.method=s_,d.methodOf=o_,d.mixin=Va,d.negate=eo,d.nthArg=c_,d.omit=l0,d.omitBy=f0,d.once=av,d.orderBy=Ky,d.over=u_,d.overArgs=cv,d.overEvery=h_,d.overSome=l_,d.partial=ja,d.partialRight=Oh,d.partition=Gy,d.pick=p0,d.pickBy=jh,d.property=kh,d.propertyOf=f_,d.pull=Kg,d.pullAll=yh,d.pullAllBy=Gg,d.pullAllWith=Wg,d.pullAt=Jg,d.range=p_,d.rangeRight=d_,d.rearg=uv,d.reject=Yy,d.remove=Yg,d.rest=hv,d.reverse=Da,d.sampleSize=Zy,d.set=g0,d.setWith=y0,d.shuffle=Qy,d.slice=Xg,d.sortBy=rv,d.sortedUniq=ny,d.sortedUniqBy=sy,d.split=q0,d.spread=lv,d.tail=oy,d.take=ay,d.takeRight=cy,d.takeRightWhile=uy,d.takeWhile=hy,d.tap=Sy,d.throttle=fv,d.thru=Ys,d.toArray=Nh,d.toPairs=Mh,d.toPairsIn=qh,d.toPath=m_,d.toPlainObject=Dh,d.transform=v0,d.unary=pv,d.union=ly,d.unionBy=fy,d.unionWith=py,d.uniq=dy,d.uniqBy=gy,d.uniqWith=yy,d.unset=_0,d.unzip=La,d.unzipWith=vh,d.update=m0,d.updateWith=b0,d.values=an,d.valuesIn=w0,d.without=vy,d.words=Bh,d.wrap=dv,d.xor=_y,d.xorBy=my,d.xorWith=by,d.zip=wy,d.zipObject=Ey,d.zipObjectDeep=xy,d.zipWith=Iy,d.entries=Mh,d.entriesIn=qh,d.extend=Lh,d.extendWith=io,Va(d,d),d.add=w_,d.attempt=Hh,d.camelCase=S0,d.capitalize=Uh,d.ceil=E_,d.clamp=E0,d.clone=yv,d.cloneDeep=_v,d.cloneDeepWith=mv,d.cloneWith=vv,d.conformsTo=bv,d.deburr=zh,d.defaultTo=e_,d.divide=x_,d.endsWith=P0,d.eq=$r,d.escape=O0,d.escapeRegExp=A0,d.every=Ly,d.find=jy,d.findIndex=fh,d.findKey=Yv,d.findLast=My,d.findLastIndex=ph,d.findLastKey=Xv,d.floor=I_,d.forEach=mh,d.forEachRight=bh,d.forIn=Zv,d.forInRight=Qv,d.forOwn=e0,d.forOwnRight=t0,d.get=Ua,d.gt=wv,d.gte=Ev,d.has=n0,d.hasIn=za,d.head=gh,d.identity=ar,d.includes=Hy,d.indexOf=Mg,d.inRange=x0,d.invoke=a0,d.isArguments=Fi,d.isArray=_e,d.isArrayBuffer=xv,d.isArrayLike=sr,d.isArrayLikeObject=Et,d.isBoolean=Iv,d.isBuffer=vi,d.isDate=Sv,d.isElement=Pv,d.isEmpty=Ov,d.isEqual=Av,d.isEqualWith=Cv,d.isError=Ma,d.isFinite=Rv,d.isFunction=ti,d.isInteger=Ah,d.isLength=to,d.isMap=Ch,d.isMatch=Tv,d.isMatchWith=Nv,d.isNaN=$v,d.isNative=Dv,d.isNil=Fv,d.isNull=Lv,d.isNumber=Rh,d.isObject=ut,d.isObjectLike=vt,d.isPlainObject=$n,d.isRegExp=qa,d.isSafeInteger=jv,d.isSet=Th,d.isString=ro,d.isSymbol=pr,d.isTypedArray=on,d.isUndefined=Mv,d.isWeakMap=qv,d.isWeakSet=Uv,d.join=Hg,d.kebabCase=C0,d.last=Ir,d.lastIndexOf=kg,d.lowerCase=R0,d.lowerFirst=T0,d.lt=zv,d.lte=Bv,d.max=S_,d.maxBy=P_,d.mean=O_,d.meanBy=A_,d.min=C_,d.minBy=R_,d.stubArray=Ga,d.stubFalse=Wa,d.stubObject=g_,d.stubString=y_,d.stubTrue=v_,d.multiply=T_,d.nth=Vg,d.noConflict=a_,d.noop=Ka,d.now=Zs,d.pad=N0,d.padEnd=$0,d.padStart=D0,d.parseInt=L0,d.random=I0,d.reduce=Wy,d.reduceRight=Jy,d.repeat=F0,d.replace=j0,d.result=d0,d.round=N_,d.runInContext=S,d.sample=Xy,d.size=ev,d.snakeCase=M0,d.some=tv,d.sortedIndex=Zg,d.sortedIndexBy=Qg,d.sortedIndexOf=ey,d.sortedLastIndex=ty,d.sortedLastIndexBy=ry,d.sortedLastIndexOf=iy,d.startCase=U0,d.startsWith=z0,d.subtract=$_,d.sum=D_,d.sumBy=L_,d.template=B0,d.times=__,d.toFinite=ri,d.toInteger=me,d.toLength=$h,d.toLower=H0,d.toNumber=Sr,d.toSafeInteger=Hv,d.toString=je,d.toUpper=k0,d.trim=V0,d.trimEnd=K0,d.trimStart=G0,d.truncate=W0,d.unescape=J0,d.uniqueId=b_,d.upperCase=Y0,d.upperFirst=Ba,d.each=mh,d.eachRight=bh,d.first=gh,Va(d,function(){var e={};return zr(d,function(i,o){qe.call(d.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),d.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),mr(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===t?1:Mt(me(o),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=Kt(o,u.__takeCount__):u.__views__.push({size:Kt(o,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),mr(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==_||o==X;Oe.prototype[e]=function(f){var g=this.clone();return g.__iteratees__.push({iteratee:ne(f,3),type:o}),g.__filtered__=g.__filtered__||u,g}}),mr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),mr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(ar)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=Ie(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return On(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(eo(ne(e)))},Oe.prototype.slice=function(e,i){e=me(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==t&&(i=me(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},zr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=d[u?"take"+(i=="last"?"Right":""):i],g=u||/^find/.test(i);f&&(d.prototype[i]=function(){var b=this.__wrapped__,w=u?[1]:arguments,P=b instanceof Oe,F=w[0],j=P||_e(b),H=function(Se){var Ce=f.apply(d,hi([Se],w));return u&&J?Ce[0]:Ce};j&&o&&typeof F=="function"&&F.length!=1&&(P=j=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=g&&!J,we=P&&!te;if(!g&&j){b=we?b:new Oe(this);var ae=e.apply(b,w);return ae.__actions__.push({func:Ys,args:[H],thisArg:t}),new wr(ae,J)}return oe&&we?e.apply(this,w):(ae=this.thru(H),oe?u?ae.value()[0]:ae.value():ae)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Es[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var g=this.value();return i.apply(_e(g)?g:[],f)}return this[o](function(b){return i.apply(_e(b)?b:[],f)})}}),zr(Oe.prototype,function(e,i){var o=d[i];if(o){var u=o.name+"";qe.call(en,u)||(en[u]=[]),en[u].push({name:i,func:o})}}),en[Hs(t,Ee).name]=[{name:"wrapper",func:t}],Oe.prototype.clone=Jp,Oe.prototype.reverse=Yp,Oe.prototype.value=Xp,d.prototype.at=Py,d.prototype.chain=Oy,d.prototype.commit=Ay,d.prototype.next=Cy,d.prototype.plant=Ty,d.prototype.reverse=Ny,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=$y,d.prototype.first=d.prototype.head,bn&&(d.prototype[bn]=Ry),d},Xi=Ap();wt?((wt.exports=Xi)._=Xi,We._=Xi):Ae._=Xi}).call(Hn)})(Ac,Ac.exports);var cI=Object.defineProperty,uI=Object.defineProperties,hI=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,lI=Object.prototype.hasOwnProperty,fI=Object.prototype.propertyIsEnumerable,Wl=(a,r,t)=>r in a?cI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,so=(a,r)=>{for(var t in r||(r={}))lI.call(r,t)&&Wl(a,t,r[t]);if(Gl)for(var t of Gl(r))fI.call(r,t)&&Wl(a,t,r[t]);return a},pI=(a,r)=>uI(a,hI(r));function Ar(a,r,t){let n;const s=Cc(a);return r.rpcMap&&(n=r.rpcMap[s]),n||(n=`${aI}?chainId=eip155:${s}&projectId=${t}`),n}function Cc(a){return a.includes("eip155")?Number(a.split(":")[1]):Number(a)}function ip(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function dI(a,r){const t=Object.keys(r.namespaces).filter(s=>s.includes(a));if(!t.length)return[];const n=[];return t.forEach(s=>{const c=r.namespaces[s].accounts;n.push(...c)}),n}function gI(a={},r={}){const t=Jl(a),n=Jl(r);return Ac.exports.merge(t,n)}function Jl(a){var r,t,n,s;const c={};if(!co(a))return c;for(const[l,p]of Object.entries(a)){const m=uf(l)?[l]:p.chains,y=p.methods||[],O=p.events||[],q=p.rpcMap||{},C=uo(l);c[C]=pI(so(so({},c[C]),p),{chains:Ya(m,(r=c[C])==null?void 0:r.chains),methods:Ya(y,(t=c[C])==null?void 0:t.methods),events:Ya(O,(n=c[C])==null?void 0:n.events),rpcMap:so(so({},q),(s=c[C])==null?void 0:s.rpcMap)})}return c}function yI(a){return a.includes(":")?a.split(":")[2]:a}function vI(a){const r={};for(const[t,n]of Object.entries(a)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],p=uf(t)?[t]:n.chains?n.chains:ip(n.accounts);r[t]={chains:p,methods:s,events:c,accounts:l}}return r}const np={},It=a=>np[a],cc=(a,r)=>{np[a]=r};class _I{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Ar(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Ar(r,this.namespace);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}class mI{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,t){const n=Cc(r);if(!this.httpProviders[n]){const s=t||Ar(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,s)}this.chainId=n,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,t){const n=t||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Cc(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}async handleSwitchChain(r){var t,n;let s=r.request.params?(t=r.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class bI{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}class wI{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}class EI{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t);r[t]=this.createHttpProvider(t,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}getCardanoRPCUrl(r){const t=this.namespace.rpcMap;if(t)return t[r]}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}class xI{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}class II{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new wi(new Ui(n,It("disableProviderPing")))}}var SI=Object.defineProperty,PI=Object.defineProperties,OI=Object.getOwnPropertyDescriptors,Yl=Object.getOwnPropertySymbols,AI=Object.prototype.hasOwnProperty,CI=Object.prototype.propertyIsEnumerable,Xl=(a,r,t)=>r in a?SI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,oo=(a,r)=>{for(var t in r||(r={}))AI.call(r,t)&&Xl(a,t,r[t]);if(Yl)for(var t of Yl(r))CI.call(r,t)&&Xl(a,t,r[t]);return a},uc=(a,r)=>PI(a,OI(r));class Vc{constructor(r){this.events=new Lc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Vl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const t=new Vc(r);return await t.initialize(),t}async request(r,t){const[n,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:oo({},r),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(r,t,n){this.request(r,n).then(s=>t(null,s)).catch(s=>t(s,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}removeListener(r,t){this.events.removeListener(r,t)}off(r,t){this.events.off(r,t)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=vI(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==tp)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,t){try{if(!this.session)return;const[n,s]=this.validateChain(r);this.getProvider(n).setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(pn(t)){for(const n of t)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await eI.init({logger:this.providerOpts.logger||Vl,relayUrl:this.providerOpts.relayUrl||nI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(t=>uo(t)))];cc("client",this.client),cc("events",this.events),cc("disableProviderPing",this.disableProviderPing),r.forEach(t=>{if(!this.session)return;const n=dI(t,this.session),s=ip(n),c=gI(this.namespaces,this.optionalNamespaces),l=uc(oo({},c[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new mI({namespace:l});break;case"solana":this.rpcProviders[t]=new bI({namespace:l});break;case"cosmos":this.rpcProviders[t]=new wI({namespace:l});break;case"polkadot":this.rpcProviders[t]=new _I({namespace:l});break;case"cip34":this.rpcProviders[t]=new EI({namespace:l});break;case"elrond":this.rpcProviders[t]=new xI({namespace:l});break;case"multiversx":this.rpcProviders[t]=new II({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:t}=r,{event:n}=t;if(n.name==="accountsChanged"){const s=n.data;s&&pn(s)&&this.events.emit("accountsChanged",s.map(yI))}else n.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:t})=>{var n;const{namespaces:s}=t,c=(n=this.client)==null?void 0:n.session.get(r);this.session=uc(oo({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:t})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",uc(oo({},tr("USER_DISCONNECTED")),{data:r.topic}))}),this.on(Ei.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var t;this.getProvider(r).updateNamespace((t=this.session)==null?void 0:t.namespaces[r])})}setNamespaces(r){const{namespaces:t,optionalNamespaces:n,sessionProperties:s}=r;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(r){const[t,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(l=>uo(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=uo(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,t=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(r);t||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,t){this.client.core.storage.setItem(`${Kl}/${r}`,t)}async getFromStore(r){return await this.client.core.storage.getItem(`${Kl}/${r}`)}}const RI=Vc,TI="wc",NI="ethereum_provider",$I=`${TI}@2:${NI}:`,DI="https://rpc.walletconnect.com/v1/",Rc=["eth_sendTransaction","personal_sign"],LI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Tc=["chainChanged","accountsChanged"],FI=["message","disconnect","connect"];var jI=Object.defineProperty,MI=Object.defineProperties,qI=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,UI=Object.prototype.hasOwnProperty,zI=Object.prototype.propertyIsEnumerable,Ql=(a,r,t)=>r in a?jI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,kn=(a,r)=>{for(var t in r||(r={}))UI.call(r,t)&&Ql(a,t,r[t]);if(Zl)for(var t of Zl(r))zI.call(r,t)&&Ql(a,t,r[t]);return a},ef=(a,r)=>MI(a,qI(r));function go(a){return Number(a[0].split(":")[1])}function hc(a){return`0x${a.toString(16)}`}function BI(a){const{chains:r,optionalChains:t,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:p}=a;if(!pn(r))throw new Error("Invalid chains");const m={chains:r,methods:n||Rc,events:c||Tc,rpcMap:kn({},r.length?{[go(r)]:p[go(r)]}:{})},y=c==null?void 0:c.filter(U=>!Tc.includes(U)),O=n==null?void 0:n.filter(U=>!Rc.includes(U));if(!t&&!l&&!s&&!(y!=null&&y.length)&&!(O!=null&&O.length))return{required:r.length?m:void 0};const q=(y==null?void 0:y.length)&&(O==null?void 0:O.length)||!t,C={chains:[...new Set(q?m.chains.concat(t||[]):t)],methods:[...new Set(m.methods.concat(s!=null&&s.length?s:LI))],events:[...new Set(m.events.concat(l||FI))],rpcMap:p};return{required:r.length?m:void 0,optional:t.length?C:void 0}}class Kc{constructor(){this.events=new yr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=$I,this.on=(r,t)=>(this.events.on(r,t),this),this.once=(r,t)=>(this.events.once(r,t),this),this.removeListener=(r,t)=>(this.events.removeListener(r,t),this),this.off=(r,t)=>(this.events.off(r,t),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const t=new Kc;return await t.initialize(r),t}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,t){this.signer.sendAsync(r,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:t,optional:n}=BI(this.rpc);try{const s=await new Promise(async(l,p)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ef(kn({namespaces:kn({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(y=>{l(y)}).catch(y=>{p(new Error(y.message))})});if(!s)return;this.setChainIds(this.rpc.chains);const c=mm(s.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:hc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:t}=r,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const t=parseInt(r);this.chainId=t,this.events.emit("chainChanged",hc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",ef(kn({},tr("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const t=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",hc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const t=this.parseChainId(r);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(r){const[t,n,s]=r.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(r){this.accounts=r.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var t,n;const s=(t=r==null?void 0:r.chains)!=null?t:[],c=(n=r==null?void 0:r.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=s.length?(r==null?void 0:r.methods)||Rc:[],m=s.length?(r==null?void 0:r.events)||Tc:[],y=(r==null?void 0:r.optionalMethods)||[],O=(r==null?void 0:r.optionalEvents)||[],q=(r==null?void 0:r.rpcMap)||this.buildRpcMap(l,r.projectId),C=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(U=>this.formatChainId(U)),optionalChains:c.map(U=>this.formatChainId(U)),methods:p,events:m,optionalMethods:y,optionalEvents:O,rpcMap:q,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:C,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,t){const n={};return r.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?go(this.rpc.chains):go(this.rpc.optionalChains),this.signer=await RI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await bm(()=>import("./index-87e7ab07.js").then(s=>s.a),["assets/index-87e7ab07.js","assets/index-d5466935.js","assets/index-34e6f450.css"]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(kn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:t,optionalChains:n,rpcMap:s}=r;t&&pn(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&pn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(r,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${DI}?chainId=eip155:${r}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(t=>this.parseAccount(t))}}const ZI=Kc;export{ZI as EthereumProvider,FI as OPTIONAL_EVENTS,LI as OPTIONAL_METHODS,Tc as REQUIRED_EVENTS,Rc as REQUIRED_METHODS,Kc as default};
